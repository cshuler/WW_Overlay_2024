!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="99f24cc9-483d-3623-8eca-bddc892dd80e")}catch(e){}}();
(() => {const define = dbxPithosConfig._define, require = dbxPithosConfig._require; define((()=>(()=>{"use strict";var e={2276:(e,t,i)=>{i.d(t,{q:()=>s});let n=!0,a=null;const o="undefined"==typeof jest?"initial data wasn't initialized yet, you need to call js/init_data/init_raw:initRaw function first":"initial data wasn't initialized yet, you need to call js/init_data/init_test.test_util:initTest function first";function s(e,t=!0){t?globalThis.__init_data_raw__=e:(a=e,n=!1)}function r(){if(n){if("string"!=typeof globalThis.__init_data_raw__)throw new Error(o);return globalThis.__init_data_raw__}if("string"!=typeof a)throw new Error(o);return a}}},t={};function i(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};return(()=>{var e=i(2276);function t(t,i=!0){(0,e.q)(t,i)}t(window.dbxPithosConfig.base64InitData,!1)})(),(()=>{var e,t,i,n,a,o,s,r,l,d,c,u;!function(e){e.Critical="critical",e.NonCritical="non-critical",e.Operational="operational",e.UserError="user-error",e.Uncaught="uncaught"}(e||(e={})),function(e){e.ChatIsNotRequested="CHAT_IS_NOT_REQUESTED",e.ChatIsRequested="CHAT_IS_REQUESTED"}(t||(t={})),function(e){e.DoNotTerminateChatSession="DO_NOT_TERMINATE_CHAT_SESSION"}(i||(i={})),function(e){e.Hiddden="HIDDEN",e.Visible="VISIBLE"}(n||(n={})),function(e){e.ChatBubble="CHAT_BUBBLE",e.ChatWindow="CHAT_WINDOW"}(a||(a={})),function(e){e.UserSwtichCompany="USER_SWTICHED_COMPANY",e.UserNotSwtichCompany="USER_NOT_SWTICHED_COMPANY"}(o||(o={})),function(e){e.WWW_DBX_HOST="TRUSTED_DBX_HOST",e.DOCSEND_HOST="TRUSTED_DOCSEND_HOST",e.HELP_CENTER_HOST="TRUSTED_HELP_CENTER",e.EXPERIENCE_HOST="TRUSTED_EXPERIENCE_HOST",e.SIGN_CENTER_HOST="TRUSTED_SIGN_CENTER",e.DASH_DBX_HOST="TRUSTED_DASH_HOST",e.UNSUPPORTED_HOST="UNSUPPORTED_HOST"}(s||(s={})),function(e){e.DOCSEND_CHAT="DOCSEND_CHAT",e.DASH_CX_CHAT="DASH_CX_CHAT",e.DBX_SALES_CHAT="DBX_SALES_CHAT",e.DBX_CX_CHAT="DBX_CX_CHAT",e.UNSUPPORTED_CHAT="UNSUPPORTED_CHAT"}(r||(r={})),function(e){e.DOCSEND_ENTITLEMENTS="docsendEntitlements",e.WWW_DBX_ENTITLEMENTS="wwwDbxEntitlements",e.HELP_CENTER_ENTITLEMENTS="helpCenterEntitlements",e.EXPERIENCE_ENTITLEMENTS="experienceEntitlements",e.SIGN_CENTER_ENTITLEMENTS="signCenterEntitlements",e.DASH_DBX_ENTITLEMENTS="dashDbxEntitlements",e.UNSUPPORTED_ENTITLEMENTS="unsupportedEntitlements"}(l||(l={})),function(e){e.PROACTIVE_CHAT="proactive_chat",e.REACTIVE_CHAT="reactive_chat",e.UNSUPPORTED_CHAT="unsupported_chat"}(d||(d={})),function(e){e.INITIALIZED="zoomChatInitiated",e.SUCCESS="zoomChatInitiationSuccess",e.FAILED="zoomChatInitiationFailed",e.NETWORK_FAILED="zoomChatNetworkFailed",e.TIMEOUT_FAILED="zoomChatTimeOutFailed",e.EXPAND="zoomChatMaximized",e.MINIMIZE="zoomChatMinimized",e.END="zoomChatEnded",e.CHATREQUESTED="zoomChatRequested",e.DISPLAYED="zoomChatInitialDisplay",e.LOGOUT="zoomChatLogoutByUser",e.CONSENTDECLINED="zoomChatConsentDeclined",e.SALESCHAT_DISALLOWED_COUNTRY="zoomSalesChatDisallowedCountry",e.SALES_EXPERIMENT_PRESENTED="zoomSalesChatExperimentPresented",e.START_NEW_CHAT_BUTTON_CLICKED="zoomStartNewChatButtonClicked",e.ZOOM_SALES_CHAT_PROACTIVE_EXPERIMENT="zoomSalesChatProactiveExperiment",e.CHAT_STATE_MISMATCH="zoomchatLocalStorageStateMismatch",e.COOKIE_CLEARED="zoomChatCookieCleared",e.LOCAL_STORAGE_CLEARED="zoomchatlocalstoragecleared"}(c||(c={})),function(e){e.ZOOM="ZOOM",e.DECAGON="DECAGON"}(u||(u={}));const h=120,f=3e3,C=3e3,g=100,E=100,S="unified_chat_init",m="dbx_sales_chat_login_init",T="__Secure-dbx_consent",_="performance and functionality",p="dbx_unified_chat_iframe",I="dbx-unified-chat-container",v=1,A="dbx_unified_chat_state",O="zoom_chat_requested_start_time",N="zoom_chat_initial_display_time",b="zoom_chat_session_end_time",D="dbx_unified_chat_session_logout",y="dbx_unified_chat_on_checkout",R="dbx_unified_chat_end_to_chat_state",w="dbxSalesChatCookieInit",P="dbxSalesChatLoginCookieInit",U="dbxCxChatCookieInit",H="_tk",L="ios_upgrade_trigger_",k=".dropbox.com",F={[r.DBX_SALES_CHAT]:w,[r.DBX_CX_CHAT]:U},B=[r.DOCSEND_CHAT,r.DBX_CX_CHAT,r.DBX_SALES_CHAT],M=[r.DOCSEND_CHAT,r.DASH_CX_CHAT],W=[r.DBX_SALES_CHAT],x=[r.DOCSEND_CHAT],X=new Set([r.DOCSEND_CHAT,r.DBX_SALES_CHAT,r.DBX_CX_CHAT]),G=[r.DBX_SALES_CHAT],Z=["/checkout","/try"],V={"/plans":10,"/business":10,"/upgrade":10,"/sign":10,"/backup":10,"/contact":10,"/individual":10,"/business/try":10,"/buy":10,"/low-space":10,"/official-site":10,"/official-teams-page":10,"/plus":10,"/replay":10,"/space-upgrade":10,"/buy/plus":10,"/try/teams":10,"/try/business":10,"/overview/teams":10,"/features/share/send-large-files":10,"/features/cloud-storage":10,"/buy/business/advanced":10,"/buy/professional":10,"/buy/business/standard":10,"/login":3},$="/login",z="/checkout",K="dash_for_teams",J={"/products/dropbox-fax":25,"/dropbox-esignature-solution":10,"/features":10,"/integrations/dropbox":10,"/dropbox-sign-api":10,"/products/dropbox-sign/pricing":10,"/integrations":10,"/products/dropbox-sign-api":10,"/products/dropbox-sign":10,"/":10},j={"/get_help":0,"/get_help/*/contact-us":0,"/get_help/chat":0,"/premium-support":0},q=["/get_help","/get_help/*/contact-us","/get_help/chat","/premium-support"],Y="French",Q="Italian",ee="German",te="Spanish",ie="Portuguese",ne="Korean",ae="Mandarin or Cantonese",oe="Mandarin (Simplified Chinese)",se="Mandarin (Traditional Chinese)",re="Cantonese (Hong Kong Chinese)",le="Cantonese (Macau Chinese)",de="Hindi",ce=["ID"],ue=5,he=1e3,fe="OFF",Ce="OFF",ge={isEnabled:!1,proActiveMessagingPages:[]},Ee={defaultAllPages:{"/":25},entryPages:{}},Se={dash:{showChatBubble:!1},dbx:{showChatBubble:!1}},me={toBeSuppressed:!1},Te={pacificTZ:"America/Los_Angeles",startMinutes:360,endMinutes:1080,formatOptions:{timeZone:"America/Los_Angeles",hour12:!1,weekday:"short",hour:"2-digit",minute:"2-digit"}},_e=3,pe=2e3,Ie="en-US",ve={hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZoneName:"short"};var Ae,Oe,Ne,be;!function(e){e.GET_BROWSER_STATUS="To check browser is Safari",e.SCRIPT_TAG_SUCCESS="Success in adding script tag to iframe",e.SCRIPT_TAG_ERROR="Failed to add script tag to iframe",e.EXPAND_BUTTON_CLICKED="User clicked expand button",e.MINIMIZE_BUTTON_CLICKED="User clicked minimize button",e.CHAT_WIDGET_LOADED="Chat widget loaded successfully inside iframe",e.CHAT_WIDGET_NOT_LOADED="Failed to load chat inside iframe widget maximum retries reached",e.START_NEW_CHAT_BUTTON_CLICKED="User clicked start new chat button ",e.FETCH_ZOOM_CHAT_CREDENTIALS="Fetching Zoom chat credentials",e.FETCH_DOCSEND_CURRENT_USER_INFO="Fetching DocSend current user info",e.FETCH_DROPBOX_CURRENT_USER_INFO="Fetching Dropbox current user info",e.FETCH_BROWSER_LANGUAGE_INFO="Fetching browser language info",e.FETCH_CX_CHAT_REQUESTED_LANGUAGE_INFO="Fetching CX chat requested language info",e.FETCH_USER_SELECTED_PRODUCT_SUPPORT_PACKAGE_INFO="Fetching User selected product support package info",e.FETCH_BROWSER_PATH_INFO="Fetching DBX browser path info",e.FETCH_DISCOVERABILITY_CONFIG="Fetching discoverability config",e.FETCH_CHAT_TYPE_INFO="Fetch chat type info",e.END_CHAT_BUTTON_CLICKED="User clicked end chat button",e.PROACTIVE_END_CHAT_BUTTON_CLICKED="User clicked proactive chat feature end button",e.DELETE_ATTACHED_IFRAME_ON_END_CHAT_BUTTON_CLICK="Delete attached iframe as user clicked end chat button",e.RELOAD_PAGE_AFTER_CHAT_ENDS="Requesting reload page after chat ends",e.UNHANDLED_ACTION_MESSAGES="Unhandled action from top window",e.SET_COOKIE_FOR_DBX_SALES_CHAT="Setting cookie for DBX sales chat",e.RESPONSE_FOR_IS_CHATTING_STATUS="RES_TO_SEND_STATUS_OF_IS_CHATTING",e.RESPONSE_FOR_ENGAGEMENT_ID="RESPONSE_TO_SEND_ENGAGEMENT_ID",e.REQUEST_STORAGE_ACCESS="Requesting storage access from iframe",e.STORAGE_ACCESS_SUCCESS="Storage access granted by iframe",e.STORAGE_ACCESS_FAILED="Storage access denied by iframe"}(Ae||(Ae={})),function(e){e.SEND_BROWSER_STATUS="Sending browser status",e.SEND_PROACTIVE_FEATURE_STATUS="Sending proactive feature status",e.SEND_ZOOM_CHAT_CREDENTIALS="Sending Zoom chat credentials",e.CHECK_CHAT_WIDGET_STATUS="Checking chat widget status",e.SEND_DOCSEND_CURRENT_USER_INFO="Sending DocSend current user info",e.SEND_BROWSER_PATH_INFO="Sending DBX browser path info",e.SEND_DISCOVERABILITY_CONFIG="Sending discoverability config",e.SEND_DROPBOX_CURRENT_USER_INFO="Sending Dropbox current user info",e.SEND_BROWSER_CURRENT_LANGUAGE_INFO="Sending browser current language info",e.SEND_CURRENT_CHAT_TYPE_INFO="Sending current chat type info",e.LOGOUT_CALLBACK="Performing logout callback as user DocSend ends the chat",e.SET_ZOOM_CHAT_WIDGET_TO_OPEN_WINDOW="Requesting chat window to open mode when the user requests a chat",e.SWITCH_COMPANY_CALLBACK_MESSAGE="Sending as user performs switch company",e.UNHANDLED_ACTION_MESSAGES="Unhandled action from iframe",e.SEND_CX_CHAT_REQUESTED_LANGUAGE_INFO="Send CX chat requested language info",e.SEND_USER_SELECTED_PRODUCT_SUPPORT_PACKAGE_INFO="Send user selected product support package info",e.REQUEST_IS_CHATTING_MESSAGE="Requesting iframe to fetch the status of isChatting under zoomCampaignSdk",e.REQUEST_ENGAGEMENT_ID="Requesting iframe to fetch the engagement id",e.REQUEST_STORAGE_ACCESS="Requesting iframe to request storage access"}(Oe||(Oe={})),function(e){e.CHAT_WIDGET_NOT_LOADED_MAX_RETRY_REACHED="Failed to load chat inside iframe - maximum retries reached",e.TOGGLE_REGISTRATION_FAILED_ERROR="Failed to register Open/Close Zoom Campaign events",e.END_BUTTON_NOT_FOUND_ERROR="Failed to find Zoom Chat widget end button",e.MINIMIZE_BUTTON_NOT_FOUND_ERROR="Unable to find minimize button for the Zoom chat widget campaign",e.MESSAGE_BOX_HEIGHT_SET_ERROR="Unable to set height for chat message box for Safari check of Zoom chat widget campaign",e.CHAT_END_BUTTON_NOT_FOUND_ERROR="Unable to find chat end button for the Zoom chat widget campaign",e.START_CHAT_BUTTON_NOT_FOUND_ERROR="Unable to find start new chat button for the Zoom chat widget campaign",e.ZOOM_SDK_NO_OPEN="zoomCampaignSdk does not have an open method",e.ZOOM_SDK_NO_CLOSE="zoomCampaignSdk does not have a close method",e.ZOOM_CAMPAIGN_SDK_IS_NOT_AVAILABLE="Zoom Campaign SDK is not available",e.FAILED_WHEN_TRYING_TO_REGISTER_THE_ZOOM_CAMPAIGN_SDK_EVENT="Failed when trying to register the zoom Campaign SDK event",e.WEB_CHAT_DIV_NOT_FOUND="webChatDiv of zoom chat widget not found",e.SHADOW_DOM_NOT_AVAILABLE="Shadow DOM of zoom chat widget not available",e.START_NEW_CHAT_BUTTON_NOT_FOUND="Start New Chat button footer inside Shadow DOM not found",e.WINDOW_MASK_END_BUTTON_NOT_FOUND="Window mask of end button inside Shadow DOM not found"}(Ne||(Ne={})),function(e){e.IDENTIFIED_HOST_OR_SUPPORTED_ENTITLEMENTS_NULL="Identified host or supported entitlements is null or undefined",e.TIMER_VALUE_FETCH_ERROR="Error occurred while fetching timer value of Invalid URL",e.IFRAME_EXECUTION_ERROR="Error executing function in iframe",e.IFRAME_CONTENT_WINDOW_NULL_ERROR="Iframe contentWindow is null",e.IFRAME_NOT_FOUND_ERROR="Iframe not found",e.SCRIPT_TAG_ATTACHMENT_ERROR="Error during script tag attachment to iframe",e.CHAT_CLIENT_SETUP_INITIALIZATION_ERROR="Error initializing chat client setup",e.CHAT_IFRAME_LOAD_TIMEOUT_ERROR="Timed-out while waiting for chat iframe load event",e.ERROR_ATTACHING_MESSAGE_EVENT_LISTENER="Error attaching message event listener",e.ERROR_CLEARING_TIMEOUT="Error while clearing timeout",e.ERROR_IFRAME_NOT_FOUND_OR_COOKIE_SET="Iframe not found or cookie already set",e.ERROR_ZOOM_CHAT_RELOAD_FAILED="Zoom chat reload failed. Steps were not executed",e.ERROR_OPEN_CHAT_WINDOW_METHOD_UNAVAILABLE="Zoom chat client or handleOpenChatWindowCallback method is not available",e.ERROR_CONSENT_METHOD_UNAVAILABLE="Zoom chat client or consentGrantedProceedDBXSalesChatToLoad method is not available as we DE-REG this callback explicitly.",e.INVALID_ENTRY_PAGE_KEY="Detected an invalid entry page key.",e.NO_ENTRY_PATH="Entry path is missing or invalid.",e.ENTRY_PAGE_KEY_NULL_OR_UNDEFINED="Entry page key is null or undefined.",e.NO_VALID_ENTRY_PAGE="No valid entry page found.",e.DETECTED_LOGIN_PAGE_WITHOUT_COOKIE="Chat should not be loaded in /login page without loginPageCookie.",e.INVALID_CHAT_COOKIE="Detected an invalid chat cookie.",e.NO_VALID_CHAT_COOKIE="No valid chat cookie present.",e.INVALID_CHAT_TYPE="Unrecognized or invalid chat type.",e.UNIFIED_CHAT_COOKIE_NOT_SET="Unified chat cookie is missing.",e.INITIALIZATION_FAILED="Failed to initialize supported entitlements.",e.NO_MATCHING_DOMAIN="No matching domain for initialization.",e.INVALID_ENTRY_POINT="Failed to validate the entry point.",e.PAGE_PATH_VERIFICATION="Current page path verification failed.",e.FETCH_HOSTNAME="Unable to fetch hostname from the URL.",e.FETCH_PATHNAME="Unable to fetch pathname from the URL.",e.UNSUPPORTED_ENTITLEMENTS="Unsupported entitlements detected during chat configuration.",e.OUTSIDE_OPERATIONAL_HOURS="Unable to load chat during non-operational hours.",e.MISSING_CHAT_OPERATIONAL_HOURS="Missing chat operational hours, unable to proceed with chat initialization.",e.ZOOM_CHAT_CONSENT_LOADER="Failed to load the Zoom chat client or the consentGrantedProceedDBXSalesChatToLoad method is missing.",e.MISSING_BUSINESS_HOURS_CONFIG="Missing configuration data for business hours.",e.MISSING_BUSINESS_TIMEZONE="Missing business timezone configuration.",e.MISSING_BUSINESS_HOURS="Missing business hours.",e.MISSING_CUSTOM_HOUR_RANGES="Business hours configuration does not contain customHourRanges.",e.ZOOM_CHAT_CONSENT_DECLINED="User declined consent, did not load the Zoom chat client.",e.MISSING_RELOAD_ZOOM_CHAT_CLIENT="Zoom Chat client is not available or reloadZoomChatClient is missing.",e.DETECTED_CHECKOUT_PAGE_WITHOUT_DASH_PARAMS="Chat should not be loaded in /checkout page without 'try_dash_for_teams' or 'dash_for_teams' query parameter."}(be||(be={}));const De={type:e.Critical,message:be.INVALID_ENTRY_PAGE_KEY},ye={type:e.Operational,message:be.NO_ENTRY_PATH},Re={type:e.NonCritical,message:be.ENTRY_PAGE_KEY_NULL_OR_UNDEFINED},we={type:e.Operational,message:be.NO_VALID_ENTRY_PAGE},Pe={type:e.Operational,message:be.DETECTED_LOGIN_PAGE_WITHOUT_COOKIE},Ue={type:e.Operational,message:be.DETECTED_CHECKOUT_PAGE_WITHOUT_DASH_PARAMS},He={type:e.Critical,message:be.INVALID_CHAT_COOKIE},Le={type:e.Critical,message:be.NO_VALID_CHAT_COOKIE},ke={type:e.Critical,message:be.INVALID_CHAT_TYPE},Fe={type:e.Operational,message:be.UNIFIED_CHAT_COOKIE_NOT_SET},Be={type:e.Critical,message:be.INITIALIZATION_FAILED},Me={type:e.Operational,message:be.NO_MATCHING_DOMAIN},We={type:e.Critical,message:be.INVALID_ENTRY_POINT},xe={type:e.Critical,message:be.PAGE_PATH_VERIFICATION},Xe={type:e.UserError,message:be.FETCH_HOSTNAME},Ge={type:e.UserError,message:be.FETCH_PATHNAME},Ze={type:e.Critical,message:be.UNSUPPORTED_ENTITLEMENTS},Ve={type:e.Operational,message:be.OUTSIDE_OPERATIONAL_HOURS},$e={type:e.Critical,message:be.ZOOM_CHAT_CONSENT_LOADER},ze={type:e.Critical,message:be.MISSING_BUSINESS_HOURS_CONFIG},Ke={type:e.Critical,message:be.MISSING_BUSINESS_TIMEZONE},Je={type:e.Critical,message:be.MISSING_BUSINESS_HOURS},je={type:e.Critical,message:be.MISSING_CUSTOM_HOUR_RANGES},qe=e.NonCritical,Ye=be.ZOOM_CHAT_CONSENT_DECLINED,Qe={type:e.NonCritical,message:be.ERROR_CONSENT_METHOD_UNAVAILABLE},et={type:e.Critical,message:be.ERROR_OPEN_CHAT_WINDOW_METHOD_UNAVAILABLE},tt={type:e.Critical,message:be.MISSING_RELOAD_ZOOM_CHAT_CLIENT};function it(e,t){if(!e)throw new Error(t)}const nt=34028234663852886e22,at=-34028234663852886e22,ot=4294967295,st=2147483647,rt=-2147483648;function lt(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>st||e<rt)throw new Error("invalid int 32: "+e)}function dt(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>ot||e<0)throw new Error("invalid uint 32: "+e)}function ct(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>nt||e<at))throw new Error("invalid float 32: "+e)}const ut=Symbol("@bufbuild/protobuf/enum-type");function ht(e){const t=e[ut];return it(t,"missing enum type on enum object"),t}function ft(e,t,i,n){e[ut]=Ct(t,i.map((t=>({no:t.no,name:t.name,localName:e[t.no]}))),n)}function Ct(e,t,i){const n=Object.create(null),a=Object.create(null),o=[];for(const e of t){const t=Et(e);o.push(t),n[e.name]=t,a[e.no]=t}return{typeName:e,values:o,findName:e=>n[e],findNumber:e=>a[e]}}function gt(e,t,i){const n={};for(const e of t){const t=Et(e);n[t.localName]=t.no,n[t.no]=t.localName}return ft(n,e,t,i),n}function Et(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class St{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const i=undefined,n=this.getType().runtime.bin,a=n.makeReadOptions(t);return n.readMessage(this,a.readerFactory(e),e.byteLength,a),this}fromJson(e,t){const i=this.getType(),n=i.runtime.json,a=n.makeReadOptions(t);return n.readMessage(i,e,a,this),this}fromJsonString(e,t){return this.fromJson(JSON.parse(e),t)}toBinary(e){const t=undefined,i=this.getType().runtime.bin,n=i.makeWriteOptions(e),a=n.writerFactory();return i.writeMessage(this,a,n),a.finish()}toJson(e){const t=undefined,i=this.getType().runtime.json,n=i.makeWriteOptions(e);return i.writeMessage(this,n)}toJsonString(e){var t;const i=this.toJson(e);return JSON.stringify(i,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}getType(){return Object.getPrototypeOf(this).constructor}}function mt(e,t,i,n){var a;const o=null!==(a=null==n?void 0:n.localName)&&void 0!==a?a:t.substring(t.lastIndexOf(".")+1),s={[o]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[o];return Object.setPrototypeOf(s.prototype,new St),Object.assign(s,{runtime:e,typeName:t,fields:e.util.newFieldList(i),fromBinary:(e,t)=>(new s).fromBinary(e,t),fromJson:(e,t)=>(new s).fromJson(e,t),fromJsonString:(e,t)=>(new s).fromJsonString(e,t),equals:(t,i)=>e.util.equals(s,t,i)}),s}function Tt(e,t,i,n){return{syntax:e,json:t,bin:i,util:n,makeMessageType(e,t,i){return mt(this,e,t,i)},makeEnum:gt,makeEnumType:Ct,getEnumType:ht}}var _t;function pt(){let e=0,t=0;for(let i=0;i<28;i+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}let i=this.buf[this.pos++];if(e|=(15&i)<<28,t=(112&i)>>4,0==(128&i))return this.assertBounds(),[e,t];for(let i=3;i<=31;i+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function It(e,t,i){for(let n=0;n<28;n+=7){const a=e>>>n,o=!(a>>>7==0&&0==t),s=255&(o?128|a:a);if(i.push(s),!o)return}const n=e>>>28&15|(7&t)<<4,a=!(t>>3==0);if(i.push(255&(a?128|n:n)),a){for(let e=3;e<31;e+=7){const n=t>>>e,a=!(n>>>7==0),o=255&(a?128|n:n);if(i.push(o),!a)return}i.push(t>>>31&1)}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(_t||(_t={}));const vt=4294967296;function At(e){const t="-"===e[0];t&&(e=e.slice(1));const i=1e6;let n=0,a=0;function o(t,o){const s=Number(e.slice(t,o));a*=i,n=n*i+s,n>=vt&&(a+=n/vt|0,n%=vt)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),t?yt(n,a):Dt(n,a)}function Ot(e,t){let i=Dt(e,t);const n=2147483648&i.hi;n&&(i=yt(i.lo,i.hi));const a=Nt(i.lo,i.hi);return n?"-"+a:a}function Nt(e,t){if(({lo:e,hi:t}=bt(e,t)),t<=2097151)return String(vt*t+e);const i=undefined,n=16777215&(e>>>24|t<<8),a=t>>16&65535;let o=(16777215&e)+6777216*n+6710656*a,s=n+8147497*a,r=2*a;const l=1e7;return o>=l&&(s+=Math.floor(o/l),o%=l),s>=l&&(r+=Math.floor(s/l),s%=l),r.toString()+Rt(s)+Rt(o)}function bt(e,t){return{lo:e>>>0,hi:t>>>0}}function Dt(e,t){return{lo:0|e,hi:0|t}}function yt(e,t){return t=~t,e?e=1+~e:t+=1,Dt(e,t)}const Rt=e=>{const t=String(e);return"0000000".slice(t.length)+t};function wt(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let i=0;i<9;i++)t.push(127&e|128),e>>=7;t.push(1)}}function Pt(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;0!=(128&e)&&t<10;t++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}function Ut(){const e=new DataView(new ArrayBuffer(8)),t=undefined;if(void 0!==globalThis.BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),i=BigInt("9223372036854775807"),n=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const n="bigint"==typeof e?e:BigInt(e);if(n>i||n<t)throw new Error(`int64 invalid: ${e}`);return n},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>a||t<n)throw new Error(`uint64 invalid: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,i)=>(e.setInt32(0,t,!0),e.setInt32(4,i,!0),e.getBigInt64(0,!0)),uDec:(t,i)=>(e.setInt32(0,t,!0),e.setInt32(4,i,!0),e.getBigUint64(0,!0))}}const i=e=>it(/^-?[0-9]+$/.test(e),`int64 invalid: ${e}`),n=e=>it(/^[0-9]+$/.test(e),`uint64 invalid: ${e}`);return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),i(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),i(e),At(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),At(e)),dec:(e,t)=>Ot(e,t),uDec:(e,t)=>Nt(e,t)}}const Ht=Ut();var Lt;!function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Lt||(Lt={}));class kt{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),i=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],i),i+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(dt(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return lt(e),wt(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){ct(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){dt(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){lt(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return lt(e),wt(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),i=new DataView(t.buffer),n=Ht.enc(e);return i.setInt32(0,n.lo,!0),i.setInt32(4,n.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),i=new DataView(t.buffer),n=Ht.uEnc(e);return i.setInt32(0,n.lo,!0),i.setInt32(4,n.hi,!0),this.raw(t)}int64(e){let t=Ht.enc(e);return It(t.lo,t.hi,this.buf),this}sint64(e){let t=Ht.enc(e),i=t.hi>>31,n,a;return It(t.lo<<1^i,(t.hi<<1|t.lo>>>31)^i,this.buf),this}uint64(e){let t=Ht.uEnc(e);return It(t.lo,t.hi,this.buf),this}}class Ft{constructor(e,t){this.varint64=pt,this.uint32=Pt,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,i=7&e;if(t<=0||i<0||i>5)throw new Error("illegal tag: field no "+t+" wire type "+i);return[t,i]}skip(e){let t=this.pos;switch(e){case Lt.Varint:for(;128&this.buf[this.pos++];);break;case Lt.Bit64:this.pos+=4;case Lt.Bit32:this.pos+=4;break;case Lt.LengthDelimited:let t=this.uint32();this.pos+=t;break;case Lt.StartGroup:let i;for(;(i=this.tag()[1])!==Lt.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return Ht.dec(...this.varint64())}uint64(){return Ht.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),i=-(1&e);return e=(e>>>1|(1&t)<<31)^i,t=t>>>1^i,Ht.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ht.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ht.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function Bt(e,t){if(t instanceof e)return t;if(e.fieldWrapper)return e.fieldWrapper.wrapField(t);throw new Error(`cannot unwrap field value, ${e.typeName} does not define a field wrapper`)}function Mt(e,t){return e.fieldWrapper?e.fieldWrapper.unwrapField(t):t}function Wt(e){if("message"===e.fieldKind&&!e.repeated&&null==e.oneof)return xt[e.message.typeName]}const xt={"google.protobuf.DoubleValue":_t.DOUBLE,"google.protobuf.FloatValue":_t.FLOAT,"google.protobuf.Int64Value":_t.INT64,"google.protobuf.UInt64Value":_t.UINT64,"google.protobuf.Int32Value":_t.INT32,"google.protobuf.UInt32Value":_t.UINT32,"google.protobuf.BoolValue":_t.BOOL,"google.protobuf.StringValue":_t.STRING,"google.protobuf.BytesValue":_t.BYTES};function Xt(e,t,i){if(t===i)return!0;if(e==_t.BYTES){if(!(t instanceof Uint8Array&&i instanceof Uint8Array))return!1;if(t.length!==i.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==i[e])return!1;return!0}switch(e){case _t.UINT64:case _t.FIXED64:case _t.INT64:case _t.SFIXED64:case _t.SINT64:return t==i}return!1}function Gt(e){switch(e){case _t.BOOL:return!1;case _t.UINT64:case _t.FIXED64:case _t.INT64:case _t.SFIXED64:case _t.SINT64:return Ht.zero;case _t.DOUBLE:case _t.FLOAT:return 0;case _t.BYTES:return new Uint8Array(0);case _t.STRING:return"";default:return 0}}function Zt(e,t){const i=void 0===t;let n=Lt.Varint,a=0===t;switch(e){case _t.STRING:a=i||!t.length,n=Lt.LengthDelimited;break;case _t.BOOL:a=!1===t;break;case _t.DOUBLE:n=Lt.Bit64;break;case _t.FLOAT:n=Lt.Bit32;break;case _t.INT64:case _t.UINT64:a=i||0==t;break;case _t.FIXED64:a=i||0==t,n=Lt.Bit64;break;case _t.BYTES:a=i||!t.byteLength,n=Lt.LengthDelimited;break;case _t.FIXED32:case _t.SFIXED32:n=Lt.Bit32;break;case _t.SFIXED64:a=i||0==t,n=Lt.Bit64;break;case _t.SINT64:a=i||0==t}const o=undefined;return[n,_t[e].toLowerCase(),i||a]}const Vt=Symbol("@bufbuild/protobuf/unknown-fields"),$t={readUnknownFields:!0,readerFactory:e=>new Ft(e)},zt={writeUnknownFields:!0,writerFactory:()=>new kt};function Kt(e){return e?Object.assign(Object.assign({},$t),e):$t}function Jt(e){return e?Object.assign(Object.assign({},zt),e):zt}function jt(){return{makeReadOptions:Kt,makeWriteOptions:Jt,listUnknownFields(e){var t;return null!==(t=e[Vt])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[Vt]},writeUnknownFields(e,t){const i=undefined,n=e[Vt];if(n)for(const e of n)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,i,n){const a=e;Array.isArray(a[Vt])||(a[Vt]=[]),a[Vt].push({no:t,wireType:i,data:n})},readMessage(e,t,i,n){const a=e.getType(),o=void 0===i?t.len:t.pos+i;for(;t.pos<o;){const[i,o]=t.tag(),s=a.fields.find(i);if(!s){const a=t.skip(o);n.readUnknownFields&&this.onUnknownField(e,i,o,a);continue}let r=e,l=s.repeated,d=s.localName;switch(s.oneof&&(r=r[s.oneof.localName],r.case!=d&&delete r.value,r.case=d,d="value"),s.kind){case"scalar":case"enum":const e="enum"==s.kind?_t.INT32:s.T;if(l){let i=r[d];if(o==Lt.LengthDelimited&&e!=_t.STRING&&e!=_t.BYTES){let n=t.uint32()+t.pos;for(;t.pos<n;)i.push(Yt(t,e))}else i.push(Yt(t,e))}else r[d]=Yt(t,e);break;case"message":const i=s.T;l?r[d].push(i.fromBinary(t.bytes(),n)):r[d]instanceof i?r[d].fromBinary(t.bytes(),n):r[d]=Mt(i,i.fromBinary(t.bytes(),n));break;case"map":let[a,c]=qt(s,t,n);r[d][a]=c}}}}}function qt(e,t,i){const n=t.uint32(),a=t.pos+n;let o,s;for(;t.pos<a;){let[n]=t.tag();switch(n){case 1:o=Yt(t,e.K);break;case 2:switch(e.V.kind){case"scalar":s=Yt(t,e.V.T);break;case"enum":s=t.int32();break;case"message":s=e.V.T.fromBinary(t.bytes(),i)}}}if(void 0===o){let t=Gt(e.K);o=e.K==_t.BOOL?t.toString():t}if("string"!=typeof o&&"number"!=typeof o&&(o=o.toString()),void 0===s)switch(e.V.kind){case"scalar":s=Gt(e.V.T);break;case"enum":s=0;break;case"message":s=new e.V.T}return[o,s]}function Yt(e,t){let[,i]=Zt(t);return e[i]()}function Qt(e,t,i,n,a){e.tag(i.no,Lt.LengthDelimited),e.fork();let o=n;switch(i.K){case _t.INT32:case _t.FIXED32:case _t.UINT32:case _t.SFIXED32:case _t.SINT32:o=Number.parseInt(n);break;case _t.BOOL:it("true"==n||"false"==n),o="true"==n}switch(ti(e,i.K,1,o,!0),i.V.kind){case"scalar":ti(e,i.V.T,2,a,!0);break;case"enum":ti(e,_t.INT32,2,a,!0);break;case"message":ei(e,t,i.V.T,2,a)}e.join()}function ei(e,t,i,n,a){if(void 0!==a){const o=Bt(i,a);e.tag(n,Lt.LengthDelimited).bytes(o.toBinary(t))}}function ti(e,t,i,n,a){let[o,s,r]=Zt(t,n);r&&!a||e.tag(i,o)[s](n)}function ii(e,t,i,n){if(!n.length)return;e.tag(i,Lt.LengthDelimited).fork();let[,a]=Zt(t);for(let t=0;t<n.length;t++)e[a](n[t]);e.join()}function ni(){return Object.assign(Object.assign({},jt()),{writeMessage(e,t,i){const n=e.getType();for(const a of n.fields.byNumber()){let n,o=a.repeated,s=a.localName;if(a.oneof){const t=e[a.oneof.localName];if(t.case!==s)continue;n=t.value}else n=e[s];switch(a.kind){case"scalar":case"enum":let e="enum"==a.kind?_t.INT32:a.T;if(o)if(a.packed)ii(t,e,a.no,n);else for(const i of n)ti(t,e,a.no,i,!0);else void 0!==n&&ti(t,e,a.no,n,!!a.oneof||a.opt);break;case"message":if(o)for(const e of n)ei(t,i,a.T,a.no,e);else ei(t,i,a.T,a.no,n);break;case"map":for(const[e,o]of Object.entries(n))Qt(t,i,a,e,o)}}return i.writeUnknownFields&&this.writeUnknownFields(e,t),t}})}let ai="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),oi=[];for(let e=0;e<ai.length;e++)oi[ai[e].charCodeAt(0)]=e;oi["-".charCodeAt(0)]=ai.indexOf("+"),oi["_".charCodeAt(0)]=ai.indexOf("/");const si={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let i=new Uint8Array(t),n=0,a=0,o,s=0;for(let t=0;t<e.length;t++){if(o=oi[e.charCodeAt(t)],void 0===o)switch(e[t]){case"=":a=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(a){case 0:s=o,a=1;break;case 1:i[n++]=s<<2|(48&o)>>4,s=o,a=2;break;case 2:i[n++]=(15&s)<<4|(60&o)>>2,s=o,a=3;break;case 3:i[n++]=(3&s)<<6|o,a=0}}if(1==a)throw Error("invalid base64 string.");return i.subarray(0,n)},enc(e){let t="",i=0,n,a=0;for(let o=0;o<e.length;o++)switch(n=e[o],i){case 0:t+=ai[n>>2],a=(3&n)<<4,i=1;break;case 1:t+=ai[a|n>>4],a=(15&n)<<2,i=2;break;case 2:t+=ai[a|n>>6],t+=ai[63&n],i=0}return i&&(t+=ai[a],t+="=",1==i&&(t+="=")),t}},ri={ignoreUnknownFields:!1},li={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function di(e){return e?Object.assign(Object.assign({},ri),e):ri}function ci(e){return e?Object.assign(Object.assign({},li),e):li}function ui(e){const t=e(gi,Ei);return{makeReadOptions:di,makeWriteOptions:ci,readMessage(e,t,i,n){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error(`cannot decode message ${e.typeName} from JSON: ${this.debug(t)}`);n=null!=n?n:new e;const a={};for(const[o,s]of Object.entries(t)){const t=e.fields.findJsonName(o);if(!t){if(!i.ignoreUnknownFields)throw new Error(`cannot decode message ${e.typeName} from JSON: key "${o}" is unknown`);continue}let r=t.localName,l=n;if(t.oneof){if(null===s&&"scalar"==t.kind)continue;const i=a[t.oneof.localName];if(i)throw new Error(`cannot decode message ${e.typeName} from JSON: multiple keys for oneof "${t.oneof.name}" present: "${i}", "${o}"`);a[t.oneof.localName]=o,l=l[t.oneof.localName]={case:r},r="value"}if(t.repeated){if(null===s)continue;if(!Array.isArray(s))throw new Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`);const n=l[r];for(const a of s){if(null===a)throw new Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(a)}`);let o;switch(t.kind){case"message":o=t.T.fromJson(a,i);break;case"enum":if(o=Ci(t.T,a,i.ignoreUnknownFields),void 0===o)continue;break;case"scalar":try{o=fi(t.T,a)}catch(i){let n=`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(a)}`;throw i instanceof Error&&i.message.length>0&&(n+=`: ${i.message}`),new Error(n)}}n.push(o)}}else if("map"==t.kind){if(null===s)continue;if(Array.isArray(s)||"object"!=typeof s)throw new Error(`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`);const n=l[r];for(const[a,o]of Object.entries(s)){if(null===o)throw new Error(`cannot decode field ${e.typeName}.${t.name} from JSON: map value null`);let r;switch(t.V.kind){case"message":r=t.V.T.fromJson(o,i);break;case"enum":if(r=Ci(t.V.T,o,i.ignoreUnknownFields),void 0===r)continue;break;case"scalar":try{r=fi(t.V.T,o)}catch(i){let n=`cannot decode map value for field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`;throw i instanceof Error&&i.message.length>0&&(n+=`: ${i.message}`),new Error(n)}}try{n[fi(t.K,t.K==_t.BOOL?"true"==a||"false"!=a&&a:a).toString()]=r}catch(i){let n=`cannot decode map key for field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`;throw i instanceof Error&&i.message.length>0&&(n+=`: ${i.message}`),new Error(n)}}}else switch(t.kind){case"message":const n=t.T;if(null===s&&"google.protobuf.Value"!=n.typeName){if(t.oneof)throw new Error(`cannot decode field ${e.typeName}.${t.name} from JSON: null is invalid for oneof field "${o}"`);continue}const a=void 0===l[r]?new n:Bt(n,l[r]);l[r]=Mt(n,a.fromJson(s,i));break;case"enum":const d=Ci(t.T,s,i.ignoreUnknownFields);void 0!==d&&(l[r]=d);break;case"scalar":try{l[r]=fi(t.T,s)}catch(i){let n=`cannot decode field ${e.typeName}.${t.name} from JSON: ${this.debug(s)}`;throw i instanceof Error&&i.message.length>0&&(n+=`: ${i.message}`),new Error(n)}}}return n},writeMessage(e,i){const n=e.getType(),a={};let o;try{for(const s of n.fields.byMember()){let n;if("oneof"==s.kind){const a=e[s.localName];if(void 0===a.value)continue;if(o=s.findField(a.case),!o)throw"oneof case not found: "+a.case;n=t(o,a.value,i)}else o=s,n=t(o,e[o.localName],i);void 0!==n&&(a[i.useProtoFieldName?o.name:o.jsonName]=n)}}catch(e){const t=o?`cannot encode field ${n.typeName}.${o.name} to JSON`:`cannot encode message ${n.typeName} to JSON`,i=e instanceof Error?e.message:String(e);throw new Error(t+(i.length>0?`: ${i}`:""))}return a},readScalar:fi,writeScalar:Ei,debug:hi}}function hi(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":`"${e.split('"').join('\\"')}"`;default:return e.toString()}}function fi(e,t){switch(e){case _t.DOUBLE:case _t.FLOAT:if(null===t)return 0;if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const i=Number(t);if(Number.isNaN(i))break;if(!Number.isFinite(i))break;return e==_t.FLOAT&&ct(i),i;case _t.INT32:case _t.FIXED32:case _t.SFIXED32:case _t.SINT32:case _t.UINT32:if(null===t)return 0;let n;if("number"==typeof t?n=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(n=Number(t)),void 0===n)break;return e==_t.UINT32?dt(n):lt(n),n;case _t.INT64:case _t.SFIXED64:case _t.SINT64:if(null===t)return Ht.zero;if("number"!=typeof t&&"string"!=typeof t)break;return Ht.parse(t);case _t.FIXED64:case _t.UINT64:if(null===t)return Ht.zero;if("number"!=typeof t&&"string"!=typeof t)break;return Ht.uParse(t);case _t.BOOL:if(null===t)return!1;if("boolean"!=typeof t)break;return t;case _t.STRING:if(null===t)return"";if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw new Error("invalid UTF8")}return t;case _t.BYTES:if(null===t||""===t)return new Uint8Array(0);if("string"!=typeof t)break;return si.dec(t)}throw new Error}function Ci(e,t,i){if(null===t)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const n=e.findName(t);if(n||i)return null==n?void 0:n.no}throw new Error(`cannot decode enum ${e.typeName} from JSON: ${hi(t)}`)}function gi(e,t,i,n){var a;if(void 0===t)return t;if(0===t&&!i)return;if(n)return t;if("google.protobuf.NullValue"==e.typeName)return null;const o=e.findNumber(t);return null!==(a=null==o?void 0:o.name)&&void 0!==a?a:t}function Ei(e,t,i){if(void 0!==t)switch(e){case _t.INT32:case _t.SFIXED32:case _t.SINT32:case _t.FIXED32:case _t.UINT32:return it("number"==typeof t),0!=t||i?t:void 0;case _t.FLOAT:case _t.DOUBLE:return it("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":0!==t||i?t:void 0;case _t.STRING:return it("string"==typeof t),t.length>0||i?t:void 0;case _t.BOOL:return it("boolean"==typeof t),t||i?t:void 0;case _t.UINT64:case _t.FIXED64:case _t.INT64:case _t.SFIXED64:case _t.SINT64:return it("bigint"==typeof t||"string"==typeof t||"number"==typeof t),i||0!=t?t.toString(10):void 0;case _t.BYTES:return it(t instanceof Uint8Array),i||t.byteLength>0?si.enc(t):void 0}}function Si(){return ui(((e,t)=>function i(n,a,o){if("map"==n.kind){const i={};switch(n.V.kind){case"scalar":for(const[e,o]of Object.entries(a)){const a=t(n.V.T,o,!0);it(void 0!==a),i[e.toString()]=a}break;case"message":for(const[e,t]of Object.entries(a))i[e.toString()]=t.toJson(o);break;case"enum":const s=n.V.T;for(const[t,n]of Object.entries(a)){it(void 0===n||"number"==typeof n);const a=e(s,n,!0,o.enumAsInteger);it(void 0!==a),i[t.toString()]=a}}return o.emitDefaultValues||Object.keys(i).length>0?i:void 0}if(n.repeated){const i=[];switch(n.kind){case"scalar":for(let e=0;e<a.length;e++)i.push(t(n.T,a[e],!0));break;case"enum":for(let t=0;t<a.length;t++)i.push(e(n.T,a[t],!0,o.enumAsInteger));break;case"message":for(let e=0;e<a.length;e++)i.push(Bt(n.T,a[e]).toJson(o))}return o.emitDefaultValues||i.length>0?i:void 0}switch(n.kind){case"scalar":return t(n.T,a,!!n.oneof||n.opt||o.emitDefaultValues);case"enum":return e(n.T,a,!!n.oneof||n.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return void 0!==a?Bt(n.T,a).toJson(o):void 0}}))}function mi(){return{setEnumType:ft,initPartial(e,t){if(void 0===e)return;const i=t.getType();for(const n of i.fields.byMember()){const i=n.localName,a=t,o=e;if(void 0!==o[i])switch(n.kind){case"oneof":const e=o[i].case;if(void 0===e)continue;const t=n.findField(e);let s=o[i].value;!t||"message"!=t.kind||s instanceof t.T||(s=new t.T(s)),a[i]={case:e,value:s};break;case"scalar":case"enum":a[i]=o[i];break;case"map":switch(n.V.kind){case"scalar":case"enum":Object.assign(a[i],o[i]);break;case"message":const e=n.V.T;for(const t of Object.keys(o[i])){let n=o[i][t];e.fieldWrapper||(n=new e(n)),a[i][t]=n}}break;case"message":const r=n.T;if(n.repeated)a[i]=o[i].map((e=>e instanceof r?e:new r(e)));else if(void 0!==o[i]){const e=o[i];r.fieldWrapper?a[i]=e:a[i]=e instanceof r?e:new r(e)}}}},equals:(e,t,i)=>t===i||!(!t||!i)&&e.fields.byMember().every((e=>{const n=t[e.localName],a=i[e.localName];if(e.repeated){if(n.length!==a.length)return!1;switch(e.kind){case"message":return n.every(((t,i)=>e.T.equals(t,a[i])));case"scalar":return n.every(((t,i)=>Xt(e.T,t,a[i])));case"enum":return n.every(((e,t)=>Xt(_t.INT32,e,a[t])))}throw new Error(`repeated cannot contain ${e.kind}`)}switch(e.kind){case"message":return e.T.equals(n,a);case"enum":return Xt(_t.INT32,n,a);case"scalar":return Xt(e.T,n,a);case"oneof":if(n.case!==a.case)return!1;const t=n.case,i=e.findField(t);if(void 0===i)return!0;switch(i.kind){case"message":return i.T.equals(n[t],a[t]);case"enum":return Xt(_t.INT32,n,a);case"scalar":return Xt(i.T,n,a)}throw new Error(`oneof cannot contain ${i.kind}`);case"map":const o=Object.keys(n);if(o.some((e=>void 0===a[e])))return!1;switch(e.V.kind){case"message":const t=e.V.T;return o.every((e=>t.equals(n[e],a[e])));case"enum":return o.every((e=>Xt(_t.INT32,n[e],a[e])));case"scalar":const i=e.V.T;return o.every((e=>Xt(i,n[e],a[e])))}}})),clone(e){const t=e.getType(),i=new t,n=i;for(const i of t.fields.byMember()){const t=e[i.localName];let a;if(i.repeated)a=t.map((e=>Ti(i,e)));else if("map"==i.kind){a=n[i.localName];for(const[e,n]of Object.entries(t))a[e]=Ti(i.V,n)}else if("oneof"==i.kind){const e=i.findField(t.case);a=e?{case:t.case,value:Ti(e,t.value)}:{case:void 0}}else a=Ti(i,t);n[i.localName]=a}return i}}}function Ti(e,t){if(void 0===t)return t;switch(e.kind){case"enum":return t;case"scalar":if(e.T===_t.BYTES){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t;case"message":return e.T.fieldWrapper?e.T.fieldWrapper.unwrapField(e.T.fieldWrapper.wrapField(t).clone()):t.clone()}}class _i{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort(((e,t)=>e.no-t.no))),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const i of this.list())i.oneof?i.oneof!==t&&(t=i.oneof,e.push(t)):e.push(i)}return this.members}}function pi(e){switch(e.kind){case"field":return Ii(e.name,void 0!==e.oneof);case"oneof":return vi(e.name);case"enum":case"message":case"service":{const t=e.file.proto.package,i=void 0===t?0:t.length+1,n=e.typeName.substring(i).replace(/\./g,"_");return Di[n]?n+"$":n}case"enum_value":{const t=e.parent.sharedPrefix;if(void 0===t)return e.name;const i=e.name.substring(t.length);return yi[i]?i+"$":i}case"rpc":{let t=e.name;return 0==t.length?t:(t=t[0].toLowerCase()+t.substring(1),yi[t]?t+"$":t)}}}function Ii(e,t){let i=bi(e);return t||(yi[i]||Ri[i])&&(i+="$"),i}function vi(e){return Ii(e,!1)}const Ai=bi;function Oi(e,t){const i=Ni(e)+"_";for(const e of t){if(!e.toLowerCase().startsWith(i))return;const t=e.substring(i.length);if(0==t.length)return;if(/^\d/.test(t))return}return i}function Ni(e){return(e.substring(0,1)+e.substring(1).replace(/[A-Z]/g,(e=>"_"+e))).toLowerCase()}function bi(e){let t=!1;const i=[];for(let n=0;n<e.length;n++){let a=e.charAt(n);switch(a){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i.push(a),t=!1;break;default:t&&(t=!1,a=a.toUpperCase()),i.push(a)}}return i.join("")}const Di={break:!0,case:!0,catch:!0,class:!0,const:!0,continue:!0,debugger:!0,default:!0,delete:!0,do:!0,else:!0,export:!0,extends:!0,false:!0,finally:!0,for:!0,function:!0,if:!0,import:!0,in:!0,instanceof:!0,new:!0,null:!0,return:!0,super:!0,switch:!0,this:!0,throw:!0,true:!0,try:!0,typeof:!0,var:!0,void:!0,while:!0,with:!0,yield:!0,enum:!0,implements:!0,interface:!0,let:!0,package:!0,private:!0,protected:!0,public:!0,static:!0,Object:!0,bigint:!0,number:!0,boolean:!0,string:!0,object:!0,globalThis:!0,Uint8Array:!0,Partial:!0},yi={constructor:!0,toString:!0,toJSON:!0,valueOf:!0},Ri={getType:!0,clone:!0,equals:!0,fromBinary:!0,fromJson:!0,fromJsonString:!0,toBinary:!0,toJson:!0,toJsonString:!0,toObject:!0};class wi{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=vi(e)}addField(e){it(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const Pi=Tt("proto3",Si(),ni(),Object.assign(Object.assign({},mi()),{newFieldList:e=>new _i(e,Ui),initFields(e){for(const t of e.getType().fields.byMember()){if(t.opt)continue;const i=t.localName,n=e;if(t.repeated)n[i]=[];else switch(t.kind){case"oneof":n[i]={case:void 0};break;case"enum":n[i]=0;break;case"map":n[i]={};break;case"scalar":n[i]=Gt(t.T)}}}}));function Ui(e){var t,i,n;const a=[];let o;for(const s of"function"==typeof e?e():e){const e=s;if(e.localName=Ii(s.name,void 0!==s.oneof),e.jsonName=null!==(t=s.jsonName)&&void 0!==t?t:Ai(s.name),e.repeated=null!==(i=s.repeated)&&void 0!==i&&i,e.packed=null!==(n=s.packed)&&void 0!==n?n:"enum"==s.kind||"scalar"==s.kind&&s.T!=_t.BYTES&&s.T!=_t.STRING,void 0!==s.oneof){const t="string"==typeof s.oneof?s.oneof:s.oneof.name;o&&o.name==t||(o=new wi(t)),e.oneof=o,o.addField(e)}a.push(e)}return a}class Hi extends St{constructor(e){super(),this.seconds=Ht.zero,this.nanos=0,Pi.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${Pi.json.debug(e)}`);const i=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!i)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const n=Date.parse(i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]+":"+i[6]+(i[8]?i[8]:"Z"));if(Number.isNaN(n))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ht.parse(n/1e3),this.nanos=0,i[7]&&(this.nanos=parseInt("1"+i[7]+"0".repeat(9-i[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let i="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);i="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",i)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return Hi.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new Hi({seconds:Ht.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new Hi).fromBinary(e,t)}static fromJson(e,t){return(new Hi).fromJson(e,t)}static fromJsonString(e,t){return(new Hi).fromJsonString(e,t)}static equals(e,t){return Pi.util.equals(Hi,e,t)}}var Li,ki,Fi,Bi,Mi,Wi,xi;Hi.runtime=Pi,Hi.typeName="google.protobuf.Timestamp",Hi.fields=Pi.util.newFieldList((()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}])),function(e){e[e.UNKNOWN_AVAILABILITY=0]="UNKNOWN_AVAILABILITY",e[e.MF_BUSINESS_HOURS=1]="MF_BUSINESS_HOURS",e[e.MF_24_HOURS=2]="MF_24_HOURS",e[e.ALWAYS_AVAILABLE_247=3]="ALWAYS_AVAILABLE_247"}(Li||(Li={})),Pi.util.setEnumType(Li,"support.Availability",[{no:0,name:"UNKNOWN_AVAILABILITY"},{no:1,name:"MF_BUSINESS_HOURS"},{no:2,name:"MF_24_HOURS"},{no:3,name:"ALWAYS_AVAILABLE_247"}]),function(e){e[e.UNKNOWN_CHANNEL=0]="UNKNOWN_CHANNEL",e[e.CHATBOT=1]="CHATBOT",e[e.LIMITED_EMAIL=2]="LIMITED_EMAIL",e[e.EMAIL=3]="EMAIL",e[e.CHAT=4]="CHAT",e[e.LIMITED_PHONE=5]="LIMITED_PHONE",e[e.PHONE=6]="PHONE"}(ki||(ki={})),Pi.util.setEnumType(ki,"support.Channel",[{no:0,name:"UNKNOWN_CHANNEL"},{no:1,name:"CHATBOT"},{no:2,name:"LIMITED_EMAIL"},{no:3,name:"EMAIL"},{no:4,name:"CHAT"},{no:5,name:"LIMITED_PHONE"},{no:6,name:"PHONE"}]),function(e){e[e.UNKNOWN_LANGUAGE=0]="UNKNOWN_LANGUAGE",e[e.ENGLISH=1]="ENGLISH",e[e.SPANISH=2]="SPANISH",e[e.FRENCH=3]="FRENCH",e[e.GERMAN=4]="GERMAN",e[e.JAPANESE=5]="JAPANESE",e[e.PORTUGUESE=6]="PORTUGUESE"}(Fi||(Fi={})),Pi.util.setEnumType(Fi,"support.Language",[{no:0,name:"UNKNOWN_LANGUAGE"},{no:1,name:"ENGLISH"},{no:2,name:"SPANISH"},{no:3,name:"FRENCH"},{no:4,name:"GERMAN"},{no:5,name:"JAPANESE"},{no:6,name:"PORTUGUESE"}]);class Xi extends St{constructor(e){super(),this.days="",this.hours="",this.timezone="",Pi.util.initPartial(e,this)}static fromBinary(e,t){return(new Xi).fromBinary(e,t)}static fromJson(e,t){return(new Xi).fromJson(e,t)}static fromJsonString(e,t){return(new Xi).fromJsonString(e,t)}static equals(e,t){return Pi.util.equals(Xi,e,t)}}Xi.runtime=Pi,Xi.typeName="support.DaysHours",Xi.fields=Pi.util.newFieldList((()=>[{no:1,name:"days",kind:"scalar",T:9},{no:2,name:"hours",kind:"scalar",T:9},{no:3,name:"start_time",kind:"message",T:Hi},{no:4,name:"end_time",kind:"message",T:Hi},{no:5,name:"timezone",kind:"scalar",T:9}]));class Gi extends St{constructor(e){super(),this.isDuringOperatingHours=!1,this.description={case:void 0},this.isAvailable247=!1,Pi.util.initPartial(e,this)}static fromBinary(e,t){return(new Gi).fromBinary(e,t)}static fromJson(e,t){return(new Gi).fromJson(e,t)}static fromJsonString(e,t){return(new Gi).fromJsonString(e,t)}static equals(e,t){return Pi.util.equals(Gi,e,t)}}Gi.runtime=Pi,Gi.typeName="support.AvailabilityDescriptor",Gi.fields=Pi.util.newFieldList((()=>[{no:1,name:"is_during_operating_hours",kind:"scalar",T:8},{no:2,name:"days_hours",kind:"message",T:Xi,oneof:"description"},{no:3,name:"single_description",kind:"scalar",T:9,oneof:"description"},{no:4,name:"is_available_247",kind:"scalar",T:8}]));class Zi extends St{constructor(e){super(),this.language=Fi.UNKNOWN_LANGUAGE,Pi.util.initPartial(e,this)}static fromBinary(e,t){return(new Zi).fromBinary(e,t)}static fromJson(e,t){return(new Zi).fromJson(e,t)}static fromJsonString(e,t){return(new Zi).fromJsonString(e,t)}static equals(e,t){return Pi.util.equals(Zi,e,t)}}Zi.runtime=Pi,Zi.typeName="support.ChannelOption",Zi.fields=Pi.util.newFieldList((()=>[{no:1,name:"language",kind:"enum",T:Pi.getEnumType(Fi)},{no:2,name:"availability",kind:"message",T:Gi}]));class Vi extends St{constructor(e){super(),this.channel=ki.UNKNOWN_CHANNEL,this.alternativeOptions=[],Pi.util.initPartial(e,this)}static fromBinary(e,t){return(new Vi).fromBinary(e,t)}static fromJson(e,t){return(new Vi).fromJson(e,t)}static fromJsonString(e,t){return(new Vi).fromJsonString(e,t)}static equals(e,t){return Pi.util.equals(Vi,e,t)}}function $i(t,i,n){const a=null!=i?i:"";switch(t){case e.Critical:if(n){const e=n instanceof Error?n.message:String(n),t=n instanceof Error?n.stack:null,a={message:null!=i?i:"Error encountered during process",error:null!=e?e:"No additional error details provided",stack:null!=t?t:"No stack trace available",timestamp:(new Date).toISOString()};console.error("Critical error:",JSON.stringify(a,null,2))}else console.error("Critical error:",a);break;case e.NonCritical:console.warn(`Non-critical error: ${a}`);break;case e.Operational:console.warn(`Operational error: ${a}`);break;case e.UserError:console.error(`User error: ${a}`);break;case e.Uncaught:console.error(`Uncaught error: ${a}`);break;default:console.error(`Unknown error severity: ${a}`)}}function zi(t){const i=`Initialization aborted: No unified chat cookie found for ${t} chat.`;$i(e.Operational,i)}function Ki(t){const i=`Initialization aborted: Entry page key is null or undefined for ${t}.`;$i(e.NonCritical,i)}function Ji(t){const i=`Initialization aborted: Invalid entry page key detected (${t}).`;$i(e.NonCritical,i)}function ji(){const t="Initialization aborted: Chat disabled during non-operational hours.";$i(e.Operational,t)}function qi(){const t="Initialization aborted: Chat disabled during weekends.";$i(e.Operational,t)}function Yi(t){const i=`Initialization aborted: No valid entry page detected at ${t}.`;$i(e.Operational,i)}function Qi(){const t="Initialization aborted: LoginPageCookie not found to load chat at /login page.";$i(e.Operational,t)}function en(){const t="Initialization aborted: Missing 'try_dash_for_teams' or 'dash_for_teams' query parameter to load chat at /checkout page.";$i(e.Operational,t)}function tn(t){const i=`Initialization aborted: Unsupported chat type detected during ${t} setup.`;$i(e.Critical,i)}function nn(){const t="Initialization failed: Missing or invalid configuration details.";$i(e.Operational,t)}function an(t){const i=`Support Chat Initialization skipped. Is ${t} User.`;$i(e.Operational,i)}function on(){const t="Chat initialization skipped because chat is not allowed to load on this entry page when accessed from a mobile device.";$i(e.Operational,t)}function sn(){const t="Support Chat Initialization skipped. User identifiers are not available.";$i(e.Operational,t)}function rn(){const t="Allowing Support Chat Initialization. User identifiers are not available.";$i(e.NonCritical,t)}function ln(e){const t=`DBX Chat Initialization: Skipped due to subdomain flag. Is DBX Chat enabled for subdomains: ${e}.`;$i(ErrorSeverity.Operational,t)}function dn(){const t="Initialization aborted: Unrecognized or untrusted domain detected.";$i(e.UserError,t)}function cn(t,i){const n=`Initialization aborted: Missing entry path for host '${t}' at '${i}'.`;$i(e.Critical,n)}function un(){const e=window;return e._DBX_ZOOM_CHAT_CLIENT||(e._DBX_ZOOM_CHAT_CLIENT={}),e._DBX_ZOOM_CHAT_CLIENT}function hn(){const e=window;return void 0===e.zoomChatManagerDebugEnabled&&(e.zoomChatManagerDebugEnabled=!1),window.localStorage&&window.localStorage.getItem("zoom_chat_manager_debug")?e.zoomChatManagerDebugEnabled=!0:console.log('Debugging is not enabled because "zoom_chat_manager_debug" is not set in localStorage.'),e.zoomChatManagerDebugEnabled}function fn(e){const t=undefined;window.zoomChatManagerDebugEnabled&&console.debug&&console.debug(e)}function Cn(e,t,i,n){let a=`${e}=${t};expires=${i.toUTCString()};path=/`;n&&(a+=`;domain=${n}`),a+=";SameSite=None;Secure",document.cookie=a}function gn(e){const t=e+"=",i=document.cookie.split(";");for(const e of i){const i=e.trim();if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null}function En(e){fn(`setUnifiedChatCookie: Setting cookie for ${e}`);const t=new Date;t.setTime(t.getTime()+36e5);const i=F[e];e!==r.DBX_SALES_CHAT&&e!==r.DBX_CX_CHAT||Cn(S,i,t,k)}function Sn(){const e=new Date;e.setMinutes(e.getMinutes()+2),buildAndSetCookie(DBX_SALES_CHAT_LOGIN_COOKIE_KEY,DBX_SALES_CHAT_LOGIN_COOKIE,e)}function mn(e,t){let i=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;t&&(i+=` domain=${t};`),i+="SameSite=None;Secure",document.cookie=i}function Tn(e){switch(e){case w:return r.DBX_SALES_CHAT;case U:return r.DBX_CX_CHAT;default:return r.UNSUPPORTED_CHAT}}function _n(){const e=gn(S);return null==e?"":e}function pn(){const e=window;if(e._DBX_ZOOM_CHAT_CLIENT&&"function"==typeof e._DBX_ZOOM_CHAT_CLIENT.handleOnLogoutCallback){const t=getCookieValue(UNIFIED_CHAT_COOKIE_NAME);deleteUnifiedChatCookie(UNIFIED_CHAT_COOKIE_NAME,DBX_CHAT_WILDCARD_DOMAIN),e._DBX_ZOOM_CHAT_CLIENT.handleOnLogoutCallback(),t===SALES_CHAT_COOKIE_KEY&&createLoginCookieForDbxSalesChat()}}function In(e){console.error(e)}function vn(e,t){var i,n,a,o,r,l;return(null===(i=t.docsendEntitlements)||void 0===i?void 0:i.includes(e))?s.DOCSEND_HOST:(null===(n=t.wwwDbxEntitlements)||void 0===n?void 0:n.includes(e))?s.WWW_DBX_HOST:(null===(a=t.helpCenterEntitlements)||void 0===a?void 0:a.includes(e))?s.HELP_CENTER_HOST:(null===(o=t.experienceEntitlements)||void 0===o?void 0:o.includes(e))?s.EXPERIENCE_HOST:(null===(r=t.signCenterEntitlements)||void 0===r?void 0:r.includes(e))?s.SIGN_CENTER_HOST:(null===(l=t.dashDbxEntitlements)||void 0===l?void 0:l.includes(e))?s.DASH_DBX_HOST:s.UNSUPPORTED_HOST}function An(){return new Date}function On(e){return new Date(e.toLocaleString("en-US",{timeZone:"America/Los_Angeles"}))}function Nn(e){try{const t=undefined;return new URL(e).hostname}catch(e){return $i(Xe.type,Xe.message,e),""}}function bn(e){try{const t=undefined;return new URL(e).pathname}catch(e){return $i(Ge.type,Ge.message,e),""}}function Dn(e){const t=new URL(e),i={};for(const[e,n]of t.searchParams.entries())i[e.trim()]=n.trim();return i}function yn(e){var t;const i=e[H];return null!==(t=null==i?void 0:i.startsWith(L))&&void 0!==t&&t}function Rn(e,t){var i,n;const a=undefined,o=new Intl.DateTimeFormat("en-US",{timeZone:t,hour:"2-digit",minute:"2-digit",hour12:!1}).formatToParts(e),s=parseInt((null===(i=o.find((e=>"hour"===e.type)))||void 0===i?void 0:i.value)||"0",10),r=parseInt((null===(n=o.find((e=>"minute"===e.type)))||void 0===n?void 0:n.value)||"0",10),l=new Date(e);return l.setHours(s,r),l}function wn(t){if(!t)return $i(ze.type,ze.message),!1;try{if(!t.businessTimezone)return $i(Ke.type,Ke.message),!1;if(!t.businessHours)return $i(Je.type,Je.message),!1;const e=new Date,i=e.getDay();if(i<1||i>5)return!1;const n=Rn(e,t.businessTimezone);if(!t.businessHours.customHourRanges)return $i(je.type,je.message),!1;const a=t.businessHours.customHourRanges,o=new Date(n);o.setHours(parseInt(a.startTimeHours,10)),o.setMinutes(parseInt(a.startTimeMins,10)),o.setSeconds(0),o.setMilliseconds(0);const s=new Date(n);return s.setHours(parseInt(a.endTimeHours,10)),s.setMinutes(parseInt(a.endTimeMins,10)),s.setSeconds(0),s.setMilliseconds(0),n>=o&&n<=s||(ji(),!1)}catch(t){return $i(e.Critical,"Unexpected error in isWithinBusinessHours",t),!1}}function Pn(e){const t=e.toLowerCase();return t in supportedLanguages?{languageName:supportedLanguages[t],description:`Supported language found: ${supportedLanguages[t]}`}:{languageName:"English",description:"Default to English as no supported/identified language was found"}}Vi.runtime=Pi,Vi.typeName="support.LiveChannel",Vi.fields=Pi.util.newFieldList((()=>[{no:1,name:"channel",kind:"enum",T:Pi.getEnumType(ki)},{no:2,name:"primary_option",kind:"message",T:Zi},{no:3,name:"alternative_options",kind:"message",T:Zi,repeated:!0},{no:4,name:"escalation_option",kind:"message",T:Zi}])),function(t){const i=new Set(["zoom_chat_requested_start_time","zoom_chat_session_end_time","zoom_chat_initial_display_time"]);function n(e){const t=localStorage.getItem(e);if(null===t)return i.has(e)||r(`No state found in local storage for key: ${e}`),null;try{return JSON.parse(t)}catch(t){return r(`Failed to parse JSON for localStorage key: ${e}`,t),null}}function a(e){localStorage.removeItem(e)}function o(e,t){localStorage.setItem(e,JSON.stringify(t))}function s(e,t,i){try{const a=n(e);a&&i in a&&(a[i]=t,o(e,a))}catch(t){r(`Error updating local storage for key ${e}`,t)}}function r(t,i){$i(e.NonCritical,t,i)}t.getStateFromLocalStorage=n,t.deleteUnifiedChatStateFromLocalStorage=a,t.saveStateToLocalStorage=o,t.updateStateInLocalStorage=s,t.handleLocalStorageError=r}(Bi||(Bi={})),function(e){e[e.UNKNOWN_PRODUCT=0]="UNKNOWN_PRODUCT",e[e.DROPBOX=1]="DROPBOX",e[e.DASH=2]="DASH",e[e.DOCSEND=3]="DOCSEND",e[e.FORMSWIFT=4]="FORMSWIFT",e[e.REPLAY=5]="REPLAY"}(Mi||(Mi={})),Pi.util.setEnumType(Mi,"support.Product",[{no:0,name:"UNKNOWN_PRODUCT"},{no:1,name:"DROPBOX"},{no:2,name:"DASH"},{no:3,name:"DOCSEND"},{no:4,name:"FORMSWIFT"},{no:5,name:"REPLAY"}]),function(e){e.getBrowserStatus="FETCH_BROWSER_STATUS",e.deleteAttachedIframe="DELETE_ATTACHED_IFRAME",e.reloadPageAfterChatEnds="RELOAD_PAGE_AFTER_CHAT_ENDS",e.getDocsendCurrentUserInfo="FETCH_DOCSEND_CURRENT_USER_INFO",e.getDropboxCurrentUserInfo="FETCH_DROPBOX_CURRENT_USER_INFO",e.getBrowserLanguageInfo="FETCH_BROWSER_LANGUAGE_INFO",e.getBrowserPathInfo="FETCH_BROWSER_PATH_INFO",e.getIsProactiveFeatureStatus="FETCH_IS_PROACTIVE_FEATURE_STATUS",e.getDiscoverabilityConfig="FETCH_DISCOVERABILITY_CONFIG",e.getChatTypeInfo="FETCH_CHAT_TYPE_INFO",e.getUserSelectedProductSupportPackageInfo="FETCH_USER_SELECTED_PRODUCT_SUPPORT_PACKAGE_INFO",e.endChatButtonClicked="END_CHAT_BUTTON_CLICKED",e.proactiveEndChatButtonClicked="PROACTIVE_END_CHAT_BUTTON_CLICKED",e.proactiveEndChatButtonDisappeared="PROACTIVE_END_CHAT_BUTTON_DISAPPEARED",e.proactiveEndChatButtonAppeared="PROACTIVE_END_CHAT_BUTTON_APPEARED",e.fetchZoomChatCredentials="FETCH_ZOOM_CHAT_CREDENTIALS",e.addScriptTagSuccess="ADD_SCRIPT_TAG_SUCCESS",e.addScriptTagError="ADD_SCRIPT_TAG_ERROR",e.expandButtonClicked="EXPAND_BUTTON_CLICKED",e.minimizeButtonClicked="MINIMIZE_BUTTON_CLICKED",e.chatWidgetLoaded="CHAT_WIDGET_LOADED_INSIDE_IFRAME",e.chatWidgetNotLoaded="CHAT_WIDGET_NOT_LOADED_INSIDE_IFRAME",e.startNewChatButtonClicked="START_NEW_CHAT_BUTTON_CLICKED",e.setCookieForDBXSalesChat="SET_COOKIE_FOR_DBX_SALES_CHAT",e.getCxChatRequestedLanguageInfo="GET_CX_CHAT_REQUESTED_LANGUAGE_INFO",e.getIsChattingStatus="GET_STATUS_OF_IS_CHATTING_MODE",e.ResponseForIsChattingStatus="RES_TO_GET_STATUS_OF_IS_CHATTING",e.userAuthInfoLoaded="USER_AUTH_INFO_LOADED",e.initiatedChatFromTransfer="INITIATED_CHAT_FROM_TRANSFER",e.zoomCampaignSdkReady="ZOOM_CAMPAIGN_SDK_READY",e.ResponseForEngagementId="RESPONSE_TO_GET_ENGAGEMENT_ID",e.requestStorageAccess="REQUEST_STORAGE_ACCESS",e.storageAccessResponse="STORAGE_ACCESS_RESPONSE"}(Wi||(Wi={})),function(e){e.RequestToGetIsChattingStatus="REQ_TO_GET_STATUS_OF_IS_CHATTING",e.sendBrowserStatus="SEND_BROWSER_STATUS",e.sendIsProactiveFeatureStatus="SEND_PROACTIVE_FEATURE_STATUS",e.sendDocsendCurrentUserInfo="SEND_DOCSEND_CURRENT_USER_INFO",e.sendDropboxCurrentUserInfo="SEND_DROPBOX_CURRENT_USER_INFO",e.sendCurrentChatTypeInfo="SEND_CURRENT_CHAT_TYPE_INFO",e.sendUserSelectedProductSupportPackageInfo="SEND_USER_SELECTED_PRODUCT_SUPPORT_PACKAGE_INFO",e.sendBrowserPathInfo="SEND_DBX_BROWSER_CURRENT_PATH_INFO",e.sendDiscoverabilityConfig="SEND_DISCOVERABILITY_CONFIG",e.sendBrowserCurrentLanguageInfo="SEND_BROWSER_CURRENT_LANGUAGE_INFO",e.sendZoomChatCredentials="SEND_ZOOM_CHAT_CREDENTIALS",e.isChatWidgetLoadedInsideIframe="IS_CHAT_WIDGET_LOADED_INSIDE_IFRAME",e.performLogoutCallback="ZOOM_CHAT_LOGOUT_CALLBACK",e.setZoomChatWidgetToOpenWindow="SET_CHAT_WINDOW_TO_OPEN_MODE",e.callbackWhenUserSwitchesCompany="USER_PERRFOMS_SWITCH_COMMPANY_ONGOING_CHAT_SESSION",e.sendCxChatRequestedLanguageInfo="SEND_CX_CHAT_REQUESTED_LANGUAGE_INFO",e.RequestEngagementId="REQUEST_TO_GET_ENGAGEMENT_ID",e.RequestStorageAccess="REQUEST_STORAGE_ACCESS_FROM_IFRAME"}(xi||(xi={}));const Un=()=>{fn("onInitComplete: zoom_chat_client module Initialization : [SUCCESSFUL]")};function Hn(e){let t;return t=e===s.WWW_DBX_HOST?l.WWW_DBX_ENTITLEMENTS:e===s.SIGN_CENTER_HOST?l.SIGN_CENTER_ENTITLEMENTS:e===s.HELP_CENTER_HOST?l.HELP_CENTER_ENTITLEMENTS:e===s.EXPERIENCE_HOST?l.EXPERIENCE_ENTITLEMENTS:e===s.DASH_DBX_HOST?l.DASH_DBX_ENTITLEMENTS:l.UNSUPPORTED_ENTITLEMENTS,t}function Ln(e,t){let i;if(e===l.WWW_DBX_ENTITLEMENTS)i={wwwDbxEntitlements:t[e]};else if(e===l.HELP_CENTER_ENTITLEMENTS)i={helpCenterEntitlements:t[e]};else if(e===l.EXPERIENCE_ENTITLEMENTS)i={experienceEntitlements:t[e]};else if(e===l.SIGN_CENTER_ENTITLEMENTS)i={signCenterEntitlements:t[e]};else{if(e!==l.DASH_DBX_ENTITLEMENTS){const e=undefined;throw new Error("Invalid entitlements key")}i={dashDbxEntitlements:t[e]}}return i}function kn(e,t){t&&(e.cxChatButtonLanguage=t)}function Fn(e,t,i){fn(`logUnifiedChatStatus: [PRE-CHECKS] Unified chat cookie Key: ${t}`),fn(`logUnifiedChatStatus: [PRE-CHECKS]  Unified chat cookie availability: ${e}`),fn(`logUnifiedChatStatus: [PRE-CHECKS] Domain message: ${i}`)}function Bn(){return window.location.href}function Mn(e){const t=window;t.dbxCxChatButtonLanguage||(t.dbxCxChatButtonLanguage={}),kn(t.dbxCxChatButtonLanguage,e)}async function Wn(){const e=getOrInitZoomChatClient();if(e&&"function"==typeof e.initZoomChatReloadProcess){const t=undefined;return!!await e.initZoomChatReloadProcess()}return!1}const xn=async e=>{if(e){let t;switch(e){case Language.UNKNOWN_LANGUAGE||Language.ENGLISH:t="en-US";break;case Language.SPANISH:t="es-ES";break;case Language.FRENCH:t="fr-FR";break;case Language.GERMAN:t="de-DE";break;case Language.JAPANESE:t="ja-JP";break;case Language.PORTUGUESE:t="pt-PT";break;default:t="UNKNOWN"}const i=await Zn(ChatType.DBX_CX_CHAT);return i&&Mn(t),i}return!1},Xn=async(e=DEFAULT_MAX_SECONDS_TO_WAIT_FOR_EXPAND_CHAT)=>new Promise((t=>{const i=getOrInitZoomChatClient();if(!i)return void t(!1);let n=!1;const a=setTimeout((()=>{n||(n=!0,t(!1))}),e*SECONDS_TO_MS_MULTIPLIER);i.onAction&&i.onAction(ZoomChatIframeServiceAction.expandButtonClicked,(()=>{n||(n=!0,clearTimeout(a),t(!0))}))})),Gn=async()=>{await Zn(ChatType.DBX_SALES_CHAT)},Zn=async e=>{const t=undefined;if(!document.getElementById(UNIFIED_CHAT_IFRAME_ID)||document.cookie.includes(UNIFIED_CHAT_COOKIE_NAME))return zoomChatManagerExceptionHandler(ErrorSeverity.Critical,ZoomChatIframeEmbedderErrorMessages.ERROR_IFRAME_NOT_FOUND_OR_COOKIE_SET),!1;const i=undefined;if(!await Wn())return zoomChatManagerExceptionHandler(ErrorSeverity.Critical,ZoomChatIframeEmbedderErrorMessages.ERROR_ZOOM_CHAT_RELOAD_FAILED),!1;const n=JSON.parse(localStorage.getItem(UNIFIED_CHAT_LOCAL_STORAGE_KEY)||"{}");return e===ChatType.DBX_SALES_CHAT?ZoomChatLocalStorageManager.saveStateToLocalStorage(DBX_SALES_CHAT_ON_CHECKOUT_FLAG,!0):e===ChatType.DBX_CX_CHAT&&(n.reload=!0,ZoomChatLocalStorageManager.saveStateToLocalStorage(UNIFIED_CHAT_LOCAL_STORAGE_KEY,n)),!0};function Vn(){const e=un();e&&"function"==typeof e.handleOpenChatWindowCallback?e.handleOpenChatWindowCallback():$i(et.type,et.message)}const $n=e=>{e.style.display=""};function zn(){const e=undefined,t=(new Date).getDay();return 0===t||6===t}function Kn(){if(document.cookie.includes(UNIFIED_CHAT_COOKIE_NAME)){pn();const e=document.getElementById(UNIFIED_CHAT_IFRAME_ID);e&&(e.style.display="none")}}function Jn(){try{const e=getOrInitZoomChatClient();e&&"function"==typeof e.consentNotGrantedDidNotLoadChatClient&&e.consentNotGrantedDidNotLoadChatClient()}catch(e){zoomChatManagerExceptionHandler(ERROR_ZOOM_CHAT_CONSENT_DECLINED.type,ERROR_ZOOM_CHAT_CONSENT_DECLINED.message,e)}}function jn(){try{const e=un();if(!e||"function"!=typeof e.consentGrantedProceedDBXSalesChatToLoad)return void $i(Qe.type,Qe.message);e.consentGrantedProceedDBXSalesChatToLoad()}catch(e){$i($e.type,$e.message,e)}}function qn(){const e=undefined;return gn(P)===m}function Yn(e,t,i){t&&(e.selectedProductSupportPackage=t),e.forceEnglishForDashChat=i}function Qn(e,t=!1){const i=window;i.dbxSelectedProductSupportPackage||(i.dbxSelectedProductSupportPackage={}),Yn(i.dbxSelectedProductSupportPackage,e,t)}const ea=async(e,t=!1)=>{let i;if(i="",e&&(e.product===Product.DASH?i="PREMIUM_SUPPORT_DASH_CHAT":e.product===Product.DROPBOX&&(i="PREMIUM_SUPPORT_CX_CHAT")),!i)return!1;const n=await Zn(ChatType.DBX_CX_CHAT);return n&&Qn(i,t),n};function ta(){return"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}const ia=()=>getUnifiedChatCookieValue().length>0;function na(){return`${window.screen.height}px`}function aa(){return`${window.screen.width}px`}function oa(){return navigator.platform}var sa,ra,la;!function(e){e.UNI_NAV="UNI_NAV",e.ZOOM_CHAT="ZOOM_CHAT",e.INTEGRATION_TEST="INTEGRATION_TEST"}(sa||(sa={})),function(e){e.BOOTSTRAP="BOOTSTRAP"}(ra||(ra={})),function(e){e.EMBEDDER_READY="EMBEDDER_READY",e.CLIENT_MESSAGE="CLIENT_MESSAGE"}(la||(la={}));var da=function(){function e(e,t,i,n){var a=this,o;this.port=new Promise((function(e,t){o=e}));var s=new URL(i),r=new URLSearchParams(s.search);if(e===sa.ZOOM_CHAT){var l="".concat(location.origin).concat(location.pathname);r.append("origin",l)}else r.append("origin",location.origin);n&&r.append("locale",n),s.search=String(r),this.iframe=Object.assign(document.createElement("iframe"),{src:String(s),style:"border:none;background-color:transparent;",width:"100%",height:"1",frameBorder:"0",allowTransparency:"true",name:e});var d=function(i){if(i.origin===s.origin&&i.source===a.iframe.contentWindow&&i.data.key===ra.BOOTSTRAP){if(i.data.namespace!==e)return;removeEventListener("message",d);var n=i.ports[0];n.onmessage=function(e){e.data.key===la.CLIENT_MESSAGE&&t(e.data.clientData)},n.postMessage({key:la.EMBEDDER_READY}),o(n)}};addEventListener("message",d)}return e.prototype.sendMessage=function(e){var t={key:la.CLIENT_MESSAGE,clientData:e};this.port.then((function(e){e.postMessage(t)}))},e}(),ca=function(){function e(e,t){var i=new MessageChannel,n=new URLSearchParams(location.search).get("origin")||"";if(e===sa.ZOOM_CHAT){if(!/^https?:\/\/[a-zA-Z0-9.-]+(:\d+)?(\/[^\s]*)?$/.test(n))throw new Error("Invalid parent origin")}else if(!/^https?:\/\/[a-zA-Z0-9.-]+(:[0-9]+)?$/.test(n))throw new Error("Invalid parent origin");var a=i.port1,o;if(this.port=new Promise((function(e,t){o=e})),a.onmessage=function(e){e.data.key===la.EMBEDDER_READY?o(a):e.data.key===la.CLIENT_MESSAGE&&t(e.data.clientData)},n.length){var s={key:ra.BOOTSTRAP,namespace:e};window.parent.postMessage(s,n,[i.port2])}}return e.prototype.sendMessage=function(e){var t={key:la.CLIENT_MESSAGE,clientData:e};this.port.then((function(e){e.postMessage(t)}))},e}(),ua,ha,fa;!function(e){e.REQUEST="REQUEST",e.RESPONSE="RESPONSE"}(ua||(ua={})),function(e){e.REQUEST="REQUEST",e.RESPONSE="RESPONSE"}(ha||(ha={})),function(e){e.success="SUCCESS",e.failure="FAILED"}(fa||(fa={}));const Ca={action:xi.performLogoutCallback,message:Oe.LOGOUT_CALLBACK,messagetype:ua.REQUEST},ga=Wi.setCookieForDBXSalesChat,Ea=Ae.SET_COOKIE_FOR_DBX_SALES_CHAT,Sa=ha.REQUEST,ma=Wi.fetchZoomChatCredentials,Ta=Ae.FETCH_ZOOM_CHAT_CREDENTIALS,_a=ha.REQUEST,pa={action:xi.isChatWidgetLoadedInsideIframe,message:Oe.CHECK_CHAT_WIDGET_STATUS,messagetype:ua.REQUEST},Ia={action:xi.setZoomChatWidgetToOpenWindow,message:Oe.SET_ZOOM_CHAT_WIDGET_TO_OPEN_WINDOW,messagetype:ua.REQUEST},va=Wi.deleteAttachedIframe,Aa=Ae.DELETE_ATTACHED_IFRAME_ON_END_CHAT_BUTTON_CLICK,Oa=ha.REQUEST,Na=Wi.getDocsendCurrentUserInfo,ba=Ae.FETCH_DOCSEND_CURRENT_USER_INFO,Da=ha.REQUEST,ya=Wi.getDropboxCurrentUserInfo,Ra=Ae.FETCH_DROPBOX_CURRENT_USER_INFO,wa=ha.REQUEST,Pa=Wi.getBrowserLanguageInfo,Ua=Ae.FETCH_BROWSER_LANGUAGE_INFO,Ha=ha.REQUEST,La=Wi.getBrowserPathInfo,ka=Ae.FETCH_BROWSER_PATH_INFO,Fa=ha.REQUEST,Ba=Wi.getIsProactiveFeatureStatus,Ma=Ae.FETCH_BROWSER_PATH_INFO,Wa=ha.REQUEST,xa=Wi.getDiscoverabilityConfig,Xa=Ae.FETCH_DISCOVERABILITY_CONFIG,Ga=ha.REQUEST,Za=Wi.getCxChatRequestedLanguageInfo,Va=Ae.FETCH_CX_CHAT_REQUESTED_LANGUAGE_INFO,$a=ha.REQUEST,za=Wi.getUserSelectedProductSupportPackageInfo,Ka=Ae.FETCH_USER_SELECTED_PRODUCT_SUPPORT_PACKAGE_INFO,Ja=ha.REQUEST,ja=Wi.getChatTypeInfo,qa=Ae.FETCH_CHAT_TYPE_INFO,Ya=ha.REQUEST,Qa=Wi.endChatButtonClicked,eo=Ae.END_CHAT_BUTTON_CLICKED,to=ha.REQUEST,io=Wi.proactiveEndChatButtonClicked,no=Ae.PROACTIVE_END_CHAT_BUTTON_CLICKED,ao=ha.REQUEST,oo=Wi.proactiveEndChatButtonDisappeared,so=Ae.PROACTIVE_END_CHAT_BUTTON_CLICKED,ro=ha.REQUEST,lo=Wi.proactiveEndChatButtonAppeared,co=Ae.PROACTIVE_END_CHAT_BUTTON_CLICKED,uo=ha.REQUEST,ho=Wi.getBrowserStatus,fo=Ae.GET_BROWSER_STATUS,Co=ha.REQUEST,go=Wi.addScriptTagSuccess,Eo=Ae.SCRIPT_TAG_SUCCESS,So=ha.RESPONSE,mo=Wi.addScriptTagError,To=Ae.SCRIPT_TAG_ERROR,_o=ha.RESPONSE,po={action:Wi.expandButtonClicked,message:Ae.EXPAND_BUTTON_CLICKED,messagetype:ha.RESPONSE},Io={action:Wi.minimizeButtonClicked,message:Ae.MINIMIZE_BUTTON_CLICKED,messagetype:ha.RESPONSE},vo=Wi.chatWidgetLoaded,Ao=Ae.CHAT_WIDGET_LOADED,Oo=ha.RESPONSE,No=Wi.chatWidgetLoaded,bo=fa.success,Do=Ae.CHAT_WIDGET_LOADED,yo=ha.RESPONSE,Ro=a.ChatBubble,wo=Wi.chatWidgetLoaded,Po=fa.success,Uo=Ae.CHAT_WIDGET_LOADED,Ho=ha.RESPONSE,Lo=a.ChatWindow,ko=Wi.chatWidgetNotLoaded,Fo=Ae.CHAT_WIDGET_NOT_LOADED,Bo=fa.failure,Mo=ha.RESPONSE,Wo=Wi.startNewChatButtonClicked,xo=Ae.START_NEW_CHAT_BUTTON_CLICKED,Xo=fa.success,Go=ha.REQUEST,Zo=Wi.userAuthInfoLoaded,Vo=Wi.initiatedChatFromTransfer,$o=Wi.zoomCampaignSdkReady,zo={action:xi.RequestEngagementId,message:Oe.REQUEST_ENGAGEMENT_ID,messagetype:ua.REQUEST},Ko={currentEndToChatState:i.DoNotTerminateChatSession},Jo={currentIframeState:n.Hiddden,currentUserActionState:t.ChatIsNotRequested,currentWidgetState:a.ChatBubble,currentCompanyState:o.UserNotSwtichCompany},jo={currentIframeState:n.Visible,currentUserActionState:t.ChatIsNotRequested,currentWidgetState:a.ChatWindow,currentCompanyState:o.UserNotSwtichCompany},qo={currentIframeState:n.Visible,currentUserActionState:t.ChatIsRequested,currentWidgetState:a.ChatWindow,currentCompanyState:o.UserNotSwtichCompany},Yo={currentIframeState:n.Visible,currentUserActionState:t.ChatIsRequested,currentWidgetState:a.ChatBubble,currentCompanyState:o.UserNotSwtichCompany},Qo="undefined"!=typeof self&&self?self:window;function es(e){const t=undefined;(Qo._DBX_UXA_bufferedClosures=Qo._DBX_UXA_bufferedClosures||[]).push(e),is()}function ts(){Qo._DBX_UXA_isUxaListening=!0,is()}function is(){if(!Qo._DBX_UXA_isUxaListening)return;const e=Qo._DBX_UXA_bufferedClosures=Qo._DBX_UXA_bufferedClosures||[],t=[...e];e.length=0;for(const e of t)e()}function ns(){Qo._DBX_UXA_isUxaListening=void 0,Qo._DBX_UXA_bufferedClosures=void 0;try{delete Qo._DBX_UXA_isUxaListening,delete Qo._DBX_UXA_bufferedClosures}catch(e){}}function as(e,t={detail:null}){if("function"==typeof CustomEvent)return new CustomEvent(e,t);const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,!0,!0,t.detail),i}function os(e,t){window.dispatchEvent(as(e,t))}const ss=(e,t)=>{es((()=>{os("zoom_chat_custom_event",{detail:{eventType:e,extra:t}})}))};function rs(e,t,i){i.chatType!==r.DOCSEND_CHAT&&ss(e,{chat_type:i.chatType,chat_interaction_type:i.chatInteractionType,event_details:t,surface_screen_height:i.surfaceScreenHeight,surface_screen_width:i.surfaceScreenWidth,external_tag:i.externalTag||"",platform:i.platform,time_until_zoom_chat_interaction:i.timeUntilchatInteraction,total_zoom_chat_duration:i.totalChatDurationInSec,engagement_id:i.engagementId||"",sales_exp_variant:i.salesExperimentVariant||"",custom_proactive_chat_exp_variant:i.customProactiveChatExpVariant,consent_cookie_status:String(i.consentCookieStatus)})}function ls(e){rs(c.INITIALIZED,"Chat initiation has started",e)}function ds(e){rs(c.SUCCESS,"Chat initiation successful",e)}function cs(e){rs(c.FAILED,"Chat initiation failed",e)}function us(e){rs(c.NETWORK_FAILED,"Chat initiation failed due to network issue",e)}function hs(e){rs(c.TIMEOUT_FAILED,"Chat initiation failed due to timeout",e)}function fs(e){rs(c.EXPAND,"User clicked on the chat bubble",e)}function Cs(e){rs(c.MINIMIZE,"User clicked on the chat minimize button",e)}function gs(e){rs(c.END,"The chat engagement was ended",e)}function Es(e){rs(c.CHATREQUESTED,"User requested a chat",e)}function Ss(e){rs(c.DISPLAYED,"Zoom chat displayed to ther user",e)}function ms(e){rs(c.LOGOUT,"Chat ended by user logout",e)}function Ts(e){rs(c.CONSENTDECLINED,"User declined coockie consent, did not load zoom chat",e)}function _s(e){rs(c.SALESCHAT_DISALLOWED_COUNTRY,"Sales chat is not allowed in the requested country",e)}function ps(e){rs(c.SALES_EXPERIMENT_PRESENTED,"Sales chat experiment was presented to the user",e)}function Is(e){rs(c.START_NEW_CHAT_BUTTON_CLICKED,"Start a new chat button clicked by the user",e)}function vs(e){let t;switch(e.customProactiveChatExpVariant){case"V1":t="Zoom Sales Proactive chat not shown (Variant: V1)";break;case"V2":t="Zoom Sales Proactive chat shown as bubble (Variant: V2)";break;case"CONTROL":case"OFF":t=`Zoom Sales Proactive chat shown as proactive window (Variant: ${e.customProactiveChatExpVariant})`;break;default:t=`Zoom Sales Proactive chat variant unknown (Variant: ${e.customProactiveChatExpVariant})`}rs(c.ZOOM_SALES_CHAT_PROACTIVE_EXPERIMENT,t,e)}function As(e){rs(c.CHAT_STATE_MISMATCH,"Chat cookie exists but localStorage did not update state",e)}function Os(e){rs(c.COOKIE_CLEARED,"Zoom chat cookie cleared successfully",e)}function Ns(e){rs(c.LOCAL_STORAGE_CLEARED,"Zoom chat local storage cleared successfully",e)}function bs(e){return null!==gn(e)}function Ds(e){return null!==gn(e)}function ys(t,i){var n;const a=undefined,o=document.cookie.split("; ").find((e=>e.startsWith(`${t}=`)));if(!o)return!1;try{const e=decodeURIComponent(o.split("=")[1]),t=JSON.parse(e);if(!t.hasOwnProperty("categories")||"object"!=typeof t.categories)return!1;if(!t.categories.hasOwnProperty(i))return!1;const a=undefined;return Boolean(null===(n=null==t?void 0:t.categories)||void 0===n?void 0:n[i])}catch(i){return $i(e.Critical,`Error parsing cookie ${t}`,i),!1}}function Rs(){const e=undefined;return bs(S)}const ws="chatProvider",Ps="decagonMode",Us=()=>window;class Hs{constructor(){this.setState=e=>{this.state={...this.state,...e},Object.entries(e).forEach((([e,t])=>{this.listeners[e].forEach((e=>e()))}))},this.getIframe=()=>this.getStateField("iframe"),this.getUserIdentifiers=()=>this.getStateField("userIdentifiers"),this.getStateField=e=>new Promise((t=>{const i=this.state[e];if(i)return void t(i);const n=()=>{this.state[e]&&(t(this.state[e]),this.listeners[e].delete(n))};this.listeners[e].add(n)})),this.addChatProviderToUrl=e=>{var t;const i=null!==(t=this.chatProvider)&&void 0!==t?t:"zoom",n=new URL(e);return n.searchParams.set(ws,i),this.chatProvider=void 0,this.decagonMode&&"decagon"===i&&n.searchParams.set(Ps,this.decagonMode),n.toString()},this.state={},this.listeners={iframe:new Set,userIdentifiers:new Set}}}Hs.getInstance=()=>{const e=Us();return e.chatEnvironment||(e.chatEnvironment=new Hs),e.chatEnvironment};class Ls{constructor(e){this.args=e,this.el=null,this.isChatIframeReady=!1,this.initTimeout=null,this.chatStartInitTime=null,this.chatEndInitTime=null,this.chatElapsedTime=null,this.externalActionCallbacks={},this.seenActions=new Set,this.handleIframeServiceMessages=async e=>{e.action===Wi.getDocsendCurrentUserInfo?this.sendDocsendCurrentUserInfoToIframeService():e.action===Wi.ResponseForIsChattingStatus||(e.action===Wi.getDropboxCurrentUserInfo?this.sendDropboxCurrentUserInfoToIframeService():e.action===Wi.getBrowserPathInfo?this.sendDropboxCurrentPathInfoToIframeService():e.action===Wi.getIsProactiveFeatureStatus?this.sendIsProactiveFeatureStatusToIframeService():e.action===Wi.getDiscoverabilityConfig?this.sendDiscoverabilityConfigToIframeService():e.action===Wi.getChatTypeInfo?this.sendCurrentChatTypeInfoToIframeService():e.action===Wi.addScriptTagSuccess?this.attachScriptTagSuccessToFrame():e.action===Wi.addScriptTagError?this.attachScriptTagErrorToFrame(e):e.action===Wi.fetchZoomChatCredentials?this.executeAttachZoomChatScriptTagToIframe():e.action===Wi.startNewChatButtonClicked?this.restoreChatStateWhenStartNewChatBtnClicked():e.action===Wi.expandButtonClicked||e.action===Wi.minimizeButtonClicked||e.action===Wi.proactiveEndChatButtonClicked||e.action===Wi.proactiveEndChatButtonAppeared?this.handleChatWidgetInteraction(e):e.action===Wi.chatWidgetLoaded||e.action===Wi.chatWidgetNotLoaded?await this.validateChatWidgetLoadStatus(e):e.action===Wi.endChatButtonClicked?this.performCleanUpAsUserEndsTheChat():e.action===Wi.deleteAttachedIframe?this.detachZoomChatIframe():e.action===Wi.getBrowserStatus?this.sendBrowserStatusToIframeService():e.action===Wi.setCookieForDBXSalesChat?this.setCookieForDBXSalesChat():e.action===Wi.getCxChatRequestedLanguageInfo?this.sendDropboxCxChatRequestedInfoToIframeService():e.action===Wi.getUserSelectedProductSupportPackageInfo?this.sendButtonSelectedProductSupportPackageInfoToIframeService():e.action===Wi.initiatedChatFromTransfer?this.handleInitiatedChatFromTransfer():e.action===Wi.ResponseForEngagementId?this.handleEngagementIdResponse(e):"IFRAME_SERVICE_READY"===e.action&&this.sendCrossDomainPersistenceEnabledToIframe());const t=e.action,i=this.externalActionCallbacks[t];i&&(i(),delete this.externalActionCallbacks[t]),this.seenActions.add(t)};const t=Hs.getInstance();this.iframeEmbedder=new da(sa.ZOOM_CHAT,this.handleIframeServiceMessages,t.addChatProviderToUrl(e.iframeSrc),void 0),t.setState({iframe:this.iframeEmbedder.iframe}),this.isMobileOrTablet=this.detectMobileOrTablet(),this.registerZoomChatClientReloadCallback(),this.registerLogoutCallback(),this.registerOnActionCallback(),this.registerSwitchCompanyCallback(),this.registerOpenChatWindowCallback(),this.registerInitZoomChatClientReloadCallback(),this.registerAllowDBXSalesChatToLoadCallback(),this.registerZoomChatConsentDeclinedCallback(),this.registerIsChattingFromSDK()}registerIsChattingFromSDK(){const e=undefined;if(this.getInitializedChatTypeFromProfile()===r.DBX_SALES_CHAT){const e=undefined;un().showIsChattingStatus=()=>this.retrieveIsChattingFromIframe()}}registerZoomChatClientReloadCallback(){const t=undefined;un().reloadZoomChatClient=async()=>{try{this.seenActions.clear();const t=await this.reInitializeZoomChatClient();if(t)fn("registerZoomChatClientReloadCallback: Re-initialization complete.");else{const i=`registerZoomChatClientReloadCallback: Returned Re-initialization status ${t}`;$i(e.Critical,i)}return t}catch(t){return $i(e.Critical,"reInitializeZoomChatClient is failed",t),!1}}}registerInitZoomChatClientReloadCallback(){const t=undefined;un().initZoomChatReloadProcess=async()=>{try{return this.seenActions.clear(),await this.startZoomChatIframeReloadProcess(),!0}catch(t){return $i(e.Critical,"Error during Zoom chat reload process.",t),!1}}}static getInstance(e){return Ls.instance||(Ls.instance=new Ls(e)),Ls.instance}updateArgs(e){this.args={...this.args,...e}}clearInitializationTimeout(){try{if(!this.initTimeout)return void fn("clearInitializationTimeout: No active timeout to clear.");clearTimeout(this.initTimeout),this.initTimeout=null,fn("clearInitializationTimeout: Successfully cleared the initialization timeout.")}catch(t){$i(e.Critical,be.ERROR_CLEARING_TIMEOUT,t)}}static setChatUri(e){Ls.chatUri=e}static setChatApiKey(e){Ls.chatApiKey=e}static setChatDataEnv(e){Ls.chatDataEnv=e}static getChatUri(){return Ls.chatUri}static getChatApiKey(){return Ls.chatApiKey}static getChatDataEnv(){return Ls.chatDataEnv}deleteUnifiedChatCookie(e,t){fn(`deleteUnifiedChatCookie: Removing the Unified Chat Cookie : ${e} `);let i=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;t&&(i+=` domain=${t};`),i+="SameSite=None;Secure",document.cookie=i,this.handleZoomUXAEvent(c.COOKIE_CLEARED)}detectMobileOrTablet(){return window.matchMedia("(max-width: 1024px)").matches}getDelayBetweenChatDisplayAndFirstInteraction(){const e=Bi.getStateFromLocalStorage(N),t=Bi.getStateFromLocalStorage(O);if(!e||!t)return 0;const i=new Date(e),n=new Date(t);return isNaN(i.getTime())||isNaN(n.getTime())?0:(n.getTime()-i.getTime())/1e3}calculateTotalChatDuration(){const e=Bi.getStateFromLocalStorage(O),t=Bi.getStateFromLocalStorage(b);if(!e||!t)return 0;const i=new Date(e),n=new Date(t);return isNaN(i.getTime())||isNaN(n.getTime())?0:(n.getTime()-i.getTime())/1e3}updateChatInteractionType(e){this.args.chatInitProfile&&(this.args.chatInitProfile.chatInteractionType=e)}handleZoomUXAEvent(t){var i,n,a,o,s;fn(`handleZoomUXAEvent: ${t} and  ${null===(i=this.args.chatInitProfile)||void 0===i?void 0:i.engagementId}`),(null===(n=this.args.chatInitProfile)||void 0===n?void 0:n.engagementId)||(fn("handleZoomUXAEvent: Engagement ID is empty, requesting engagement id on demand"),this.requestEngagementIdOnDemand());const r={chatType:this.getInitializedChatTypeFromProfile(),chatInteractionType:this.getChatInteractionTypeFromProfile(),surfaceScreenHeight:na(),surfaceScreenWidth:aa(),platform:oa(),timeUntilchatInteraction:String(this.getDelayBetweenChatDisplayAndFirstInteraction()),totalChatDurationInSec:String(this.calculateTotalChatDuration()),engagementId:null===(a=this.args.chatInitProfile)||void 0===a?void 0:a.engagementId,salesExperimentVariant:this.getDbxUserSalesFeatureVariant(),customProactiveChatExpVariant:(null===(s=null===(o=this.args.chatSpecificConfigs)||void 0===o?void 0:o.dbxChatConfigs)||void 0===s?void 0:s.customProactiveChatExpVariant)||fe,consentCookieStatus:ys(T,_)||!1};switch(t){case c.INITIALIZED:ls(r);break;case c.SUCCESS:ds(r);break;case c.FAILED:cs(r);break;case c.NETWORK_FAILED:us(r);break;case c.TIMEOUT_FAILED:hs(r);break;case c.EXPAND:fs(r);break;case c.MINIMIZE:Cs(r);break;case c.END:gs(r);break;case c.CHATREQUESTED:Es(r);break;case c.DISPLAYED:Ss(r);break;case c.LOGOUT:ms(r);break;case c.CONSENTDECLINED:Ts(r);break;case c.SALESCHAT_DISALLOWED_COUNTRY:_s(r);break;case c.SALES_EXPERIMENT_PRESENTED:ps(r);break;case c.START_NEW_CHAT_BUTTON_CLICKED:Is(r);break;case c.CHAT_STATE_MISMATCH:As(r);break;case c.COOKIE_CLEARED:Os(r);break;case c.LOCAL_STORAGE_CLEARED:Ns(r);break;default:const i=`Unknown Zoom chat UXA event encountered: ${t}`;$i(e.Critical,i)}}isValidSalesChatAppState(){const e=Bi.getStateFromLocalStorage(A);if(fn(`isValidSalesChatAppState: dbxUnifiedChatState : ${e}`),!e||"object"!=typeof e)return fn("isValidSalesChatAppState: No state found in local storage for key: dbx_unified_chat_state"),!1;const t=e.hasOwnProperty("currentIframeState")&&e.hasOwnProperty("currentUserActionState")&&e.hasOwnProperty("currentWidgetState")&&e.hasOwnProperty("currentCompanyState");fn(`isValidSalesChatAppState: hasRequiredProperties : ${t}`);const i=e.hasOwnProperty("pageHistory")||e.hasOwnProperty("reload");return fn(`isValidSalesChatAppState: hasInvalidProperties : ${i}`),fn(`isValidSalesChatAppState: Returning : ${t&&!i}`),t&&!i}cleanUpUnifiedChatState(){const e=this.getInitializedChatTypeFromProfile();if(B.includes(e)){if(e===r.DBX_SALES_CHAT&&!this.isValidSalesChatAppState())return void fn(`cleanUpUnifiedChatState : Skip cleanup for the the :: ${e}`);localStorage.removeItem(A)}}scheduleChatAndIframeToVisible(e,t){this.proceedToDisplayChat(e,t),this.setChatIframeVisibilityAndState()}setIframeVisibilityState(){fn("setIframeVisibilityState: Updating local storage for iframe visibility"),Bi.updateStateInLocalStorage(A,n.Visible,"currentIframeState")}setUserRequestedChatState(e){fn(`setUserRequestedChatState: First-time Initialization Detected: ${e}: Setting CHAT IS REQUESTED`),Bi.updateStateInLocalStorage(A,t.ChatIsRequested,"currentUserActionState")}setChatWidgetWindowState(){this.isUserMinimized()?fn("setChatWidgetWindowState: Suppressed opening window due to derived minimized state"):Bi.updateStateInLocalStorage(A,a.ChatWindow,"currentWidgetState")}setChatWidgetBubbleState(){Bi.updateStateInLocalStorage(A,a.ChatBubble,"currentWidgetState")}logProactiveStartupTimer(e){const t=undefined;fn(`logProactiveStartupTimer: Setting Proactive timer to ${0===e?"disabled (0 seconds)":`${e} seconds`}`)}setChatIframeVisibilityAndState(){this.setUnifiedChatIframeToVisible(this.iframeEmbedder.iframe),this.setIframeVisibilityState(),this.detectChatStateMismatch()}proceedToLoadChatAsProActive(e,t){var i,n,a;const o=null===(a=null===(n=null===(i=this.args)||void 0===i?void 0:i.chatSpecificConfigs)||void 0===n?void 0:n.dbxChatConfigs)||void 0===a?void 0:a.customProactiveChatExpVariant,s=this.calculateRemainingStartupTime();0===s||e===r.DBX_SALES_CHAT&&"V2"===o?(this.logProactiveStartupTimer(0),this.scheduleChatAndIframeToVisible(e,t)):(this.logProactiveStartupTimer(s),setTimeout((()=>{this.scheduleChatAndIframeToVisible(e,t),fn(`proceedToLoadChatAsProActive: Scheduled proactive execution finished after (${s} seconds).`)}),1e3*s))}calculateRemainingStartupTime(){var e,t;let i=(null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.identifiedChatStartUpTime)||0;const n=parseFloat(((null!==(t=this.chatElapsedTime)&&void 0!==t?t:0)/1e3).toFixed(2));return i=parseFloat((i-n).toFixed(2)),i}handleZoomChatInitialDisplay(){const e=new Date;fn(`chat first displayed time ${e}`),Bi.saveStateToLocalStorage(N,e),this.handleZoomUXAEvent(c.DISPLAYED),this.handleZoomUXAEvent(c.SALES_EXPERIMENT_PRESENTED)}setChatWidgetToWindowMode(e,t){fn(`setChatWidgetToWindowMode: First-time Initialization Detected: ${e} : Setting ChatWidget to window Mode`),this.iframeEmbedder.sendMessage(Ia),t.action=Wi.expandButtonClicked}proceedToDisplayChat(e,t){var i,n,o,l,d,u,h,f,C,g,E,S,m,T,_;if(this.isUserMinimized())return fn("proceedToDisplayChat: Suppressing auto-open due to persisted userMinimized flag"),this.applyMinimizedIframeStyle(),void this.setChatWidgetBubbleState();const p=Bi.getStateFromLocalStorage(A),I=null==p?void 0:p.currentWidgetState,v=undefined,O=null!==(o=bn(null!==(n=null===(i=this.args.chatInitProfile)||void 0===i?void 0:i.identifiedHref)&&void 0!==n?n:""))&&void 0!==o?o:"",N=e===r.DBX_SALES_CHAT,b=I===a.ChatBubble||I===a.ChatWindow;if(N&&b){let i=!1,n=!1,a=[],o=fe;const r=null===(l=this.args.chatInitProfile)||void 0===l?void 0:l.trustedHost;if(r===s.DASH_DBX_HOST){const e=null!==(f=null===(h=null===(u=null===(d=this.args)||void 0===d?void 0:d.chatSpecificConfigs)||void 0===u?void 0:u.dbxDashChatConfigs)||void 0===h?void 0:h.proActiveMessagingConfig)&&void 0!==f?f:ge;a=e.proActiveMessagingPages,i=e.isEnabled,n=a.includes(O)}else{const e=null!==(S=null===(E=null===(g=null===(C=this.args)||void 0===C?void 0:C.chatSpecificConfigs)||void 0===g?void 0:g.dbxChatConfigs)||void 0===E?void 0:E.proActiveMessagingConfig)&&void 0!==S?S:ge;i=e.isEnabled,a=e.proActiveMessagingPages,n=a.includes(O),o=(null===(_=null===(T=null===(m=this.args)||void 0===m?void 0:m.chatSpecificConfigs)||void 0===T?void 0:T.dbxChatConfigs)||void 0===_?void 0:_.customProactiveChatExpVariant)||fe}return i&&n?void fn(`proceedToDisplayChat: isDbxZoomProactiveFeatureEnabled=${i}, pages=${JSON.stringify(a)}, pageMatches=${n}, variant=${o}`):"V2"===o?void fn(`proceedToDisplayChat : Starting = ${e} show chat bubble as the customProactiveChatExpVariant is ${o}`):this.isMobileOrTablet&&this.enabledMobileSpecificExperience()?void fn(`proceedToDisplayChat: Mobile device detected and enabledMobileSpecificExperience is true: Starting ${e} as bubble`):r===s.DASH_DBX_HOST?void fn("proceedToDisplayChat: exit from window state in dash pages to bubble state"):(fn(`proceedToDisplayChat: Starting ${e} with DBX Custom ProactiveMsgFeature (variant ${o})`),this.setChatWidgetToWindowMode(e,t),this.applyMaximizedIframeStyle(),void this.handleZoomChatInitialDisplay())}M.includes(e)&&(fn(`proceedToDisplayChat : Starting non-DBX Chat = ${e}`),En(e),this.setUserRequestedChatState(e),this.handleZoomUXAEvent(c.CHATREQUESTED))}enabledMobileSpecificExperience(){var e,t,i,n,a,o,r,l,d,c,u,h,f,C,g,E,S,m,T,_,p,I;const v=null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.trustedHost,A=null!==(i=null===(t=this.args.chatInitProfile)||void 0===t?void 0:t.identifiedHref)&&void 0!==i?i:"";if(v===s.DASH_DBX_HOST){const e=null!==(d=null===(l=null===(r=null===(o=null===(a=null===(n=this.args)||void 0===n?void 0:n.chatSpecificConfigs)||void 0===a?void 0:a.dbxDashChatConfigs)||void 0===o?void 0:o.dashMobileExperienceConfig)||void 0===r?void 0:r.dash)||void 0===l?void 0:l.showChatBubble)&&void 0!==d&&d;return fn(`enabledMobileSpecificExperience: Dash DBX host detected, and showChatBubble: ${e}`),e}if(v===s.WWW_DBX_HOST){const e=null!==(g=null===(C=null===(f=null===(h=null===(u=null===(c=this.args)||void 0===c?void 0:c.chatSpecificConfigs)||void 0===u?void 0:u.dbxChatConfigs)||void 0===h?void 0:h.dashMobileExperienceConfig)||void 0===f?void 0:f.dbx)||void 0===C?void 0:C.showChatBubble)&&void 0!==g&&g,t=null!==(I=null===(p=null===(_=null===(T=null===(m=null===(S=null===(E=this.args)||void 0===E?void 0:E.chatSpecificConfigs)||void 0===S?void 0:S.dbxChatConfigs)||void 0===m?void 0:m.dashMobileExperienceConfig)||void 0===T?void 0:T.dbx)||void 0===_?void 0:_.entryPages)||void 0===p?void 0:p.some((e=>A&&A.includes(e))))&&void 0!==I&&I;return fn(`enabledMobileSpecificExperience: DBX host detected, showChatBubble: ${e} and pageAllowed: ${t}`),e&&t}return!1}getIdentifiedHost(){var e,t;const i=undefined;return null!==(t=null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.identifiedHost)&&void 0!==t?t:null}getInitializedChatTypeFromProfile(){var e,t;const i=undefined;return null!==(t=null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.identifiedChat)&&void 0!==t?t:r.UNSUPPORTED_CHAT}getChatInteractionTypeFromProfile(){var e,t;const i=undefined;return null!==(t=null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.chatInteractionType)&&void 0!==t?t:d.UNSUPPORTED_CHAT}createChatTypeInfo(){return{identifiedChat:this.getInitializedChatTypeFromProfile()}}getIdentifiedPathFromProfile(){var e,t;const i=null!==(t=null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.identifiedHref)&&void 0!==t?t:"";return{identifiedPath:bn(i),identifiedQueryParams:JSON.stringify(Dn(i))}}sendCurrentChatTypeInfoToIframeService(){const e=this.createChatTypeInfo(),t={action:xi.sendCurrentChatTypeInfo,messageType:ua.REQUEST,dbxCurrentChatTypeInfo:JSON.stringify(e),message:Oe.SEND_CURRENT_CHAT_TYPE_INFO};this.iframeEmbedder.sendMessage(t)}sendDropboxCurrentPathInfoToIframeService(){const e=this.getIdentifiedPathFromProfile(),t={action:xi.sendBrowserPathInfo,messageType:ua.REQUEST,dbxCurrentPathInfo:JSON.stringify(e),message:Oe.SEND_BROWSER_PATH_INFO};this.iframeEmbedder.sendMessage(t)}sendIsProactiveFeatureStatusToIframeService(){var e,t,i,n,a,o,l,d,c,u,h;const f=undefined;if(this.getInitializedChatTypeFromProfile()!==r.DBX_SALES_CHAT)return;let C=!1;const g=null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.trustedHost;if(g===s.WWW_DBX_HOST)C=null!==(o=null===(a=null===(n=null===(i=null===(t=this.args)||void 0===t?void 0:t.chatSpecificConfigs)||void 0===i?void 0:i.dbxChatConfigs)||void 0===n?void 0:n.proActiveMessagingConfig)||void 0===a?void 0:a.isEnabled)&&void 0!==o&&o;else{if(g!==s.DASH_DBX_HOST)return;C=null!==(h=null===(u=null===(c=null===(d=null===(l=this.args)||void 0===l?void 0:l.chatSpecificConfigs)||void 0===d?void 0:d.dbxDashChatConfigs)||void 0===c?void 0:c.proActiveMessagingConfig)||void 0===u?void 0:u.isEnabled)&&void 0!==h&&h}const E={isProactiveFeatureEnabled:C},S={action:xi.sendIsProactiveFeatureStatus,message:Oe.SEND_PROACTIVE_FEATURE_STATUS,dbxProactiveFeatureInfo:JSON.stringify(E),messageType:ua.RESPONSE};this.iframeEmbedder.sendMessage(S)}sendDiscoverabilityConfigToIframeService(){var e,t;const i=undefined;if(this.getInitializedChatTypeFromProfile()!==r.DBX_CX_CHAT)return;const n=null===(t=null===(e=this.args.chatSpecificConfigs)||void 0===e?void 0:e.dbxChatConfigs)||void 0===t?void 0:t.discoverabilityEntryPagesConfig,a={action:xi.sendDiscoverabilityConfig,message:Oe.SEND_DISCOVERABILITY_CONFIG,dbxDiscoverabilityConfig:JSON.stringify(null!=n?n:null),messageType:ua.RESPONSE};this.iframeEmbedder.sendMessage(a)}isIdentifiedHostSupportedToLoadChat(){var t,i,n,a,o;const s=null===(t=this.args)||void 0===t?void 0:t.chatInitProfile,r=this.getIdentifiedHost();let l=!1;if(null!==r&&(null==s?void 0:s.supportedEntitlements))if(null===(i=s.supportedEntitlements.wwwDbxEntitlements)||void 0===i?void 0:i.includes(r))l=!0;else if(null===(n=s.supportedEntitlements.docsendEntitlements)||void 0===n?void 0:n.includes(r))l=!0;else if(null===(a=s.supportedEntitlements.signCenterEntitlements)||void 0===a?void 0:a.includes(r))l=!0;else if(null===(o=s.supportedEntitlements.dashDbxEntitlements)||void 0===o?void 0:o.includes(r))l=!0;else{const t=`Identified Host '${r}' is not supported in any entitlements.`;$i(e.Critical,t)}else $i(e.Critical,be.IDENTIFIED_HOST_OR_SUPPORTED_ENTITLEMENTS_NULL);return l}handleIframeExecutionError(t){$i(e.Critical,be.IFRAME_EXECUTION_ERROR,t)}handleIframeContentWindowError(){$i(e.Critical,be.IFRAME_CONTENT_WINDOW_NULL_ERROR)}handleIframeNotFoundError(){$i(e.Critical,be.IFRAME_NOT_FOUND_ERROR)}attachScriptTagSuccessToFrame(){this.setIframeReadyStatus(!0),this.iframeEmbedder.sendMessage(pa)}attachScriptTagErrorToFrame(t){$i(e.Critical,be.SCRIPT_TAG_ATTACHMENT_ERROR,t)}handleIframeInitializationError(t){$i(e.Critical,be.CHAT_CLIENT_SETUP_INITIALIZATION_ERROR,t),this.handleZoomUXAEvent(c.FAILED)}setupInitializationTimeout(){this.initTimeout&&clearTimeout(this.initTimeout),this.chatStartInitTime=performance.now(),fn("setupInitializationTimeout: Setting up timeout for 120 secs to load entire process."),this.initTimeout=setTimeout((()=>{$i(e.Critical,be.CHAT_IFRAME_LOAD_TIMEOUT_ERROR),this.handleZoomUXAEvent(c.NETWORK_FAILED),$i(e.Critical,"setupInitializationTimeout: zoom_chat_client module Initialization :  [FAILED]")}),12e4)}handleNoCookieOnChatWidgetInit(e){this.cleanUpUnifiedChatState(),this.isIdentifiedHostSupportedToLoadChat()&&(this.setUnifiedChatInitialState(),this.setUnifiedChatIframeToInVisible(e),this.applyMinimizedIframeStyle())}isInitialDbxSalesChatWhenCookieExists(e,t,i,n){return fn(`isInitialDbxSalesChatWhenCookieExists: invoked with initChatType=${t} with assuredState : ${JSON.stringify(i)}}`),null===e&&t===r.DBX_SALES_CHAT?(fn(`No current state found. Initializing with assuredState: ${JSON.stringify(i)}`),Bi.saveStateToLocalStorage(A,i),fn(`isInitialDbxSalesChatWhenCookieExists: Triggering handleChatWidgetInteraction with message: ${JSON.stringify(n)}`),this.handleChatWidgetInteraction(n),fn("isInitialDbxSalesChatWhenCookieExists: completed with return=true"),!0):(fn("isInitialDbxSalesChatWhenCookieExists: conditions not met, return=false"),!1)}isChatWidgetHiddenWithoutCompanySwitch(e,t){return e===n.Hiddden&&t===o.UserNotSwtichCompany}isChatWidgetHiddenWithCompanySwitch(e,t){return e===n.Hiddden&&t===o.UserSwtichCompany}isChatWindowVisibleWithRequestedState(e,i,s,r){return e===n.Visible&&i===t.ChatIsRequested&&s===a.ChatWindow&&r===o.UserNotSwtichCompany}isChatBubbleVisibleWithRequestedState(e,i,s,r){return e===n.Visible&&i===t.ChatIsRequested&&s===a.ChatBubble&&r===o.UserNotSwtichCompany}handleCookieOnChatWidgetInit(e){const t=Bi.getStateFromLocalStorage(A),i=this.getInitializedChatTypeFromProfile();if(!t)return;const{currentIframeState:n,currentCompanyState:a,currentUserActionState:o,currentWidgetState:s}=t;this.isChatWidgetHiddenWithoutCompanySwitch(n,a)?this.handleWhenChatWidgetIsInHiddenState(t,e):this.isChatWindowVisibleWithRequestedState(n,o,s,a)?this.handleWhenChatWidgetIsInWindowAndVisibleState(e):this.isChatBubbleVisibleWithRequestedState(n,o,s,a)?this.handleWhenChatWidgetIsInBubbleAndVisibleState():this.isChatWidgetHiddenWithCompanySwitch(n,a)&&this.handleCompanySwitch(e,i)}handleCompanySwitch(e,t){t===r.DOCSEND_CHAT&&this.handleCaseWhenUserSwitchesCompany(e)}handleCaseWhenUserSwitchesCompany(e){this.setUnifiedChatIframeToInVisible(e),setTimeout((()=>{this.setUnifiedChatIframeToInVisible(e),this.iframeEmbedder.sendMessage(Ca),this.deleteUnifiedChatCookie(S)}),5e3)}handleWhenChatWidgetIsInHiddenState(e,i){e.currentUserActionState===t.ChatIsNotRequested&&(this.setUnifiedChatIframeToInVisible(i),this.saveUnifiedChatState(Jo))}handleWhenChatWidgetIsInBubbleAndVisibleState(){this.applyMinimizedIframeStyle(),this.saveUnifiedChatState(Yo)}getCookieValue(e){const t=e+"=",i=document.cookie.split(";");for(const e of i){const i=e.trim();if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null}handleWhenChatWidgetIsInWindowAndVisibleState(e){this.applyMaximizedIframeStyle(),this.setUnifiedChatIframeToVisible(e),this.saveUnifiedChatState(qo)}handleStateWithPageHistory(){fn("handleStateWithPageHistory: [STARTED]");const e=Bi.getStateFromLocalStorage(A);if(fn(`handleStateWithPageHistory: Retrieved current state: ${JSON.stringify(e)}`),!e){const e={...Jo,pageHistory:{previousPage:null,currentPage:window.location.pathname},reload:!1};return fn(`handleStateWithPageHistory: No current state found. Initializing with state: ${JSON.stringify(e)}`),Bi.saveStateToLocalStorage(A,e),void fn("handleStateWithPageHistory: [COMPLETED]")}const t=window.location.pathname;fn(`handleStateWithPageHistory: Real-time current path: ${t}`);const i=e.pageHistory.previousPage,n=e.pageHistory.currentPage,a=undefined;fn(`storedPreviousPage: ${i}, storedCurrentPage: ${n}, storedReloadFlag: ${e.reload}`);let o=!1;null===i&&n?n===t||t.startsWith(n)?(fn("handleStateWithPageHistory: Stored current value and real-time current value are the same. Setting reload to false."),o=!1,e.pageHistory={previousPage:n,currentPage:t}):(fn("handleStateWithPageHistory: Stored currentPage value and real-time currentPage value are different."),fn("handleStateWithPageHistory: Updating previousPage to currentPage and currentPage to realTimeCurrentPath."),o=!0,e.pageHistory={previousPage:n,currentPage:t}):i&&n&&(fn("handleStateWithPageHistory: Both previousPage and currentPage are set. Comparing values."),n===t||t.startsWith(n)?(fn("handleStateWithPageHistory: Real-time current path matches stored currentPage. Setting reload to false."),o=!1):(fn("handleStateWithPageHistory: Real-time current path does not match. Updating page history."),o=!0,e.pageHistory={previousPage:n,currentPage:t})),e.reload=o,Bi.saveStateToLocalStorage(A,e),fn(`handleStateWithPageHistory: Final updated state with reload flag: ${JSON.stringify(e)}`),fn("handleStateWithPageHistory: [COMPLETED]")}async startZoomChatIframeReloadProcess(){fn("startZoomChatIframeReloadProcess: [STARTED], Starting chat termination process."),fn("startZoomChatIframeReloadProcess: Sending message to iframe for ending the current chat session."),this.iframeEmbedder.sendMessage(Ca),await this.waitForSessionTermination(),fn("startZoomChatIframeReloadProcess: Timeout reached. Executing reload callback to refresh chat state.");const e=await this.triggerReloadZoomChatClient();return fn("startZoomChatIframeReloadProcess: [COMPLETED]"),e}async waitForSessionTermination(){fn("waitForSessionTermination: Waiting for session termination..."),await new Promise((e=>setTimeout(e,C)))}async triggerReloadZoomChatClient(){fn("triggerReloadZoomChatClient: Starting reload callback execution.");const e=un();if(!e||"function"!=typeof e.reloadZoomChatClient)return $i(tt.type,tt.message),!1;fn("triggerReloadZoomChatClient: Valid Zoom Chat client detected. Initiating reload.");try{return await e.reloadZoomChatClient(),fn("triggerReloadZoomChatClient: Reload callback executed successfully."),!0}catch(e){const t=undefined;return fn(`triggerReloadZoomChatClient: Reload failed: ${e instanceof Error?e.message:String(e)}`),!1}}removeUnifiedChatDivContainer(){const e=document.querySelector(".dbx-unified-chat-container");e?e.remove():fn("removeUnifiedChatDivContainer: No .dbx-unified-chat-container found. No action taken.")}resetInitialization(){fn("resetInitialization : [STARTED] - Closing and resetting port..."),this.el=null,this.isChatIframeReady=!1,this.initTimeout=null,this.chatStartInitTime=null,this.chatEndInitTime=null,this.chatElapsedTime=null,fn("resetInitialization : [COMPLETED]")}attachMessageListener(){try{window.addEventListener("message",this.handleIframeServiceMessages,{passive:!0})}catch(t){$i(e.Critical,be.ERROR_ATTACHING_MESSAGE_EVENT_LISTENER,t)}}async reInitChatClient(t){fn("reInitChatClient: [STARTED] Preparing configs to reinitialize the chat client.");try{const e=Ls.getInstance(t);return Ls.setChatUri(t.chatUri),Ls.setChatApiKey(t.chatApiKey),Ls.setChatDataEnv(t.chatDataEnv),fn("reInitChatClient: [COMPLETED] Preparing configs to reinitialize the chat client."),fn("reInitChatClient: *** CALLING initChatClient *** ......."),await e.initChatClient(),Un(),fn("reInitChatClient: [COMPLETED] Chat client initialized successfully."),!0}catch(t){return $i(e.Critical,"reInitChatClient failed",t),!1}}async reInitializeZoomChatClient(){fn("reInitializeZoomChatClient: Triggered re-init");try{this.removeUnifiedChatDivContainer(),this.resetInitialization(),fn(`Arguments for re-initialization: ${JSON.stringify(this.args)}`),this.iframeEmbedder=new da(sa.ZOOM_CHAT,this.handleIframeServiceMessages,this.args.iframeSrc,void 0);const e=undefined;if(!await this.reInitChatClient(this.args))throw new Error("Chat client initialization failed.");return!0}catch(t){return $i(e.Critical,"re-initialization failed",t),!1}}isChatToBeReactiveOnSalesPage(e){var t,i,n;const a=null===(t=this.args.chatInitProfile)||void 0===t?void 0:t.trustedHost,o=undefined,l=bn(null!==(n=null===(i=this.args.chatInitProfile)||void 0===i?void 0:i.identifiedHref)&&void 0!==n?n:"");return e===r.DBX_SALES_CHAT&&a===s.WWW_DBX_HOST&&Z.some((e=>l.startsWith(e)))}skipZoomChatReload(e,t){fn("skipZoomChatReload: [START]");const i=Bi.getStateFromLocalStorage(y),n=this.isChatToBeReactiveOnSalesPage(e),a=this.shouldForceDisableChatProactiveOnVariantV1(e);if(fn(`skipZoomChatReload: isButtonClickedOnSalesPage=${i}, chatToBeReactiveOnSalesPage=${n}, forceDisableOnVariantV1=${a}`),n){if(a&&!i)return void fn("skipZoomChatReload: V1 variant + button not clicked  Forcing load chat in background");if(i)return fn("skipZoomChatReload: Button clicked (any variant)  show reactive chat"),void this.handleDbxSalesPageReactiveChat(r.DBX_SALES_CHAT,t)}this.proceedToLoadChatAsProActive(e,t),fn("skipZoomChatReload: Proactive chat scheduled.")}setUnifiedChatInitialState(){const e=this.getInitializedChatTypeFromProfile();W.includes(e)?this.handleStateWithPageHistory():Bi.saveStateToLocalStorage(A,Jo)}setUnifiedChatIframeToInVisible(e){e.style.display="none"}setUnifiedChatIframeToVisible(e){e.style.display=""}registerOpenChatWindowCallback(){const e=undefined;un().handleOpenChatWindowCallback=()=>{fn("registerOpenChatWindowCallback: First-time Initialization: Setting ChatWidget to window Mode"),Bi.updateStateInLocalStorage(A,t.ChatIsRequested,"currentUserActionState"),Bi.updateStateInLocalStorage(A,a.ChatWindow,"currentWidgetState"),this.iframeEmbedder.sendMessage(Ia),this.handleZoomUXAEvent(c.CHATREQUESTED)}}registerZoomChatConsentDeclinedCallback(){const e=undefined;un().consentNotGrantedDidNotLoadChatClient=()=>{fn("registerZoomChatConsentDeclinedCallback: User declined the cookie consent, Callback is triggered, not initializing zoom_chat_client"),this.handleZoomUXAEvent(c.CONSENTDECLINED)}}registerAllowDBXSalesChatToLoadCallback(){const e=this.getUnifiedChatCookieStatus(),t=e.currentInitChat;if(!W.includes(t))return;if(e.unifiedChatCookieStatus)return;const i=undefined;un().consentGrantedProceedDBXSalesChatToLoad=()=>{this.handleDBXSalesChatConsent(t)}}handleDBXSalesChatConsent(e){this.deregisterAllowDBXSalesChatToLoadCallback(),fn(`handleDBXSalesChatConsent: ${e} is loading now, initializing chat client.`),this.initChatClient().then(Un)}deregisterAllowDBXSalesChatToLoadCallback(){const e=un();e&&"function"==typeof e.consentGrantedProceedDBXSalesChatToLoad?(fn("deregisterAllowDBXSalesChatToLoadCallback: Callback consentGrantedProceedDBXSalesChatToLoad deregistered successfully."),e.consentGrantedProceedDBXSalesChatToLoad=void 0):fn("deregisterAllowDBXSalesChatToLoadCallback: Callback consentGrantedProceedDBXSalesChatToLoad was not registered or already deregistered.")}saveUnifiedChatState(e){Bi.saveStateToLocalStorage(A,e)}isUnifiedChatCookieExists(e){const t=document.cookie.split(";");for(let i=0;i<t.length;i++){const n=undefined;if(e==t[i].split("=")[0].trim())return!0}return!1}setChatSessionLogoutFlag(){const e=undefined;this.getUnifiedChatCookieStatus().currentInitChat===r.DBX_SALES_CHAT&&localStorage.setItem(D,"true")}removeChatRequestedFlagOnCheckoutPage(){localStorage.removeItem(y)}removeChatSessionLogoutFlag(){localStorage.removeItem(D)}registerLogoutCallback(){const e=undefined;un().handleOnLogoutCallback=()=>{this.handleLogout()}}registerOnActionCallback(){const e=undefined;un().onAction=(e,t,i)=>{(null==i?void 0:i.includePreviousActions)&&this.seenActions.has(e)?t():this.externalActionCallbacks[e]=t}}handleLogout(){const e=this.isIOSSafariOrWebView();Bi.deleteUnifiedChatStateFromLocalStorage(R),this.logEventWhenLocalStorageCleared(A),e||this.performLogoutActions(A)}performLogoutActions(e){Bi.deleteUnifiedChatStateFromLocalStorage(e),this.logEventWhenLocalStorageCleared(A),this.setChatSessionLogoutFlag(),this.iframeEmbedder.sendMessage(Ca),this.handleZoomUXAEvent(c.LOGOUT)}registerSwitchCompanyCallback(){const e=undefined;un().handleOnSwitchCompanyCallback=()=>{this.iframeEmbedder.sendMessage(Ca),setTimeout((()=>{this.detachZoomChatIframe()}),1e3)}}isIOSSafariOrWebView(){const e=navigator.userAgent,t=/^((?!chrome|android).)*safari/i.test(e),i=/AppleWebKit/.test(e)&&!/Safari/.test(e);return fn(`isIOSSafariOrWebView: isSafari: ${t}, isWebView : ${i}`),t||i}resetChatSessionForIOS(){const e=undefined;if(this.getInitializedChatTypeFromProfile()===r.DOCSEND_CHAT){const e=Bi.getStateFromLocalStorage(R);null===e&&(Bi.saveStateToLocalStorage(R,Ko),setTimeout((()=>{this.iframeEmbedder.sendMessage(Ca)}),3e3)),e&&e.currentEndToChatState===i.DoNotTerminateChatSession&&Bi.saveStateToLocalStorage(R,Ko)}}clearChatTimeMetricsFromLocalStorage(){Bi.deleteUnifiedChatStateFromLocalStorage(b),Bi.deleteUnifiedChatStateFromLocalStorage(N),Bi.deleteUnifiedChatStateFromLocalStorage(O)}logCurrentTimeToLocalStorage(e){const t=this.getCurrentTimeAsString();Bi.saveStateToLocalStorage(e,t)}performCleanUpAsUserEndsTheChat(){const e=this.getInitializedChatTypeFromProfile();this.logCurrentTimeToLocalStorage(b),this.handleZoomUXAEvent(c.END),e===r.DBX_SALES_CHAT||e===r.DBX_CX_CHAT?(this.deleteUnifiedChatCookie(S,k),Bi.deleteUnifiedChatStateFromLocalStorage(A),this.logEventWhenLocalStorageCleared(A),this.clearChatTimeMetricsFromLocalStorage()):e===r.DOCSEND_CHAT&&(this.deleteUnifiedChatCookie(S),Bi.deleteUnifiedChatStateFromLocalStorage(A),this.logEventWhenLocalStorageCleared(A),setTimeout((()=>{this.detachZoomChatIframe(),window.location.reload()}),1e3)),this.args.chatInitProfile&&(this.args.chatInitProfile.engagementId="")}getCurrentTimeAsString(){const e=undefined;return(new Date).toISOString()}getDocsendUserInfoFromWindow(){var e,t,i,n,a,o,s,r,l,d,c,u,h,f,C,g,E,S,m,T,_;const p=undefined;return{id:null===(e=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===e?void 0:e.id,name:null===(t=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===t?void 0:t.name,email:null===(i=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===i?void 0:i.email,teamRole:null===(o=null===(a=null===(n=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===n?void 0:n.statsigUser)||void 0===a?void 0:a.custom)||void 0===o?void 0:o.teamRole,createdAt:null===(l=null===(r=null===(s=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===s?void 0:s.statsigUser)||void 0===r?void 0:r.custom)||void 0===l?void 0:l.createdAt,userAgent:null===(c=null===(d=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===d?void 0:d.statsigUser)||void 0===c?void 0:c.userAgent,docSendPlan:null===(f=null===(h=null===(u=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===u?void 0:u.statsigUser)||void 0===h?void 0:h.custom)||void 0===f?void 0:f.docsendPlan,industry:null===(E=null===(g=null===(C=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===C?void 0:C.statsigUser)||void 0===g?void 0:g.custom)||void 0===E?void 0:E.docsendIndustry,companyName:null===(m=null===(S=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===S?void 0:S.company)||void 0===m?void 0:m.name,companyId:null===(_=null===(T=null===window||void 0===window?void 0:window.dsCurrentUserInfoRaw)||void 0===T?void 0:T.company)||void 0===_?void 0:_.id}}getDbxUserInfoFromWindow(){var e,t,i;const n=null!==(i=null===(t=null===(e=this.args.chatSpecificConfigs)||void 0===e?void 0:e.dbxChatConfigs)||void 0===t?void 0:t.dbxUserIdentifiers)&&void 0!==i?i:{};return{id:n.id,name:n.name,email:n.email,plan:n.plan,dashPlan:n.dashPlan,supportTier:n.supportTier,language:n.language,country:n.country,pageLoadTs:n.pageLoadTs,chatHmac:n.chatHmac,sessionId:n.sessionId,hasDashPremiumSupport:n.hasDashPremiumSupport,decagonHmac:n.decagonHmac,decagonHmacExpiresAt:n.decagonHmacExpiresAt}}getCxChatRequestedButtonInfoFromWindow(){const e={dbxCxChatButtonLanguage:"",cxChatButtonLanguage:""},t=window;return t.dbxCxChatButtonLanguage&&t.dbxCxChatButtonLanguage.cxChatButtonLanguage&&(e.dbxCxChatButtonLanguage=t.dbxCxChatButtonLanguage.cxChatButtonLanguage),e}getproductSupportPackageInfoFromWindow(){const e={selectedProductSupportPackage:"",forceEnglishForDashChat:!1},t=window;return t.dbxSelectedProductSupportPackage&&(t.dbxSelectedProductSupportPackage.selectedProductSupportPackage&&(e.selectedProductSupportPackage=t.dbxSelectedProductSupportPackage.selectedProductSupportPackage),void 0!==t.dbxSelectedProductSupportPackage.forceEnglishForDashChat&&(e.forceEnglishForDashChat=t.dbxSelectedProductSupportPackage.forceEnglishForDashChat)),e}getDbxUserLoggedInStatus(){var e,t,i;return null!==(i=null===(t=null===(e=this.args.chatSpecificConfigs)||void 0===e?void 0:e.dbxChatConfigs)||void 0===t?void 0:t.isUserLoggedIn)&&void 0!==i&&i}getDbxUserSalesFeatureVariant(){var e,t,i,n,a,o,l;const d=this.getInitializedChatTypeFromProfile(),c=null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.trustedHost,u=undefined;return d===r.DBX_SALES_CHAT&&c===s.SIGN_CENTER_HOST?null!==(n=null===(i=null===(t=this.args.chatSpecificConfigs)||void 0===t?void 0:t.dbxSignChatConfigs)||void 0===i?void 0:i.salesExperimentVariant)&&void 0!==n?n:"OFF":null!==(l=null===(o=null===(a=this.args.chatSpecificConfigs)||void 0===a?void 0:a.dbxChatConfigs)||void 0===o?void 0:o.salesExperimentVariant)&&void 0!==l?l:"OFF"}getCustomProactiveChatExpVariant(){var e,t;const i=undefined;return this.getInitializedChatTypeFromProfile()===r.DBX_SALES_CHAT&&(null===(t=null===(e=this.args.chatSpecificConfigs)||void 0===e?void 0:e.dbxChatConfigs)||void 0===t?void 0:t.customProactiveChatExpVariant)||fe}sendDocsendCurrentUserInfoToIframeService(){const e=this.getDocsendUserInfoFromWindow(),t={action:xi.sendDocsendCurrentUserInfo,messageType:ua.REQUEST,dsCurrentUserInfo:JSON.stringify(e),message:Oe.SEND_DOCSEND_CURRENT_USER_INFO};this.iframeEmbedder.sendMessage(t)}retrieveIsChattingFromIframe(){const e={action:xi.RequestToGetIsChattingStatus,messageType:ua.REQUEST,message:Oe.REQUEST_IS_CHATTING_MESSAGE};this.iframeEmbedder.sendMessage(e)}sendDropboxCurrentUserInfoToIframeService(){const e=this.getDbxUserInfoFromWindow(),t=this.getDbxUserLoggedInStatus(),i=this.getDbxUserSalesFeatureVariant(),n=this.getCustomProactiveChatExpVariant(),a={action:xi.sendDropboxCurrentUserInfo,messagetype:ua.REQUEST,dbxCurrentUserInfo:JSON.stringify(e),message:Oe.SEND_DROPBOX_CURRENT_USER_INFO,isUserLoggedIn:t,salesExperimentVariant:i,customProactiveChatExpVariant:n};this.iframeEmbedder.sendMessage(a)}sendDropboxCxChatRequestedInfoToIframeService(){const e=this.getCxChatRequestedButtonInfoFromWindow(),t={action:xi.sendCxChatRequestedLanguageInfo,messagetype:ua.REQUEST,cxUserSelectedLanguage:JSON.stringify(e),message:Oe.SEND_CX_CHAT_REQUESTED_LANGUAGE_INFO};this.iframeEmbedder.sendMessage(t)}sendButtonSelectedProductSupportPackageInfoToIframeService(){const e=this.getproductSupportPackageInfoFromWindow(),t={action:xi.sendUserSelectedProductSupportPackageInfo,messagetype:ua.REQUEST,productSupportPackage:JSON.stringify(e),message:Oe.SEND_USER_SELECTED_PRODUCT_SUPPORT_PACKAGE_INFO};this.iframeEmbedder.sendMessage(t)}sendBrowserStatusToIframeService(){const e={action:xi.sendBrowserStatus,message:Oe.SEND_BROWSER_STATUS,messageData:this.isIOSSafariOrWebView(),messageType:ua.RESPONSE};this.iframeEmbedder.sendMessage(e)}sendCrossDomainPersistenceEnabledToIframe(){fn("sendCrossDomainPersistenceEnabledToIframe: Enabling cross-domain persistence in iframe");const e={action:"SET_CROSS_DOMAIN_PERSISTENCE_FLAG",isEnabled:!0,messageType:ua.REQUEST};this.iframeEmbedder.sendMessage(e)}restoreChatStateWhenStartNewChatBtnClicked(){this.handleZoomUXAEvent(c.START_NEW_CHAT_BUTTON_CLICKED);const e={...jo,pageHistory:{previousPage:null,currentPage:window.location.pathname},reload:!1};fn(`restoreChatStateWhenStartNewChatBtnClicked: Restoring and Initializing the state: ${JSON.stringify(e)}`),Bi.saveStateToLocalStorage(A,e)}setCookieForDBXSalesChat(){const e=this.getInitializedChatTypeFromProfile();null==this.getCookieValue(S)&&e===r.DBX_SALES_CHAT&&(En(e),this.setUserRequestedChatState(e),this.logCurrentTimeToLocalStorage(O),this.handleZoomUXAEvent(c.CHATREQUESTED))}async validateChatWidgetLoadStatus(e){e.status===fa.success?await this.handleChatWidgetLoadSuccess(e):e.status===fa.failure&&this.handleChatWidgetLoadFailure(e)}async handleChatWidgetLoadSuccess(t){fn(`handleChatWidgetLoadSuccess: ${t.status}`),null!==this.initTimeout?(this.validateIOSChatEnvironment(),fn(`handleChatWidgetLoadSuccess: Received WidgetStatusUnderIframe: ${t.chatbotbuttonstate}`),this.computeChatWidgetLoadDuration(),this.handleZoomUXAEvent(c.SUCCESS),await this.processChatWidgetState(t)):$i(e.Operational,"handleChatWidgetLoadSuccess: Chat widget inside iframe is not fully ready yet.")}handleChatWidgetLoadFailure(t){this.computeChatWidgetLoadDuration(),this.clearInitializationTimeout(),this.detachZoomChatIframe(),$i(e.Critical,Ne.CHAT_WIDGET_NOT_LOADED_MAX_RETRY_REACHED)}computeChatWidgetLoadDuration(){this.chatEndInitTime=performance.now(),fn(`computeChatWidgetLoadDuration: The chat is initialized at : ${this.chatEndInitTime}`),null!==this.chatStartInitTime&&(this.chatElapsedTime=this.chatEndInitTime-this.chatStartInitTime,fn(`computeChatWidgetLoadDuration: Total time taken: ${(this.chatElapsedTime/1e3).toFixed(2)} seconds`))}validateIOSChatEnvironment(){this.isIOSSafariOrWebView()&&this.resetChatSessionForIOS()}async processChatWidgetState(e){const t=e.chatbotbuttonstate;fn(`processChatWidgetState: State of the chat widget inside the iframe : ${t}`),t===a.ChatBubble?this.onChatLoadedAsBubble(e):t===a.ChatWindow?await this.onChatLoadedAsWindow(e):fn(`processChatWidgetState: Unhandled chatWidgetState: ${t}`)}onChatLoadedAsBubble(e){fn("onChatLoadedAsBubble: clearInitializationTimeout + deregisterAllowDBXSalesChatToLoadCallback -> Handling over to handleChatBubbleStatus"),this.clearInitializationTimeout(),this.deregisterAllowDBXSalesChatToLoadCallback(),this.handleChatBubbleStatus(e)}async onChatLoadedAsWindow(e){fn("onChatLoadedAsWindow: clearInitializationTimeout + deregisterAllowDBXSalesChatToLoadCallback"),this.clearInitializationTimeout(),this.deregisterAllowDBXSalesChatToLoadCallback();const t=this.getUnifiedChatCookieStatus(),i=Bi.getStateFromLocalStorage(A);if(this.shouldHandleChatWindowForSalesChat(t.currentInitChat,t.unifiedChatCookieStatus)){fn(`onChatLoadedAsWindow: Handling chat window process for ${t.currentInitChat} with no unified chat cookie exists`);const i=Bi.getStateFromLocalStorage(A);if(!i)return void fn("onChatLoadedAsWindow: No chat state found in local storage, skipping reload.");const{reload:n,currentCompanyState:a}=i;await this.processZoomChatReload(n,a,e)}else if(this.handleChatWidgetInteraction(po),t.unifiedChatCookieStatus&&this.setChatIframeVisibilityAndState(),this.isInitialDbxSalesChatWhenCookieExists(i,t.currentInitChat,Yo,po))return}shouldHandleChatWindowForSalesChat(e,t){return W.includes(e)&&!t}async processZoomChatReload(t,i,n){const a=undefined,o=this.getUnifiedChatCookieStatus().currentInitChat;fn(`processZoomChatReload: Retrieved reload flag: ${t}, user switch account status: ${i}`);const s=undefined;if(await this.shouldReloadAndHandleAccountSwitch(t,i)){fn("processZoomChatReload: Starting reload process.");const t=undefined;return await this.startZoomChatIframeReloadProcess()?(fn("processZoomChatReload: Zoom chat reload process completed successfully."),!0):($i(e.Critical,"processZoomChatReload: Zoom chat reload process failed."),!1)}return fn("processZoomChatReload: Reload flag is false. Executing do not reload function."),this.proceedToLoadChatAsProActive(o,n),!1}getUnifiedChatCookieStatus(){const e=this.getInitializedChatTypeFromProfile();let t;return t=!!X.has(e)&&this.isUnifiedChatCookieExists(S),{currentInitChat:e,unifiedChatCookieStatus:t}}handleChatBubbleStatus(e){const t=this.getUnifiedChatCookieStatus(),{unifiedChatCookieStatus:i,currentInitChat:n}=t;fn(`handleChatBubbleStatus: Chat cookie status: ${i}, Current chat type: ${n}`),this.handleChatWidgetInteraction(Io),t.unifiedChatCookieStatus&&this.setChatIframeVisibilityAndState(),this.setupBaseChatHandler(n,e,i)}setupBaseChatHandler(e,t,i){var n;const a=null===(n=this.args.chatInitProfile)||void 0===n?void 0:n.trustedHost;if(fn(`setupBaseChatHandler: Current chat type: ${e}, Trusted host: ${a}, Unified chat cookie status: ${i}`),e===r.DOCSEND_CHAT&&a===s.DOCSEND_HOST)this.handleFirstTimeDoSendChat(t);else if(e!==r.DBX_SALES_CHAT||a!==s.DASH_DBX_HOST||i)if(e!==r.DBX_SALES_CHAT||a!==s.WWW_DBX_HOST||i)if(e!==r.DBX_SALES_CHAT||a!==s.SIGN_CENTER_HOST||i)if(e===r.DBX_CX_CHAT&&a===s.WWW_DBX_HOST)this.handleDbxCXChatFlow(e,t);else{if((a===s.HELP_CENTER_HOST||a===s.EXPERIENCE_HOST||a===s.DASH_DBX_HOST||a===s.SIGN_CENTER_HOST)&&e===r.DBX_SALES_CHAT&&i)return void this.handleWhenChatWidgetIsInBubbleAndVisibleState();if(a===s.WWW_DBX_HOST&&e===r.DBX_SALES_CHAT&&i){const t=Bi.getStateFromLocalStorage(A);if(this.isInitialDbxSalesChatWhenCookieExists(t,e,Yo,Io))return}}else this.handleFirstTimeSalesChatWhenBubble(e,t);else this.handleFirstTimeSalesChatWhenBubble(e,t);else this.handleFirstTimeSalesChatWhenBubble(e,t)}handleDbxCXChatFlow(t,i){var n,a,o;const s=null===(n=this.args.chatInitProfile)||void 0===n?void 0:n.identifiedHref,r=null===(o=null===(a=this.args.chatSpecificConfigs)||void 0===a?void 0:a.dbxChatConfigs)||void 0===o?void 0:o.discoverabilityEntryPagesConfig;if(!s)return;const l=bn(s);this.isPathInHelpEntryPages(l)?this.handleFirstTimeChatLoadOnGetHelpPage(t,i):r&&this.shouldHandleDiscoverabilityPageChat(l,r)?this.handleFirstTimeChatLoadOnDiscoverabilityPage(t,i):(null==r?void 0:r.isEnabled)||$i(e.Operational,`Chat visibility on discovery pages is disabled. Current path: ${l}`)}isPathInHelpEntryPages(e){return q.includes(e)}shouldHandleDiscoverabilityPageChat(e,t){var i,n;return t.isEnabled&&null!==(n=null===(i=t.discoverabilityEntryPages)||void 0===i?void 0:i.includes(e))&&void 0!==n&&n}handleFirstTimeDoSendChat(e){this.handleChatWidgetInteraction(e)}async handleFirstTimeSalesChatWhenBubble(e,t){var i;const n=undefined;if((null===(i=this.args.chatInitProfile)||void 0===i?void 0:i.trustedHost)===s.WWW_DBX_HOST){const e=undefined;if(!this.canInitiateSalesChatForUser())return void this.handleLoggingForSalesChatDisallowedCountry()}const a=Bi.getStateFromLocalStorage(A),o=Bi.getStateFromLocalStorage(D),r=undefined;if(this.getUnifiedChatCookieStatus().unifiedChatCookieStatus)return void fn("handleFirstTimeSalesChatWhenBubble: Unified chat Cookie found.");if(!a)return void fn("handleFirstTimeSalesChatWhenBubble: No current state found in localStorage.");o&&(fn(`handleFirstTimeSalesChatWhenBubble: ${o} found; initiating widget reload.`),this.removeChatSessionLogoutFlag(),await this.startZoomChatIframeReloadProcess());const{reload:l,currentCompanyState:d}=a;fn(`handleFirstTimeSalesChatWhenBubble: Retrieved reload flag: ${l}, user switch account status: ${d}`);const c=undefined;await this.shouldReloadAndHandleAccountSwitch(l,d)?(fn("handleFirstTimeSalesChatWhenBubble: Starting reload process."),await this.startZoomChatIframeReloadProcess()):(fn(`handleFirstTimeSalesChatWhenBubble: No reload needed, proceeding with current chat : ${e}`),this.skipZoomChatReload(e,t))}async shouldReloadAndHandleAccountSwitch(e,t){fn("Checking if reload or account switch is needed.");const i=e||t===o.UserSwtichCompany;return i?(fn("Reload is required."),t===o.UserSwtichCompany&&(fn("Detected account switch. Performing custom actions."),Bi.deleteUnifiedChatStateFromLocalStorage(A),this.logEventWhenLocalStorageCleared(A))):fn("No reload or account switch needed."),i}handleFirstTimeChatLoadOnGetHelpPage(e,t){fn(`handleFirstTimeChatLoadOnGetHelpPage: First-time Initialization Detected: ${e}`),this.proceedToLoadChatAsReactive(r.DBX_CX_CHAT,t)}handleDbxReactiveChatRequestHandler(e,t){this.handleChatWidgetInteraction(t);const i=e===r.DBX_SALES_CHAT?y:A;this.initiateChatWindowOnRequested(i,e)}initiateChatWindowOnRequested(e,t){const i=Bi.getStateFromLocalStorage(e);t===r.DBX_CX_CHAT&&!0===(null==i?void 0:i.reload)?(this.updateStateToChatWindowRequested(t),delete i.reload):t===r.DBX_SALES_CHAT&&!0===i&&(this.updateStateToChatWindowRequested(t),this.removeChatRequestedFlagOnCheckoutPage())}updateStateToChatWindowRequested(e){En(e),this.updateChatInteractionType(d.REACTIVE_CHAT),Vn(),Bi.saveStateToLocalStorage(A,qo),this.setUnifiedChatIframeToVisible(this.iframeEmbedder.iframe)}handleDbxSalesPageReactiveChat(e,t){this.handleDbxReactiveChatRequestHandler(e,t)}proceedToLoadChatAsReactive(e,t){this.handleDbxReactiveChatRequestHandler(e,t)}handleFirstTimeChatLoadOnDiscoverabilityPage(e,t){fn(`handleFirstTimeChatLoadOnDiscoverabilityPage: First-time Initialization Detected: ${e} on portkey-unifiedchat-discoverability pages`),this.proceedToLoadChatAsProActive(e,t)}updateIframeSizeForProactiveButtonAppear(){this.applyProActiveButtonExpandedIframeStyle()}updateIframeSizeForProactiveButtonClick(){this.applyMinimizedIframeStyle()}applyMinimizedIframeStyle(){const e=this.iframeEmbedder.iframe.style;e.width="100px",e.height="100px",e.right="0px",e.bottom="0px"}applyProActiveButtonExpandedIframeStyle(){const e=this.iframeEmbedder.iframe.style;e.width="350px",e.height="210px",e.right="0px",e.bottom="0px"}applyMaximizedIframeStyle(){const e=this.iframeEmbedder.iframe.style;this.isMobileOrTablet?(e.width="100%",e.height="100%",e.bottom="0px",e.right="0px"):(e.width="450px",e.height="650px",e.right="0px",e.bottom="0px",e.maxWidth="100%",e.maxHeight="100%")}handleChatWidgetInteraction(e){const t=e.action;switch(fn(`[Common] : Received action: ${t} -> resizing iframe`),t){case Wi.expandButtonClicked:this.handleExpandButtonClicked(e);break;case Wi.minimizeButtonClicked:this.handleMinimizeButtonClicked(e);break;case Wi.proactiveEndChatButtonClicked:this.handleProactiveEndChatButtonClicked(e);break;case Wi.proactiveEndChatButtonAppeared:this.handleProactiveEndChatButtonAppeared(e);break;case Wi.ResponseForEngagementId:this.handleEngagementIdResponse(e)}}handleExpandButtonClicked(e){Bi.updateStateInLocalStorage(A,t.ChatIsRequested,"currentUserActionState"),Bi.updateStateInLocalStorage(A,a.ChatWindow,"currentWidgetState"),this.applyMaximizedIframeStyle(),this.setChatWidgetWindowState(),this.handleZoomUXAEvent(c.EXPAND)}handleMinimizeButtonClicked(e){this.applyMinimizedIframeStyle(),this.setChatWidgetBubbleState(),this.handleZoomUXAEvent(c.MINIMIZE)}handleProactiveEndChatButtonClicked(e){this.updateIframeSizeForProactiveButtonClick(),this.setChatWidgetBubbleState(),this.handleZoomUXAEvent(c.MINIMIZE)}handleProactiveEndChatButtonAppeared(e){this.updateIframeSizeForProactiveButtonAppear(),this.setChatWidgetBubbleState(),this.handleZoomUXAEvent(c.MINIMIZE)}calculateIframeContainerHeight(){var e;const t=document.querySelector(I),i=null===(e=null==t?void 0:t.getBoundingClientRect())||void 0===e?void 0:e.height;return String(i&&i>0?i:48)}isUserMinimized(){var e;const t=Bi.getStateFromLocalStorage(A);if(!t||"object"!=typeof t)return!1;const i=undefined,o=undefined;return!((null===(e=this.args.chatInitProfile)||void 0===e?void 0:e.trustedHost)!==s.SIGN_CENTER_HOST)&&(t.currentIframeState===n.Visible&&t.currentWidgetState===a.ChatBubble)}createDivContainerForIframe(){const e=undefined;return Object.assign(document.createElement("div"),{className:I})}createIframeForZoomChat(){const e=this.iframeEmbedder.iframe,t=this.calculateIframeContainerHeight();e.setAttribute("id",p),e.setAttribute("height",t),e.setAttribute("sandbox","allow-scripts allow-same-origin allow-downloads allow-popups allow-forms"),e.style.position="fixed",this.isMobileOrTablet?e.style.zIndex="9999":e.style.zIndex="900",e.style.overflow="scroll",e.style.backgroundColor="transparent",e.style.display="none";const i=this.getUnifiedChatCookieStatus();return i.unifiedChatCookieStatus?(fn(`createIframeForZoomChat: Chat Type :: ${i.currentInitChat}, Cookie ${i.unifiedChatCookieStatus} exists, proceeding with handleCookieOnChatWidgetInit`),this.handleCookieOnChatWidgetInit(e)):(fn(`createIframeForZoomChat: Chat Type :: ${i.currentInitChat}, Cookie ${i.unifiedChatCookieStatus} not exists, proceeding with handleNoCookieOnChatWidgetInit`),this.handleNoCookieOnChatWidgetInit(e)),e}attachZoomChatIframe(){var e,t;try{fn("attachZoomChatIframe: [STARTED]");const i=I,n=document.querySelector(i),a=null!==(e=null==n?void 0:n.parentNode)&&void 0!==e?e:document.body,o=this.createDivContainerForIframe(),s=this.createIframeForZoomChat(),r=new Promise(((e,t)=>{s.addEventListener("load",(()=>{e(s)})),s.addEventListener("error",(e=>{t(new Error("Error while attaching Zoom chat iframe to parent window"))}))}));return n&&a.removeChild(n),o.appendChild(s),s.style.display="none",a.insertBefore(o,null!==(t=null==n?void 0:n.nextSibling)&&void 0!==t?t:a.firstChild),o.style.visibility="",fn("attachZoomChatIframe: [COMPLETED]"),r}catch(e){return e instanceof Error?Promise.reject(new Error(e.message)):Promise.reject(new Error("An unknown error occurred while attaching Zoom chat iframe to parent window."))}}detachZoomChatIframe(){this.el&&this.el.parentNode&&(this.el.parentNode.removeChild(this.el),this.el=null,this.setIframeReadyStatus(!1))}setIframeReadyStatus(e){this.isChatIframeReady=e}getIframeReadyStatus(){return this.isChatIframeReady}prepareZoomChatCredentialsMsg(){const e=undefined;return{creds:{chatapikey:this.args.chatApiKey,chaturi:this.args.chatUri,chatdataenv:this.args.chatDataEnv},action:xi.sendZoomChatCredentials,messageType:ua.RESPONSE,message:Oe.SEND_ZOOM_CHAT_CREDENTIALS}}executeAttachZoomChatScriptTagToIframe(){if(this.iframeEmbedder.iframe)if(this.iframeEmbedder.iframe.contentWindow)try{const e=this.prepareZoomChatCredentialsMsg();this.iframeEmbedder.sendMessage(e)}catch(e){this.handleIframeExecutionError(e)}else this.handleIframeContentWindowError();else this.handleIframeNotFoundError()}async initChatClient(){try{if(fn("initChatClient: zoom_chat_client module Initialization : [STARTED]"),this.handleZoomUXAEvent(c.INITIALIZED),this.setupInitializationTimeout(),this.getIframeReadyStatus()||this.el)return;this.attachMessageListener(),this.el=await this.attachZoomChatIframe()}catch(e){fn("initChatClient: zoom_chat_client module Initialization : [FAILED]"),this.handleIframeInitializationError(e)}}canInitiateSalesChatForUser(){var e,t;const i=((null===(t=null===(e=this.args.chatSpecificConfigs)||void 0===e?void 0:e.dbxChatConfigs)||void 0===t?void 0:t.countryCode)||"UnIdentified_Country").toUpperCase();return!ce.includes(i)}handleLoggingForSalesChatDisallowedCountry(){var t,i;const n=undefined,a=`Sales Chat Initialization skipped for the country - ${(null===(i=null===(t=this.args.chatSpecificConfigs)||void 0===t?void 0:t.dbxChatConfigs)||void 0===i?void 0:i.countryCode)||"UnIdentified_Country"}`;$i(e.Operational,a),this.handleZoomUXAEvent(c.SALESCHAT_DISALLOWED_COUNTRY)}handleInitiatedChatFromTransfer(){fn("handleInitiatedChatFromTransfer: Handling chat initiated from transfer");const e=this.getInitializedChatTypeFromProfile();En(e),this.setUserRequestedChatState(e),this.updateChatInteractionType(d.REACTIVE_CHAT),this.handleZoomUXAEvent(c.CHATREQUESTED),this.setUnifiedChatIframeToVisible(this.iframeEmbedder.iframe),this.applyMaximizedIframeStyle(),this.setChatWidgetWindowState(),this.setIframeVisibilityState(),this.saveUnifiedChatState(qo),this.handleZoomChatInitialDisplay(),fn(`handleInitiatedChatFromTransfer: Completed handling transfer for chat type: ${e}`)}shouldForceDisableChatProactiveOnVariantV1(e){var t,i,n,a,o,l;const d=null===(n=null===(i=null===(t=this.args)||void 0===t?void 0:t.chatSpecificConfigs)||void 0===i?void 0:i.dbxChatConfigs)||void 0===n?void 0:n.customProactiveChatExpVariant,c=null===(a=this.args.chatInitProfile)||void 0===a?void 0:a.trustedHost,u=undefined,h=bn(null!==(l=null===(o=this.args.chatInitProfile)||void 0===o?void 0:o.identifiedHref)&&void 0!==l?l:"");return!(e!==r.DBX_SALES_CHAT||c!==s.WWW_DBX_HOST||!Z.some((e=>h.startsWith(e)))||"V1"!==d)&&(fn(`shouldForceDisableChatProactiveOnVariantV1: Forcing chat to remain hidden on ${h}. Keeping DBX Chat = ${e} loaded in the background (reactive only, no proactive message flow).`),!0)}requestEngagementIdOnDemand(){var t;try{if(!(null===(t=this.iframeEmbedder.iframe)||void 0===t?void 0:t.contentWindow))return;fn("requestEngagementIdOnDemand: Sending message to request engagement id."),this.iframeEmbedder.sendMessage(zo)}catch(t){$i(e.NonCritical,`requestEngagementIdOnDemand: Error requesting engagement id: ${t}`)}}handleEngagementIdResponse(e){const t=null==e?void 0:e.engagementId;this.args.chatInitProfile&&t&&(this.args.chatInitProfile.engagementId=t,fn(`handleEngagementIdResponse: Received and stored engagementId: ${t}`))}detectChatStateMismatch(){var e;const i=_n(),n=null===(e=Bi.getStateFromLocalStorage(A))||void 0===e?void 0:e.currentUserActionState;i&&n===t.ChatIsNotRequested&&(fn("CHAT_STATE_MISMATCH: cookie exists but localStorage says CHAT_IS_NOT_REQUESTED"),this.handleZoomUXAEvent(c.CHAT_STATE_MISMATCH)),i||n!==t.ChatIsRequested||(fn("CHAT_STATE_MISMATCH: cookie missing but localStorage says CHAT_IS_REQUESTED"),this.handleZoomUXAEvent(c.CHAT_STATE_MISMATCH))}logEventWhenLocalStorageCleared(e){const t=undefined;Bi.getStateFromLocalStorage(e)||(this.handleZoomUXAEvent(c.LOCAL_STORAGE_CLEARED),fn("Zoom chat localstorage is cleared"))}}function ks(e){fn("initializeZoomChatClient: Chat configuration was successful. Proceeding with ZOOM_CHAT_CLIENT initialization.");const t=Ls.getInstance(e);Ls.setChatUri(e.chatUri),Ls.setChatApiKey(e.chatApiKey),Ls.setChatApiKey(e.chatDataEnv),t.initChatClient().then(Un)}function Fs(e){Ls.getInstance(e),Ls.setChatUri(e.chatUri),Ls.setChatApiKey(e.chatApiKey),Ls.setChatApiKey(e.chatDataEnv)}function Bs(e,t,i){fn(`handleDocsendChat: Before : ${JSON.stringify(i)}`);const n={identifiedChat:r.DOCSEND_CHAT,chatInteractionType:d.REACTIVE_CHAT,trustedHost:s.DOCSEND_HOST,identifiedHost:t,identifiedHref:e,supportedEntitlements:{docsendEntitlements:i.chatSupportedEntitlements.docsendEntitlements}};return i.chatInitProfile=n,fn(`handleDocsendChat: After : ${JSON.stringify(i)}`),i}function Ms(e){const t=window.location.href,i=undefined,n=undefined;ks(Bs(t,Nn(t),e))}function Ws(e){const t=undefined;return e===TrustedHosts.DOCSEND_HOST}function xs(e){var t,i;fn(`handleChatInitialization : dbxChatConfigResult : ${JSON.stringify(e)}`);const n=e.chatConfig;if(!n)return;const a=null!==(i=null===(t=n.chatInitProfile)||void 0===t?void 0:t.identifiedChat)&&void 0!==i?i:r.UNSUPPORTED_CHAT;if(a!==r.UNSUPPORTED_CHAT){if(a===r.DBX_CX_CHAT){if(Zs(n))return;Gs(n)}a===r.DBX_SALES_CHAT&&Vs(S,n)}else fn("handleChatInitialization: Unsupported chat type. Skipping initialization.")}function Xs(e){var t,i,n,a,o,s;const r=(null===(i=null===(t=e.chatSpecificConfigs)||void 0===t?void 0:t.dbxChatConfigs)||void 0===i?void 0:i.disableEntryPageForMobileConfig)||(null===(a=null===(n=e.chatSpecificConfigs)||void 0===n?void 0:n.dbxSignChatConfigs)||void 0===a?void 0:a.disableEntryPageForMobileConfig);if(fn(`shouldDisableChatOnMobile: disableEntryPageForMobileConfig isEnabled :: ${null==r?void 0:r.isEnabled}`),!(null==r?void 0:r.isEnabled))return!1;const l=null!==(s=null===(o=e.chatInitProfile)||void 0===o?void 0:o.identifiedHref)&&void 0!==s?s:"",d=bn(l),c=undefined,u=yn(Dn(l)),h=ta(),f=undefined,C=(Array.isArray(r.entryPages)?r.entryPages:[]).some((e=>d.startsWith(e)));return fn(`shouldDisableChatOnMobile: currentPath = ${d}`),fn(`shouldDisableChatOnMobile: isOnEntryPage = ${C}`),fn(`shouldDisableChatOnMobile: isMobile = ${h}`),fn(`shouldDisableChatOnMobile: upgradeTriggerPresent = ${u}`),C&&h&&u}function Gs(e){ks(e)}function Zs(e){var t;const{chatSpecificConfigs:i,chatInitProfile:n}=e,a=null==n?void 0:n.trustedHost,o=null===(t=null==i?void 0:i.dbxChatConfigs)||void 0===t?void 0:t.dbxUserIdentifiers,r=undefined;if(!o)switch(a){case s.WWW_DBX_HOST:return sn(),!0;case s.SIGN_CENTER_HOST:case s.HELP_CENTER_HOST:return rn(),!1}return"basic"===(null==o?void 0:o.plan)&&(an(o.plan),!0)}function Vs(e,t){var i;const n=null===(i=t.chatInitProfile)||void 0===i?void 0:i.trustedHost;if(n===s.WWW_DBX_HOST||n===s.SIGN_CENTER_HOST||n===s.DASH_DBX_HOST){if((n===s.WWW_DBX_HOST||n===s.SIGN_CENTER_HOST)&&Xs(t))return void on();fn("handleSalesChatInitialization: Using new zoom chat cookie consent implementation"),$s(e,t)}else if(n===s.HELP_CENTER_HOST||n===s.EXPERIENCE_HOST){const e=undefined;bs(S)&&(fn("handleSalesChatInitialization: UNIFIED CHAT COOKIE EXISTS/COOKIE CONSENT ALREADY GRANTED FOR SALES CHAT, PROCEEDING WITH INIT"),ks(t))}}function $s(e,t){const i=bs(e),n=Ds(T);if(fn(`evaluateChatInitialization: isSecureConsentCookieExists=${n}, unifiedChatCookieExists=${i}`),!n)return void zs(i,t,!1);const a=ys(T,_);fn(`evaluateChatInitialization: consentCategoryCookieKeyExists=${a}`),zs(i,t,a)}function zs(e,t,i){var n;return e?(fn("processChatInitialization: UNIFIED CHAT COOKIE EXISTS. Proceeding with initialization."),void ks(t)):i?(fn(`processChatInitialization: consentCategoryCookieKeyExists=${i}, unifiedChatCookieExists=${e}. [Default+Manual] Proceeding to allow ${null===(n=t.chatInitProfile)||void 0===n?void 0:n.identifiedChat} to load. Ignoring further signals and de-registering the callback after triggering the re-consent callback.`),Fs(t),void jn()):(fn("processChatInitialization: Waiting for user consent signal before initializing ZOOM_CHAT_CLIENT."),void Fs(t))}function Ks(t,i,n){var a,o,r;if((null===(a=null==i?void 0:i.error)||void 0===a?void 0:a.type)!==e.Critical){if(!(null==i?void 0:i.error)&&i.chatConfig){if(null!==(o=(r=i.chatConfig).chatSpecificConfigs)&&void 0!==o||(r.chatSpecificConfigs={}),t===s.HELP_CENTER_HOST)i.chatConfig.chatSpecificConfigs.dbxHelpChatConfigs=n;else{if(t!==s.EXPERIENCE_HOST)return;i.chatConfig.chatSpecificConfigs.dbxExperienceChatConfigs=n}xs(i)}}else nn()}function Js(e){const t=isUnifiedChatCookieExists(UNIFIED_CHAT_COOKIE_NAME);logToZoomChatManager(`initializeChatIfConsentGranted : is unifiedChatCookieExists : ${JSON.stringify(t)}`),t?(logToZoomChatManager("initializeChatIfConsentGranted: UNIFIED CHAT COOKIE EXISTS/COOKIE CONSENT ALREADY GRANTED FOR SALES CHAT, PROCEEDING WITH INIT OF ZOOM_CHAT_CLIENT"),initializeZoomChatClient(e)):(logToZoomChatManager("initializeChatIfConsentGranted: UNIFIED CHAT COOKIE NOT_EXISTS FOR SALES CHAT, REGISTERED THE CALLBACK, WAITING FOR COOKIE_CONSENT SIGNAL"),initZoomChatAndAwaitUserConsent(e))}Ls.chatUri="",Ls.chatApiKey="",Ls.chatDataEnv="",Ls.instance=null;const{timeZone:js,...qs}=Te.formatOptions,Ys=new Intl.DateTimeFormat(Ie,{...Te.formatOptions,timeZone:Te.pacificTZ}),Qs=new Intl.DateTimeFormat(Ie,{...qs,...ve}),er=new Intl.DateTimeFormat(Ie,{...Te.formatOptions,timeZone:Te.pacificTZ,...ve});function tr(e){var t,i,n,a,o,s;const r=Ys.formatToParts(e),l=null!==(i=null===(t=r.find((e=>"weekday"===e.type)))||void 0===t?void 0:t.value)&&void 0!==i?i:"",d=parseInt(null!==(a=null===(n=r.find((e=>"hour"===e.type)))||void 0===n?void 0:n.value)&&void 0!==a?a:"0",10),c=parseInt(null!==(s=null===(o=r.find((e=>"minute"===e.type)))||void 0===o?void 0:o.value)&&void 0!==s?s:"0",10);return fn(`getPacificParts: weekday=${l}, hour=${d}, minute=${c}`),{weekday:l,hour:d,minute:c}}function ir(e=new Date){const{weekday:t}=tr(e),i="Sat"===t||"Sun"===t;return fn(`isPacificWeekend: weekday=${t}, isWeekend=${i}`),i}function nr(e=new Date){const{hour:t,minute:i}=tr(e),n=60*t+i,a=n>=Te.startMinutes&&n<Te.endMinutes;return fn(`isWithinPacificBusinessHours: hour=${t}, minute=${i}, minutesSinceMidnight=${n}, withinHours=${a}`),a}function ar(e=new Date){const t=undefined,i=undefined;fn(`logPacificDebug: [DASH_CHAT_BH] Local=${Qs.format(e)}  Pacific=${er.format(e)}`)}function or(e){var t,i,n;const a=new Date,o=null===(n=null===(i=null===(t=null==e?void 0:e.chatSpecificConfigs)||void 0===t?void 0:t.dbxDashChatConfigs)||void 0===i?void 0:i.businessHoursConfig)||void 0===n?void 0:n.chatOperationalHours;if(o&&o.businessTimezone&&o.businessHours){try{const e=new Intl.DateTimeFormat(Ie,ve).format(a),t=new Intl.DateTimeFormat(Ie,{...ve,timeZone:o.businessTimezone}).format(a);fn(`logTimezoneDebug: [DASH_CHAT_BH] Local=${e}  TZ(${o.businessTimezone})=${t}`)}catch{}const e=undefined;return wn(o)?{}:(ji(),{error:Ve})}return ar(a),ir(a)?(qi(),{error:Ve}):nr(a)?{}:(ji(),{error:Ve})}function sr(e,t,i){var n,a,o,r,l,d,c,u,h;if(e===s.WWW_DBX_HOST){const e=null===(a=null===(n=i.chatSpecificConfigs)||void 0===n?void 0:n.dbxChatConfigs)||void 0===a?void 0:a.salesEntryPagesConfig,s=null!=e?e:V;return null!==(o=null==s?void 0:s[t])&&void 0!==o?o:0}if(e===s.DASH_DBX_HOST){const e=null===(l=null===(r=i.chatSpecificConfigs)||void 0===r?void 0:r.dbxDashChatConfigs)||void 0===l?void 0:l.salesEntryPagesConfig,n=null!==(d=null==e?void 0:e.defaultAllPages)&&void 0!==d?d:{},a=null!==(c=null==e?void 0:e.entryPages)&&void 0!==c?c:{};if(Object.keys(n).length>0&&0===Object.keys(a).length)return fn("getSalesChatSupportedEntryPagesMap: Case 1: defaultAllPages is NOT empty, entryPages is empty  return current path"),null!==(u=n["/"])&&void 0!==u?u:0;if(0===Object.keys(n).length&&Object.keys(a).length>0)return fn("getSalesChatSupportedEntryPagesMap: Case 2: defaultAllPages is empty, entryPages is NOT empty  use entryPages map"),null!==(h=null==a?void 0:a[t])&&void 0!==h?h:0}return 0}function rr(e,t){var i,n,a;const o=null===(n=null===(i=t.chatSpecificConfigs)||void 0===i?void 0:i.dbxChatConfigs)||void 0===n?void 0:n.salesEntryPagesConfig,s=undefined;return null!==(a=(null!=o?o:J)[e])&&void 0!==a?a:0}function lr(e){return e.startsWith("/get_help")&&e.endsWith("/contact-us")?j["/get_help/*/contact-us"]:j[e]||0}function dr(e,t){var i,n,a,o,r,l,d,c;if(e===s.WWW_DBX_HOST||e===s.SIGN_CENTER_HOST){const e=null===(n=null===(i=t.chatSpecificConfigs)||void 0===i?void 0:i.dbxChatConfigs)||void 0===n?void 0:n.salesEntryPagesConfig,r=null===(o=null===(a=t.chatSpecificConfigs)||void 0===a?void 0:a.dbxSignChatConfigs)||void 0===o?void 0:o.salesEntryPagesConfig,l=null!=e?e:V,d=null!=r?r:J;return{[s.WWW_DBX_HOST]:Object.keys(l),[s.SIGN_CENTER_HOST]:Object.keys(d)}}if(e===s.DASH_DBX_HOST){const e=null===(l=null===(r=t.chatSpecificConfigs)||void 0===r?void 0:r.dbxDashChatConfigs)||void 0===l?void 0:l.salesEntryPagesConfig,i=null!==(d=null==e?void 0:e.defaultAllPages)&&void 0!==d?d:{},n=null!==(c=null==e?void 0:e.entryPages)&&void 0!==c?c:{};if(Object.keys(i).length>0&&0===Object.keys(n).length)return fn("getSalesChatSupportedEntryPagesMap: Case 1: defaultAllPages is NOT empty, entryPages is empty  return current path"),{[s.DASH_DBX_HOST]:Object.keys(i)};if(0===Object.keys(i).length&&Object.keys(n).length>0)return fn("getSalesChatSupportedEntryPagesMap: Case 2: defaultAllPages is empty, entryPages is NOT empty  use entryPages map"),{[s.DASH_DBX_HOST]:Object.keys(n)}}return{[s.UNSUPPORTED_HOST]:[]}}function cr(){return{[s.WWW_DBX_HOST]:Object.keys(j)}}function ur(e,t){if(!e||!Array.isArray(t)||0===t.length)return{status:!1,key:null};const i=bn(e);if(!i)return{status:!1,key:null};for(const{name:e,entriesMap:n}of t)if(n&&"object"==typeof n){for(const e in n)if(i===e||i.startsWith(`${e}/`))return{status:!0,key:e,value:n[e]}}else fn(`findValueInMaps: Skipping invalid map "${e}".`);return{status:!1,key:null}}function hr(e){var t,i,n,a,o;const s=undefined,r=Dn(Bn()),l=undefined;if(!(null!==(i=null===(t=null==r?void 0:r.key)||void 0===t?void 0:t.includes(K))&&void 0!==i&&i))return en(),{error:Ue};const d=undefined;if(null!==(o=null===(a=null===(n=null==e?void 0:e.chatSpecificConfigs)||void 0===n?void 0:n.dbxChatConfigs)||void 0===a?void 0:a.suppressDashSalesChatOutsideHoursConfig)&&void 0!==o&&o){const e=or();if(e.error)return e}return{}}function fr(e,t){var i,n,a,o;const s=null===(n=null===(i=t.chatSpecificConfigs)||void 0===i?void 0:i.dbxChatConfigs)||void 0===n?void 0:n.salesEntryPagesConfig,r=null===(o=null===(a=t.chatSpecificConfigs)||void 0===a?void 0:a.dbxChatConfigs)||void 0===o?void 0:o.proActiveMessagingConfig;(null==r?void 0:r.isEnabled)&&Array.isArray(r.proActiveMessagingPages)&&s&&r.proActiveMessagingPages.forEach((e=>{s[e]=0}));const l=undefined,d=e in(null!=s?s:V);return fn(`isDbxSalesEntryPage: Checking for '${e}' - Exists: ${d}`),d}function Cr(e,t){var i,n,a,o;if(e.startsWith("/get_help")&&e.endsWith("/contact-us"))return fn(`isDbxCXEntryPage: Checking for '${e}' - Exists: true`),!0;const s=undefined;return null!==(o=null===(a=null===(n=null===(i=t.chatSpecificConfigs)||void 0===i?void 0:i.dbxChatConfigs)||void 0===n?void 0:n.discoverabilityEntryPagesConfig)||void 0===a?void 0:a.isEnabled)&&void 0!==o&&o?(fn(`isDbxCXEntryPage: Checking for '${e}' - Exists: true`),!0):j.hasOwnProperty(e)}function gr(e,t){var i,n;const a=null===(n=null===(i=t.chatSpecificConfigs)||void 0===i?void 0:i.dbxSignChatConfigs)||void 0===n?void 0:n.salesEntryPagesConfig,o=undefined,s=e in(null!=a?a:J);return fn(`isSignEntryPage: Checking for '${e}' - Exists: ${s}`),s}function Er(e,t,i,n){try{const[a,o]=Tr(e,t,i,n);return fn(`checkEntryPage : ${[a,o]}`),{isValid:a,entryPath:o}}catch(e){return $i(We.type,We.message,e),{isValid:!1,entryPath:null}}}function Sr(e,t,i){const n=dr(e,i);fn(`isItEntryPageToInitSalesChat: salesChatSupportedEntryPagesMap: ${JSON.stringify(n)}`);const a=Er(e,t,n,i);return fn(`isItEntryPageToInitSalesChat: result: ${JSON.stringify(a)}`),a}function mr(e,t,i){const n=undefined;return Er(e,t,cr(),i)}function Tr(e,t,i,n){var a,o,r,l;let d=null;try{if(d=bn(t),!d)throw new Error(`Invalid path extracted from URL: ${t}`);const c=i[e]||[];if(0===c.length&&fn(`isCurrentPathSupported: No supported pages found for host: ${e}`),fn(`isCurrentPathSupported: supportedPages: ${c}`),[s.DASH_DBX_HOST].includes(e)){const e=null===(o=null===(a=n.chatSpecificConfigs)||void 0===a?void 0:a.dbxDashChatConfigs)||void 0===o?void 0:o.salesEntryPagesConfig,t=null!==(r=null==e?void 0:e.defaultAllPages)&&void 0!==r?r:{},i=null!==(l=null==e?void 0:e.entryPages)&&void 0!==l?l:{};if(Object.keys(t).length>0&&0===Object.keys(i).length)return fn("getSalesChatSupportedEntryPagesMap: Case 1: defaultAllPages is NOT empty, entryPages is empty  return current path"),[!0,d]}const u=undefined;return[c.some((e=>d&&(d===e||d.startsWith(`${e}/`)))),d]}catch(e){return $i(xe.type,xe.message,e),[!1,d]}}function _r(e,t,i){var n,a,o,r,l,d,c,u,h,f,C,g;if(fn(`isCurrentPageIsInChatEntryPages: validatedDomainSpecificMsg : ${e}`),[s.WWW_DBX_HOST,s.SIGN_CENTER_HOST].includes(e)){const e=null===(a=null===(n=i.chatSpecificConfigs)||void 0===n?void 0:n.dbxChatConfigs)||void 0===a?void 0:a.salesEntryPagesConfig,s=null===(r=null===(o=i.chatSpecificConfigs)||void 0===o?void 0:o.dbxChatConfigs)||void 0===r?void 0:r.proActiveMessagingConfig;(null==s?void 0:s.isEnabled)&&Array.isArray(s.proActiveMessagingPages)&&e&&s.proActiveMessagingPages.forEach((t=>{e[t]=0}));const h=null===(d=null===(l=i.chatSpecificConfigs)||void 0===l?void 0:l.dbxSignChatConfigs)||void 0===d?void 0:d.salesEntryPagesConfig,f=null!=e?e:V,C=null!=h?h:J,g=null===(u=null===(c=i.chatSpecificConfigs)||void 0===c?void 0:c.dbxChatConfigs)||void 0===u?void 0:u.discoverabilityEntryPagesConfig;(null==g?void 0:g.isEnabled)&&Array.isArray(g.discoverabilityEntryPages)&&g.discoverabilityEntryPages.forEach((e=>{j[e]=0}));const E=undefined;return ur(t,[{name:"DBX_SALES_ENTRIES",entriesMap:f},{name:"SIGN_SALES_ENTRIES",entriesMap:C},{name:"DBX_CX_ENTRIES",entriesMap:j}])}if([s.DASH_DBX_HOST].includes(e)){const e=null===(f=null===(h=i.chatSpecificConfigs)||void 0===h?void 0:h.dbxDashChatConfigs)||void 0===f?void 0:f.salesEntryPagesConfig,n=null!==(C=null==e?void 0:e.defaultAllPages)&&void 0!==C?C:{},a=null!==(g=null==e?void 0:e.entryPages)&&void 0!==g?g:{};if(Object.keys(n).length>0&&0===Object.keys(a).length){fn("isCurrentPageIsInChatEntryPages: Case 1: defaultAllPages is NOT empty, entryPages is empty  return current path");const e=undefined;return{status:!0,key:bn(t)}}if(0===Object.keys(n).length&&Object.keys(a).length>0){fn("isCurrentPageIsInChatEntryPages: Case 2: defaultAllPages is empty, entryPages is NOT empty  use entryPages map");const e=undefined;return ur(t,[{name:"DASH_SALES_ENTRIES",entriesMap:a}])}return{status:!1,key:null}}return fn("isCurrentPageIsInChatEntryPages: fallback if host doesn't match"),{status:!1,key:null}}function pr(e,t){var i,n;const a=null===(n=null===(i=t.chatSpecificConfigs)||void 0===i?void 0:i.dbxSignChatConfigs)||void 0===n?void 0:n.salesEntryPagesConfig,o=undefined,s=undefined;return ur(e,[{name:"SIGN_SALES_ENTRIES",entriesMap:null!=a?a:J}])}function Ir(e,t){var i,n,a,o;const s=null===(n=null===(i=t.chatSpecificConfigs)||void 0===i?void 0:i.dbxDashChatConfigs)||void 0===n?void 0:n.salesEntryPagesConfig,r=null!==(a=null==s?void 0:s.defaultAllPages)&&void 0!==a?a:{},l=null!==(o=null==s?void 0:s.entryPages)&&void 0!==o?o:{},d=bn(e);if(Object.keys(r).length>0&&0===Object.keys(l).length)return fn("isDashEntryPage: Case 1: defaultAllPages is NOT empty, entryPages is empty  return true"),{status:!0,key:d,value:r["/"]};if(0===Object.keys(r).length&&Object.keys(l).length>0){fn("isDashEntryPage: Case 2: defaultAllPages is empty, entryPages is NOT empty  check if entryPageKey exists in entryPages");const t=undefined;return ur(e,[{name:"DASH_SALES_ENTRIES",entriesMap:l}])}return{status:!1,key:d}}function vr(e,t){var i,n,a,o;const s=null===(n=null===(i=t.chatSpecificConfigs)||void 0===i?void 0:i.dbxDashChatConfigs)||void 0===n?void 0:n.salesEntryPagesConfig,r=null!==(a=null==s?void 0:s.defaultAllPages)&&void 0!==a?a:{},l=null!==(o=null==s?void 0:s.entryPages)&&void 0!==o?o:{};if(Object.keys(r).length>0&&0===Object.keys(l).length)return fn("isDashEntryPage: Case 1: defaultAllPages is NOT empty, entryPages is empty  return true"),!0;if(0===Object.keys(r).length&&Object.keys(l).length>0){fn("isDashEntryPage: Case 2: defaultAllPages is empty, entryPages is NOT empty  check if entryPageKey exists in entryPages");const t=undefined;return l.hasOwnProperty(e)}return!1}function Ar(e,t,i,n,a){return Gr(e,t,i,n,a)}function Or(e,t,i,n,a){return Gr(e,t,i,n,a)}function Nr(e,t,i,n,a,o){const s=gn(t);return s===w?Pr(e,r.DBX_SALES_CHAT,i,n,a,o):s===U?Pr(e,r.DBX_CX_CHAT,i,n,a,o):s!==U&&s!==w?{error:He}:{error:Le}}function br(e){var t,i,n,a,o,s;const l=undefined;if("OFF"!==(null===(i=null===(t=e.chatSpecificConfigs)||void 0===t?void 0:t.dbxChatConfigs)||void 0===i?void 0:i.customProactiveChatExpVariant)){const t=ys(T,_),i=undefined;vs({chatType:r.DBX_SALES_CHAT,chatInteractionType:d.PROACTIVE_CHAT,surfaceScreenHeight:na(),surfaceScreenWidth:aa(),platform:oa(),timeUntilchatInteraction:String(0),totalChatDurationInSec:String(0),engagementId:"",salesExperimentVariant:null===(a=null===(n=e.chatSpecificConfigs)||void 0===n?void 0:n.dbxChatConfigs)||void 0===a?void 0:a.salesExperimentVariant,customProactiveChatExpVariant:null===(s=null===(o=e.chatSpecificConfigs)||void 0===o?void 0:o.dbxChatConfigs)||void 0===s?void 0:s.customProactiveChatExpVariant,consentCookieStatus:t})}}function Dr(e,t,i,n,a){const o=_r(a,t,n);if(fn(`prepareChatConfigsWhenNoDbxCookieExists: ${JSON.stringify(o)}`),br(n),o.status){const s=o.key;if(s){if(fr(s,n)){if(s===$){const e=undefined;if(!qn())return Qi(),{error:Pe}}if(s===z){const e=hr(n);if(e.error)return e}return Pr(e,r.DBX_SALES_CHAT,t,i,n,a)}return Cr(s,n)?Pr(e,r.DBX_CX_CHAT,t,i,n,a):(Ji(s),{error:De})}return Ki(t),{error:Re}}return Yi(t),{error:we}}function yr(e,t,i,n,a){if(!Rs())return zi(a),{error:Fe};switch(a){case s.HELP_CENTER_HOST:const o=undefined;return Or(e,a,i,t,n)||{error:we};case s.EXPERIENCE_HOST:const r=undefined;return Ar(e,a,i,t,n)||{error:we};default:return{error:we}}}function Rr(e,t,i){const n=window.location.href,a=Nn(n),o=bs(S);if(fn(`handleChatForDropboxSubdomain: Handling chat setup configurations for: '${t}'.`),Fn(o,e,t),o){const e=_n();if(!e)return zi(t),{error:He};const o=Tn(e);return o!==r.UNSUPPORTED_CHAT?(fn(`handleChatForDropboxSubdomain: Proceeding to prepare chat configurations for ${o}.`),localStorage.setItem(A,JSON.stringify(Yo)),yr(o,n,a,i,t)):(tn(t),{error:ke})}return zi(t),{error:Fe}}function wr(t,i,n,a,o,r){switch(r){case s.WWW_DBX_HOST:return Ur(t,i,n,a,o,r);case s.SIGN_CENTER_HOST:return Hr(t,i,n,a,o,r);case s.DASH_DBX_HOST:return Ur(t,i,n,a,o,r);default:return{error:{type:e.Critical,message:`No handler for domain ${r}`}}}}function Pr(e,t,i,n,a,o){const s=undefined;return wr(e,t,i,n,a,o)}function Ur(e,t,i,n,a,o){return t===r.DBX_SALES_CHAT?kr(e,o,i,n,t,a):t===r.DBX_CX_CHAT?Fr(e,o,i,n,t,a):{error:ke}}function Hr(e,t,i,n,a,o){const s=gn(S);return e?s===w?Mr(t,i,n,a,o,0):s===U?Wr(t,i,n,a,o,0):{error:Le}:{error:Fe}}function Lr(e,t,i,n,a,o,s,r,l,d){const c=s(o,t,a);return d(S)?l(e,o,n,i,a):r(e,o,n,i,a,c)}function kr(e,t,i,n,a,o){if(e&&t===s.WWW_DBX_HOST&&gn(S)===w)return Vr(a,t,n,i,o,0);if(e&&t===s.DASH_DBX_HOST&&gn(S)===w)return Vr(a,t,n,i,o,0);{const e=Sr(t,i,o);return fn(`handleDbxSalesChat: isItEntryPageToInitSalesChat->entryPageInfo: ${JSON.stringify(e)}`),null===e.entryPath?(cn(s.WWW_DBX_HOST,i),{error:ye}):e.isValid?Lr(a,e.entryPath,i,n,o,t,sr,Zr,Gr,bs):{error:ye}}}function Fr(e,t,i,n,a,o){if(e&&t===s.WWW_DBX_HOST&&gn(S)===U)return Vr(a,t,n,i,o,0);{const e=mr(t,i,o);return null===e.entryPath?(cn(s.WWW_DBX_HOST,i),{error:ye}):e.isValid?Lr(a,e.entryPath,i,n,o,t,lr,Zr,Gr,bs):{error:ye}}}function Br(e,t,i,n){if(zn())return ji(),{error:Ve};const a=pr(e,i);if(a.status){const o=a.key;if(o){if(gr(o,i)){const a=undefined,o=rr(bn(e),i);return Mr(r.DBX_SALES_CHAT,e,t,i,n,o)}return Ji(o),{error:De}}return Ki(e),{error:Re}}return Yi(e),{error:we}}function Mr(e,t,i,n,a,o){return Zr(e,a,i,t,n,o)}function Wr(e,t,i,n,a,o){return Zr(e,a,i,t,n,o)}function xr(e,t,i,n,a,o,s){return{identifiedChat:e,chatInteractionType:t,trustedHost:i,identifiedHost:n,identifiedHref:a,supportedEntitlements:o,identifiedChatStartUpTime:s}}function Xr(t,i,n,a,o,r){const c=Hn(i);if(c===l.UNSUPPORTED_ENTITLEMENTS)return $i(Ze.type,Ze.message,void 0),{error:Ze};let u;try{u=Ln(c,o)}catch(t){return $i(e.Critical,Be.message,t),{error:Be}}return c!==l.HELP_CENTER_ENTITLEMENTS&&c!==l.EXPERIENCE_ENTITLEMENTS||(r=0),i===s.WWW_DBX_HOST?xr(t,d.PROACTIVE_CHAT,s.WWW_DBX_HOST,n,a,u,r):i===s.HELP_CENTER_HOST||i===s.EXPERIENCE_HOST?xr(t,d.PROACTIVE_CHAT,i,n,a,u,r):i===s.SIGN_CENTER_HOST?xr(t,d.PROACTIVE_CHAT,s.SIGN_CENTER_HOST,n,a,u,r):i===s.DASH_DBX_HOST?(fn(`initChatProfile: proActiveChatTimer: ${r}`),xr(t,d.PROACTIVE_CHAT,s.DASH_DBX_HOST,n,a,u,r)):{error:Me}}function Gr(e,t,i,n,a){return Zr(e,t,i,n,a,0)}function Zr(e,t,i,n,a,o){const s=Xr(e,t,i,n,a.chatSupportedEntitlements,o);return"error"in s?{error:s.error}:(a.chatInitProfile=s,{chatConfig:a})}function Vr(t,i,n,a,o,s){return 0===s?Zr(t,i,n,a,o,s):{error:{type:e.Operational,message:`Proactive chat timer is not 0. Timer value: ${s}.`}}}function $r(e,t,i,n){const a=Ir(e,i);if(a.status){const o=a.key;if(o){if(vr(o,i)){const a=undefined,o=rr(bn(e),i);return zr(r.DBX_SALES_CHAT,e,t,i,n,o)}return Ji(o),{error:De}}return Ki(e),{error:Re}}return Yi(e),{error:we}}function zr(e,t,i,n,a,o){return Zr(e,a,i,t,n,o)}function Kr(t,i,n){var a;i.chatSpecificConfigs||(i.chatSpecificConfigs={}),i.chatSpecificConfigs.dbxDashChatConfigs||(i.chatSpecificConfigs.dbxDashChatConfigs={...n});const o=Jr(S,t,i);(null===(a=null==o?void 0:o.error)||void 0===a?void 0:a.type)!==e.Critical?(null==o?void 0:o.error)||xs(o):nn()}function Jr(e,t,i){var n,a,o,s;const r=Bn(),l=Nn(r),d=bs(S);if(d)return Bi.saveStateToLocalStorage(A,Yo),Nr(d,e,r,l,i,t);{const e=undefined;if(null!==(s=null===(o=null===(a=null===(n=i.chatSpecificConfigs)||void 0===n?void 0:n.dbxDashChatConfigs)||void 0===a?void 0:a.businessHoursConfig)||void 0===o?void 0:o.toBeSuppressed)&&void 0!==s&&s){const e=or(i);if(e.error)return e}return $r(r,l,i,t)}}function jr(e,t,i){const n=undefined;Ks(e,qr(S,e,t),i)}function qr(e,t,i){return Rr(e,t,i)}function Yr(e,t,i){const n=undefined;Ks(e,Qr(S,e,t),i)}function Qr(e,t,i){return Rr(e,t,i)}function el(t,i,n){var a;i.chatSpecificConfigs||(i.chatSpecificConfigs={}),i.chatSpecificConfigs.dbxSignChatConfigs||(i.chatSpecificConfigs.dbxSignChatConfigs={...n});const o=tl(S,t,i);(null===(a=null==o?void 0:o.error)||void 0===a?void 0:a.type)!==e.Critical?(null==o?void 0:o.error)||xs(o):nn()}function tl(e,t,i){const n=Bn(),a=Nn(n),o=bs(S);return o?(Bi.saveStateToLocalStorage(A,Yo),Nr(o,e,n,a,i,t)):Br(n,a,i,t)}function il(t,i,n){var a;i.chatSpecificConfigs||(i.chatSpecificConfigs={}),i.chatSpecificConfigs.dbxChatConfigs||(i.chatSpecificConfigs.dbxChatConfigs={...n});const o=nl(S,t,i);(null===(a=null==o?void 0:o.error)||void 0===a?void 0:a.type)!==e.Critical?(null==o?void 0:o.error)||xs(o):nn()}function nl(e,t,i){const n=Bn(),a=Nn(n),o=bs(S);return o?Nr(o,e,n,a,i,t):Dr(o,n,a,i,t)}function al(){var e,t,i,n,a,o=window.dbxPithosConfig.zoom_chat_manager_init_data.iframeSrc;const s=window.dbxPithosConfig.zoom_chat_manager_init_data.iframeOrigin,r=window.dbxPithosConfig.zoom_chat_manager_init_data.chaturiProtocol,l=window.dbxPithosConfig.zoom_chat_manager_init_data.chaturiSubdomain,d=window.dbxPithosConfig.zoom_chat_manager_init_data.chaturiDomain,c=window.dbxPithosConfig.zoom_chat_manager_init_data.chaturiTopleveldomain,u=window.dbxPithosConfig.zoom_chat_manager_init_data.chaturiPathname,h=window.dbxPithosConfig.zoom_chat_manager_init_data.chaturiExtJsFileName,f=window.dbxPithosConfig.zoom_chat_manager_init_data.chaturiApiKey,C=window.dbxPithosConfig.zoom_chat_manager_init_data.chaturiDataEnv,g=undefined,E=r+"://"+l+"."+d+"."+c+u+"/"+h,S=window.dbxPithosConfig.zoom_chat_manager_init_data.chatSupportedEntitlements,m=undefined;return Hs.getInstance().setState({userIdentifiers:null!==(a=null===(n=null===(i=null===(t=null===(e=window.dbxPithosConfig)||void 0===e?void 0:e.zoom_chat_manager_init_data)||void 0===t?void 0:t.domainSpecificChatConfigs)||void 0===i?void 0:i.dbxChatConfigs)||void 0===n?void 0:n.dbxUserIdentifiers)&&void 0!==a?a:void 0}),{iframeSrc:o,iframeOrigin:s,chatUri:E,chatApiKey:f,chatDataEnv:C,chatSupportedEntitlements:S}}function ol(){var e,t,i,n,a,o,s,r,l,d,c,u;const h=null===(t=null===(e=window.dbxPithosConfig.zoom_chat_manager_init_data)||void 0===e?void 0:e.domainSpecificChatConfigs)||void 0===t?void 0:t.dbxChatConfigs;return{discoverabilityEntryPagesConfig:null!==(i=null==h?void 0:h.discoverabilityEntryPagesConfig)&&void 0!==i?i:null,customProactiveChatExpVariant:null!==(n=null==h?void 0:h.customProactiveChatExpVariant)&&void 0!==n?n:fe,dashMobileExperienceConfig:null!==(a=null==h?void 0:h.dashMobileExperienceConfig)&&void 0!==a?a:Se,salesEntryPagesConfig:null!==(o=null==h?void 0:h.salesEntryPagesConfig)&&void 0!==o?o:{},disableEntryPageForMobileConfig:null!==(s=null==h?void 0:h.disableEntryPageForMobileConfig)&&void 0!==s?s:null,dbxUserIdentifiers:null!==(r=null==h?void 0:h.dbxUserIdentifiers)&&void 0!==r?r:null,isUserLoggedIn:null!==(l=null==h?void 0:h.isUserLoggedIn)&&void 0!==l&&l,salesExperimentVariant:null!==(d=null==h?void 0:h.salesExperimentVariant)&&void 0!==d?d:Ce,proActiveMessagingConfig:null!==(c=null==h?void 0:h.proActiveMessagingConfig)&&void 0!==c?c:ge,countryCode:null==h?void 0:h.countryCode,suppressDashSalesChatOutsideHoursConfig:null!==(u=null==h?void 0:h.suppressDashSalesChatOutsideHoursConfig)&&void 0!==u&&u}}function sl(){var e,t,i,n,a,o,s,r;const l=null===(t=null===(e=window.dbxPithosConfig.zoom_chat_manager_init_data)||void 0===e?void 0:e.domainSpecificChatConfigs)||void 0===t?void 0:t.dbxHelpChatConfigs;return{isChatEnabledForSubdomains:null!==(i=null==l?void 0:l.isChatEnabledForSubdomains)&&void 0!==i&&i,salesExperimentVariant:null!==(n=null==l?void 0:l.salesExperimentVariant)&&void 0!==n?n:Ce,salesEntryPagesConfig:null!==(a=null==l?void 0:l.salesEntryPagesConfig)&&void 0!==a?a:{},proActiveMessagingConfig:null!==(o=null==l?void 0:l.proActiveMessagingConfig)&&void 0!==o?o:ge,dashMobileExperienceConfig:null!==(s=null==l?void 0:l.dashMobileExperienceConfig)&&void 0!==s?s:Se,businessHoursConfig:null!==(r=null==l?void 0:l.businessHoursConfig)&&void 0!==r?r:me}}function rl(){var e,t,i,n,a,o,s,r;const l=null===(t=null===(e=window.dbxPithosConfig.zoom_chat_manager_init_data)||void 0===e?void 0:e.domainSpecificChatConfigs)||void 0===t?void 0:t.dbxExperienceChatConfigs;return{isChatEnabledForSubdomains:null!==(i=null==l?void 0:l.isChatEnabledForSubdomains)&&void 0!==i&&i,salesExperimentVariant:null!==(n=null==l?void 0:l.salesExperimentVariant)&&void 0!==n?n:Ce,salesEntryPagesConfig:null!==(a=null==l?void 0:l.salesEntryPagesConfig)&&void 0!==a?a:{},proActiveMessagingConfig:null!==(o=null==l?void 0:l.proActiveMessagingConfig)&&void 0!==o?o:ge,dashMobileExperienceConfig:null!==(s=null==l?void 0:l.dashMobileExperienceConfig)&&void 0!==s?s:Se,businessHoursConfig:null!==(r=null==l?void 0:l.businessHoursConfig)&&void 0!==r?r:me}}function ll(){var e,t,i,n,a,o,s,r;const l=null===(t=null===(e=window.dbxPithosConfig.zoom_chat_manager_init_data)||void 0===e?void 0:e.domainSpecificChatConfigs)||void 0===t?void 0:t.dbxSignChatConfigs;return{salesExperimentVariant:null!==(i=null==l?void 0:l.salesExperimentVariant)&&void 0!==i?i:Ce,isChatEnabledForSubdomains:null!==(n=null==l?void 0:l.isChatEnabledForSubdomains)&&void 0!==n&&n,salesEntryPagesConfig:null!==(a=null==l?void 0:l.salesEntryPagesConfig)&&void 0!==a?a:{},proActiveMessagingConfig:null!==(o=null==l?void 0:l.proActiveMessagingConfig)&&void 0!==o?o:ge,dashMobileExperienceConfig:null!==(s=null==l?void 0:l.dashMobileExperienceConfig)&&void 0!==s?s:Se,businessHoursConfig:null!==(r=null==l?void 0:l.businessHoursConfig)&&void 0!==r?r:me}}function dl(){var e,t,i,n,a,o,s,r;const l=null===(t=null===(e=window.dbxPithosConfig.zoom_chat_manager_init_data)||void 0===e?void 0:e.domainSpecificChatConfigs)||void 0===t?void 0:t.dbxDashChatConfigs;return{salesEntryPagesConfig:null!==(i=null==l?void 0:l.salesEntryPagesConfig)&&void 0!==i?i:Ee,isChatEnabledForSubdomains:null!==(n=null==l?void 0:l.isChatEnabledForSubdomains)&&void 0!==n&&n,proActiveMessagingConfig:null!==(a=null==l?void 0:l.proActiveMessagingConfig)&&void 0!==a?a:ge,salesExperimentVariant:null!==(o=null==l?void 0:l.salesExperimentVariant)&&void 0!==o?o:Ce,dashMobileExperienceConfig:null!==(s=null==l?void 0:l.dashMobileExperienceConfig)&&void 0!==s?s:Se,businessHoursConfig:null!==(r=null==l?void 0:l.businessHoursConfig)&&void 0!==r?r:me}}function cl({baseChatConfigs:e}){const t=undefined,i=undefined,n=vn(Nn(window.location.href),e.chatSupportedEntitlements);if(n===s.WWW_DBX_HOST){const t=undefined;il(n,e,ol())}else if(n===s.SIGN_CENTER_HOST){const t=undefined;el(n,e,ll())}else if(n===s.HELP_CENTER_HOST){const t=undefined;Yr(n,e,sl())}else if(n===s.EXPERIENCE_HOST){const t=undefined;jr(n,e,rl())}else if(n===s.DASH_DBX_HOST){const t=undefined;Kr(n,e,dl())}else n===s.DOCSEND_HOST?Ms(e):n===s.UNSUPPORTED_HOST&&dn()}hn();const ul=al();fn(`Reading [Pre-configured] baseChatConfigs: ${JSON.stringify(ul)}`);const hl=undefined;cl({baseChatConfigs:ul})})(),n})()));
})();
//# debugId=99f24cc9-483d-3623-8eca-bddc892dd80e
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="0db1c998-f1f1-3780-be60-b0454ad70eec")}catch(e){}}();
define(["exports","react","./c_core_i18n","./c_api-v2-client_src_dropbox","./e_file_viewer_static_scl_page_file","react-dom","./c_utils_dsx_dsx-react","./c_dotlottie_common_chunk-B7OIQIGJ","./c_api_v2_unauthed_client","./c_react_query_helpers_queries_login_and_register_constants"],(function(e,t,a,n,r,o,i,s,_,d){"use strict";function c(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var l=c(t),u=c(o);const E=(...e)=>{},A=r.SHARE_ACTION_ORIGIN_TYPE.SHARING_SDK_SANDBOX,S=(...e)=>(...t)=>{e.forEach((e=>{try{e(...t)}catch(e){}}))},m=l.createContext({sink:E,metadata:{},origin:A,actionInfo:void 0}),p=({sink:e,children:t,origin:a,actionInfo:n})=>{const r=l.useMemo((()=>({sink:e,metadata:{},origin:a,actionInfo:n})),[e,a,n]);return l.createElement(m.Provider,{value:r},t)};p.displayName="Provider";const g=()=>{const e=l.useContext(m);return l.useCallback(((t,a)=>{const n={type:t,payload:a};e.sink(n,e.metadata,e.origin,e.actionInfo)}),[e])},h=({children:e,...t})=>{const a=l.useContext(m),[n]=l.useState({sink:a.sink,metadata:{},origin:a.origin,actionInfo:a.actionInfo});return n.metadata={...a.metadata,...t},l.createElement(m.Provider,{value:n},e)};var v;h.displayName="MetadataProvider",e.Platforms=void 0,(v=e.Platforms||(e.Platforms={})).SANDBOX="SANDBOX",v.METASERVER="METASERVER",v.PAPER="PAPER",v.DESKTOP="DESKTOP",v.MS_TEAMS="MS_TEAMS",v.MS_TEAMS_MOBILE="MS_TEAMS_MOBILE";const f=l.createContext(e.Platforms.SANDBOX),T=({platform:e,children:t})=>l.createElement(f.Provider,{value:e},t);T.displayName="Provider";const R=()=>l.useContext(f),I=l.createContext(new n.Dropbox({})),L=({sdk:e,children:t})=>l.createElement(I.Provider,{value:e},t);L.displayName="DropboxSdkProvider";const C=e=>{const t=l.useContext(I),a=g();if("standard"===e.type){const n=l.useMemo((()=>e.fetch(t)),[e,t]);return l.useCallback((async t=>{const r=Math.random().toString();a("ENDPOINT_FETCH_BEGIN",{name:e.name,input:t,id:r});const o=Date.now(),i=await n(t),s=Date.now();return a("ENDPOINT_FETCH_END",{name:e.name,id:r,latency:s-o,response:i}),i}),[n,e,a])}{const t=e.useFetch();return l.useCallback((async n=>{const r=Math.random().toString();a("ENDPOINT_FETCH_BEGIN",{name:e.name,input:n,id:r});const o=Date.now(),i=await t(n),s=Date.now();return a("ENDPOINT_FETCH_END",{name:e.name,id:r,latency:s-o,response:i}),i}),[t,e,a])}};var b;e.Status=void 0,(b=e.Status||(e.Status={})).SUCCESS="SUCCESS",b.ERROR="ERROR",b.FATAL="FATAL";const M=r.isObjectOf({status:r.isNumber,headers:r.isUnknown,error:r.isObjectOf({error:r.isObjectOf({".tag":r.isString})})}),N=r.isObjectOf({status:r.isNumber}),O=async t=>{try{const a=await t;return{status:e.Status.SUCCESS,output:a.result}}catch(t){const a=t;return M(a)?{status:e.Status.ERROR,error:a.error.error,statusCode:a.status}:N(t)?{status:e.Status.FATAL,statusCode:t.status,error:t}:{status:e.Status.FATAL,error:t}}},y=(e,t)=>({name:e.name,fetch:t,type:"standard"});var k;function D(){return D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},D.apply(this,arguments)}!function(e){e.INSTALL_DESKTOP="install_desktop_module",e.INSTALL_MOBILE="install_mobile_module",e.UPLOAD_FILES="upload_content_module",e.SHARE_FILES="share_content_module"}(k||(k={})),e.ActivationTileMilestoneId=void 0,(e.ActivationTileMilestoneId||(e.ActivationTileMilestoneId={})).SHARE_CONTENT="share_content_milestone";var P="data-focus-lock",F="data-focus-lock-disabled",w={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},H=r.createMedium({},(function(e){return{target:e.target,currentTarget:e.currentTarget}})),x=r.createMedium(),G=r.createMedium(),U=r.createSidecarMedium({async:!0}),V=[],B=l.forwardRef((function(e,a){var n,o=l.useState(),i=o[0],s=o[1],_=l.useRef(),d=l.useRef(!1),c=l.useRef(null),u=e.children,E=e.disabled,A=e.noFocusGuards,S=e.persistentFocus,m=e.crossFrame,p=e.autoFocus;e.allowTextSelection;var g=e.group,h=e.className,v=e.whiteList,f=e.hasPositiveIndices,T=e.shards,R=void 0===T?V:T,I=e.as,L=void 0===I?"div":I,C=e.lockProps,b=void 0===C?{}:C,M=e.sideCar,N=e.returnFocus,O=e.focusOptions,y=e.onActivation,k=e.onDeactivation,G=l.useState({})[0],B=l.useCallback((function(){c.current=c.current||document&&document.activeElement,_.current&&y&&y(_.current),d.current=!0}),[y]),K=l.useCallback((function(){d.current=!1,k&&k(_.current)}),[k]);t.useEffect((function(){E||(c.current=null)}),[]);var j=l.useCallback((function(e){var t=c.current;if(t&&t.focus){var a="function"==typeof N?N(t):N;if(a){var n="object"==typeof a?a:void 0;c.current=null,e?Promise.resolve().then((function(){return t.focus(n)})):t.focus(n)}}}),[N]),W=l.useCallback((function(e){d.current&&H.useMedium(e)}),[]),$=x.useMedium,q=l.useCallback((function(e){_.current!==e&&(_.current=e,s(e))}),[]),Y=D(((n={})[F]=E&&"disabled",n[P]=g,n),b),Q=!0!==A,z=Q&&"tail"!==A,X=r.useMergeRefs([a,q]);return l.createElement(l.Fragment,null,Q&&[l.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:E?-1:0,style:w}),f?l.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:E?-1:1,style:w}):null],!E&&l.createElement(M,{id:G,sideCar:U,observed:i,disabled:E,persistentFocus:S,crossFrame:m,autoFocus:p,whiteList:v,shards:R,onActivation:B,onDeactivation:K,returnFocus:j,focusOptions:O}),l.createElement(L,D({ref:X},Y,{className:h,onBlur:$,onFocus:W}),u),z&&l.createElement("div",{"data-focus-guard":!0,tabIndex:E?-1:0,style:w}))}));B.propTypes={},B.defaultProps={children:void 0,disabled:!1,returnFocus:!1,focusOptions:void 0,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,hasPositiveIndices:void 0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};var K=B;function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function $(e){var t=function(e,t){if("object"!==W(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===W(t)?t:String(t)}var q=function(e){for(var t=Array(e.length),a=0;a<e.length;++a)t[a]=e[a];return t},Y=function(e){return Array.isArray(e)?e:[e]},Q=function(e){return Array.isArray(e)?e[0]:e},z=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},X=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},J=function(e,t){return!e||X(e)||!function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var t=window.getComputedStyle(e,null);return!(!t||!t.getPropertyValue||"none"!==t.getPropertyValue("display")&&"hidden"!==t.getPropertyValue("visibility"))}(e)&&t(z(e))},Z=function e(t,a){var n=t.get(a);if(void 0!==n)return n;var r=J(a,e.bind(void 0,t));return t.set(a,r),r},ee=function e(t,a){var n=t.get(a);if(void 0!==n)return n;var r=function(e,t){return!(e&&!X(e))||!!re(e)&&t(z(e))}(a,e.bind(void 0,t));return t.set(a,r),r},te=function(e){return e.dataset},ae=function(e){return"INPUT"===e.tagName},ne=function(e){return ae(e)&&"radio"===e.type},re=function(e){var t=e.getAttribute("data-no-autofocus");return![!0,"true",""].includes(t)},oe=function(e){var t;return Boolean(e&&(null===(t=te(e))||void 0===t?void 0:t.focusGuard))},ie=function(e){return!oe(e)},se=function(e){return Boolean(e)},_e=function(e,t){var a=e.tabIndex-t.tabIndex,n=e.index-t.index;if(a){if(!e.tabIndex)return 1;if(!t.tabIndex)return-1}return a||n},de=function(e,t,a){return q(e).map((function(e,t){return{node:e,index:t,tabIndex:a&&-1===e.tabIndex?(e.dataset||{}).focusGuard?0:-1:e.tabIndex}})).filter((function(e){return!t||e.tabIndex>=0})).sort(_e)},ce=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"].join(","),le="".concat(ce,", [data-focus-guard]"),ue=function e(t,a){return q((t.shadowRoot||t).children).reduce((function(t,n){return t.concat(n.matches(a?le:ce)?[n]:[],e(n))}),[])},Ee=function(e,t){var a;return e instanceof HTMLIFrameElement&&(null===(a=e.contentDocument)||void 0===a?void 0:a.body)?Ae([e.contentDocument.body],t):[e]},Ae=function(e,t){return e.reduce((function(e,a){var n,r=ue(a,t),o=(n=[]).concat.apply(n,r.map((function(e){return Ee(e,t)})));return e.concat(o,a.parentNode?q(a.parentNode.querySelectorAll(ce)).filter((function(e){return e===a})):[])}),[])},Se=function(e,t){return q(e).filter((function(e){return Z(t,e)})).filter((function(e){return function(e){return!((ae(e)||function(e){return"BUTTON"===e.tagName}(e))&&("hidden"===e.type||e.disabled))}(e)}))},me=function(e,t){return void 0===t&&(t=new Map),q(e).filter((function(e){return ee(t,e)}))},pe=function(e,t,a){return de(Se(Ae(e,a),t),!0,a)},ge=function(e,t){return de(Se(Ae(e),t),!1)},he=function(e,t){return Se((a=e.querySelectorAll("[".concat("data-autofocus-inside","]")),q(a).map((function(e){return Ae([e])})).reduce((function(e,t){return e.concat(t)}),[])),t);var a},ve=function e(t,a){return t.shadowRoot?e(t.shadowRoot,a):!(void 0===Object.getPrototypeOf(t).contains||!Object.getPrototypeOf(t).contains.call(t,a))||q(t.children).some((function(t){var n;if(t instanceof HTMLIFrameElement){var r=null===(n=t.contentDocument)||void 0===n?void 0:n.body;return!!r&&e(r,a)}return e(t,a)}))},fe=function e(t){return t.parentNode?e(t.parentNode):t},Te=function(e){return Y(e).filter(Boolean).reduce((function(e,t){var a=t.getAttribute(P);return e.push.apply(e,a?function(e){for(var t=new Set,a=e.length,n=0;n<a;n+=1)for(var r=n+1;r<a;r+=1){var o=e[n].compareDocumentPosition(e[r]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(r),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(n)}return e.filter((function(e,a){return!t.has(a)}))}(q(fe(t).querySelectorAll("[".concat(P,'="').concat(a,'"]:not([').concat(F,'="disabled"])')))):[t]),e}),[])},Re=function e(t){if(void 0===t&&(t=document),t&&t.activeElement){var a=t.activeElement;return a.shadowRoot?e(a.shadowRoot):a instanceof HTMLIFrameElement&&function(e){try{return e()}catch(e){return}}((function(){return a.contentWindow.document}))?e(a.contentWindow.document):a}},Ie=function(e,t){return void 0===t&&(t=Re(Q(e).ownerDocument)),!(!t||t.dataset&&t.dataset.focusGuard)&&Te(e).some((function(e){return ve(e,t)||function(e,t){return Boolean(q(e.querySelectorAll("iframe")).some((function(e){return function(e,t){return e===t}(e,t)})))}(e,t)}))},Le=function(e,t){return ne(e)&&e.name?function(e,t){return t.filter(ne).filter((function(t){return t.name===e.name})).filter((function(e){return e.checked}))[0]||e}(e,t):e},Ce=function(e){return e[0]&&e.length>1?Le(e[0],e):e[0]},be=function(e,t){return e.length>1?e.indexOf(Le(e[t],e)):t},Me="NEW_FOCUS",Ne=function(e,t,a,n){var r=e.length,o=e[0],i=e[r-1],s=oe(a);if(!(a&&e.indexOf(a)>=0)){var _,d,c=void 0!==a?t.indexOf(a):-1,l=n?t.indexOf(n):c,u=n?e.indexOf(n):-1,E=c-l,A=t.indexOf(o),S=t.indexOf(i),m=(_=t,d=new Set,_.forEach((function(e){return d.add(Le(e,_))})),_.filter((function(e){return d.has(e)}))),p=(void 0!==a?m.indexOf(a):-1)-(n?m.indexOf(n):c),g=be(e,0),h=be(e,r-1);return-1===c||-1===u?Me:!E&&u>=0?u:c<=A&&s&&Math.abs(E)>1?h:c>=S&&s&&Math.abs(E)>1?g:E&&Math.abs(p)>1?u:c<=A?h:c>S?g:E?Math.abs(E)>1?u:(r+u+E)%r:void 0}},Oe=function(e,t,a){var n,r=e.map((function(e){return e.node})),o=me(r.filter((n=a,function(e){var t,a=null===(t=te(e))||void 0===t?void 0:t.autofocus;return e.autofocus||void 0!==a&&"false"!==a||n.indexOf(e)>=0})));return o&&o.length?Ce(o):Ce(me(t))},ye=function e(t,a){return void 0===a&&(a=[]),a.push(t),t.parentNode&&e(t.parentNode.host||t.parentNode,a),a},ke=function(e,t){for(var a=ye(e),n=ye(t),r=0;r<a.length;r+=1){var o=a[r];if(n.indexOf(o)>=0)return o}return!1},De=function(e,t,a){var n=Y(e),r=Y(t),o=n[0],i=!1;return r.filter(Boolean).forEach((function(e){i=ke(i||e,e)||i,a.filter(Boolean).forEach((function(e){var t=ke(o,e);t&&(i=!i||ve(t,i)?t:ke(t,i))}))})),i},Pe=function(e,t){var a=Re(Y(e).length>0?document:Q(e).ownerDocument),n=Te(e).filter(ie),r=De(a||e,e,n),o=new Map,i=ge(n,o),s=pe(n,o).filter((function(e){var t=e.node;return ie(t)}));if(s[0]||(s=i)[0]){var _,d,c,l=ge([r],o).map((function(e){return e.node})),u=(_=l,d=s,c=new Map,d.forEach((function(e){return c.set(e.node,e)})),_.map((function(e){return c.get(e)})).filter(se)),E=u.map((function(e){return e.node})),A=Ne(E,l,a,t);if(A===Me){var S=Oe(i,E,function(e,t){return e.reduce((function(e,a){return e.concat(he(a,t))}),[])}(n,o));return S?{node:S}:void console.warn("focus-lock: cannot find any node to move focus into")}return void 0===A?A:u[A]}},Fe=0,we=!1,He=function(e,t,a){void 0===a&&(a={});var n,r,o=Pe(e,t);if(!we&&o){if(Fe>2)return console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),we=!0,void setTimeout((function(){we=!1}),1);Fe++,n=o.node,r=a.focusOptions,"focus"in n&&n.focus(r),"contentWindow"in n&&n.contentWindow&&n.contentWindow.focus(),Fe--}};function xe(e){setTimeout(e,1)}var Ge=function(){return document&&document.activeElement===document.body||function(e){void 0===e&&(e=document);var t=Re(e);return!!t&&q(e.querySelectorAll("[".concat("data-no-focus-lock","]"))).some((function(e){return ve(e,t)}))}()},Ue=null,Ve=null,Be=null,Ke=!1,je=function(){return!0};function We(e,t,a,n){var r=null,o=e;do{var i=n[o];if(i.guard)i.node.dataset.focusAutoGuard&&(r=i);else{if(!i.lockItem)break;if(o!==e)return;r=null}}while((o+=a)!==t);r&&(r.node.tabIndex=0)}var $e=function(e){return e&&"current"in e?e.current:e},qe=function e(t,a,n){return a&&(a.host===t&&(!a.activeElement||n.contains(a.activeElement))||a.parentNode&&e(t,a.parentNode,n))},Ye=function(){var e,t,a,n,r,o,i,s=!1;if(Ue){var _=Ue,d=_.observed,c=_.persistentFocus,l=_.autoFocus,u=_.shards,E=_.crossFrame,A=_.focusOptions,S=d||Be&&Be.portaledElement,m=document&&document.activeElement;if(S){var p=[S].concat(u.map($e).filter(Boolean));if(m&&!function(e){return(Ue.whiteList||je)(e)}(m)||(c||(E?Boolean(Ke):"meanwhile"===Ke)||!Ge()||!Ve&&l)&&(S&&!(Ie(p)||m&&function(e,t){return t.some((function(t){return qe(e,t,t)}))}(m,p)||(i=m,Be&&Be.portaledElement===i))&&(document&&!Ve&&m&&!l?(m.blur&&m.blur(),document.body.focus()):(s=He(p,Ve,{focusOptions:A}),Be={})),Ke=!1,Ve=document&&document.activeElement),document){var g=document&&document.activeElement,h=(t=Te(e=p).filter(ie),a=De(e,e,t),n=new Map,r=pe([a],n,!0),o=pe(t,n).filter((function(e){var t=e.node;return ie(t)})).map((function(e){return e.node})),r.map((function(e){var t=e.node;return{node:t,index:e.index,lockItem:o.indexOf(t)>=0,guard:oe(t)}}))),v=h.map((function(e){return e.node})).indexOf(g);v>-1&&(h.filter((function(e){var t=e.guard,a=e.node;return t&&a.dataset.focusAutoGuard})).forEach((function(e){return e.node.removeAttribute("tabIndex")})),We(v,h.length,1,h),We(v,-1,-1,h))}}}return s},Qe=function(e){Ye()&&e&&(e.stopPropagation(),e.preventDefault())},ze=function(){return xe(Ye)},Xe=function(){Ke="just",xe((function(){Ke="meanwhile"}))};H.assignSyncMedium((function(e){var t=e.target,a=e.currentTarget;a.contains(t)||(Be={observerNode:a,portaledElement:t})})),x.assignMedium(ze),G.assignMedium((function(e){return e({moveFocusInside:He,focusInside:Ie})}));var Je=function(e,a){return function(n){var r,o=[];function i(){r=e(o.map((function(e){return e.props}))),a(r)}var s,_,d,c=function(e){var t,a;function s(){return e.apply(this,arguments)||this}a=e,(t=s).prototype=Object.create(a.prototype),t.prototype.constructor=t,j(t,a),s.peek=function(){return r};var _=s.prototype;return _.componentDidMount=function(){o.push(this),i()},_.componentDidUpdate=function(){i()},_.componentWillUnmount=function(){var e=o.indexOf(this);o.splice(e,1),i()},_.render=function(){return l.default.createElement(n,this.props)},s}(t.PureComponent);return s=c,_="displayName",d="SideEffect("+function(e){return e.displayName||e.name||"Component"}(n)+")",(_=$(_))in s?Object.defineProperty(s,_,{value:d,enumerable:!0,configurable:!0,writable:!0}):s[_]=d,c}}((function(e){return e.filter((function(e){return!e.disabled}))}),(function(e){var t=e.slice(-1)[0];t&&!Ue&&(document.addEventListener("focusin",Qe),document.addEventListener("focusout",ze),window.addEventListener("blur",Xe));var a=Ue,n=a&&t&&t.id===a.id;Ue=t,a&&!n&&(a.onDeactivation(),e.filter((function(e){return e.id===a.id})).length||a.returnFocus(!t)),t?(Ve=null,n&&a.observed===t.observed||t.onActivation(),Ye(),xe(Ye)):(document.removeEventListener("focusin",Qe),document.removeEventListener("focusout",ze),window.removeEventListener("blur",Xe),Ve=null)}))((function(){return null})),Ze=l.forwardRef((function(e,t){return l.createElement(K,D({sideCar:Je,ref:t},e))})),et=K.propTypes||{};et.sideCar,function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a])}(et,["sideCar"]),Ze.propTypes={};var tt=Ze;function at(e){const t=window.document.createElement("a");t.href=e;let a=t.protocol||window.location.protocol;":"===t.protocol&&(a=window.location.protocol);const n=t.hostname||window.location.hostname;let r=t.port||window.location.port;"443"===r&&"https:"===a&&(r="");let o=n;return r&&(o=o+":"+r),a+"//"+o+(0===t.pathname.indexOf("/")?t.pathname:`/${t.pathname}`)+t.search+t.hash}const nt=e=>window.open(e,"_blank"),rt=l.createContext(nt),ot=({openUrl:e,children:t})=>l.createElement(rt.Provider,{value:e},t);ot.displayName="Provider";const it=()=>{const e=l.useContext(rt);return l.useCallback((t=>{e(t)}),[e])},st=e=>e.formatMessage({id:"0NA7+K",defaultMessage:"Close"}),_t=l.createContext({store:{$item:i.store(null),$props:i.store({})}}),dt=()=>{const{store:e}=l.useContext(_t),t=l.useRef(null);return a=>{const n=Math.random().toString();return e.$item.set({key:n,Snackbar:a,snackbarRef:t}),requestAnimationFrame((()=>{var a,n;null===(n=(a=e.$props.get()).onSnackbarShownChange)||void 0===n||n.call(a,!0,t)})),()=>{const t=e.$item.get();t&&t.key===n&&e.$item.set(null)}}},ct=()=>{const{store:e}=l.useContext(_t),t=i.useStore(e.$item),a=(e=>{const{store:t}=l.useContext(_t);return l.useCallback((()=>{const a=t.$item.get();a&&a.key===e&&(t.$item.set(null),requestAnimationFrame((()=>{var e,a;null===(a=(e=t.$props.get()).onSnackbarShownChange)||void 0===a||a.call(e,!1)})))}),[t,e])})(t?t.key:"");return t?u.createPortal(l.createElement("div",{ref:t.snackbarRef,key:t.key,style:{position:"fixed",display:"flex",zIndex:2e4,width:"100%",bottom:"1em",justifyContent:"center"},"data-sharing-sdk":"1"},l.createElement(t.Snackbar,{style:{flexGrow:1},key:t.key,open:!0,onRequestClose:a})),document.body):null},lt=({children:e,onSnackbarShownChange:t})=>{const a=i.useInitStore({onSnackbarShownChange:t},(e=>({$item:i.store(null),$props:e}))),n=l.useMemo((()=>({store:a})),[a]);return l.createElement(_t.Provider,{value:n},l.createElement(l.Fragment,null,e,l.createElement(ct,null)))};lt.displayName="Provider";const ut=l.createContext({redirectWindowToken:null}),Et=({children:e,...t})=>{const a=l.useMemo((()=>({redirectWindowToken:t.redirectWindowToken})),[t.redirectWindowToken]);return l.createElement(ut.Provider,{value:a},e)};Et.displayName="Provider",a.createIntl({locale:"en"});const At=({children:e,intl:t})=>t?l.createElement(a.Provider,{value:t},e):e;At.displayName="Provider";const St=y({name:"sharing_receiving.SharingTiburonLogger"},(e=>t=>{const a={...t,extras:pt(gt(JSON.stringify(t.extras)))};return O(e.sharingReceivingSharingTiburonLogger(a))})),mt=e=>e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65,pt=e=>{let t=2,a="";const n=e.length;let r=0;for(let o=0;o<n;o++)t=o%3,o>0&&4*o/3%76==0&&(a+="\r\n"),r|=e[o]<<(16>>>t&24),2!==t&&e.length-o!=1||(a+=String.fromCodePoint(mt(r>>>18&63),mt(r>>>12&63),mt(r>>>6&63),mt(63&r)),r=0);return a.substr(0,a.length-2+t)+(2===t?"":1===t?"=":"==")},gt=e=>{let t;const a=e.length;let n=0;for(let r=0;r<a;r++)t=e.codePointAt(r),t>65536&&r++,n+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;const r=new Uint8Array(n);let o=0,i=0;for(;o<n;)t=e.codePointAt(i),t<128?r[o++]=t:t<2048?(r[o++]=192+(t>>>6),r[o++]=128+(63&t)):t<65536?(r[o++]=224+(t>>>12),r[o++]=128+(t>>>6&63),r[o++]=128+(63&t)):t<2097152?(r[o++]=240+(t>>>18),r[o++]=128+(t>>>12&63),r[o++]=128+(t>>>6&63),r[o++]=128+(63&t),i++):t<67108864?(r[o++]=248+(t>>>24),r[o++]=128+(t>>>18&63),r[o++]=128+(t>>>12&63),r[o++]=128+(t>>>6&63),r[o++]=128+(63&t),i++):(r[o++]=252+(t>>>30),r[o++]=128+(t>>>24&63),r[o++]=128+(t>>>18&63),r[o++]=128+(t>>>12&63),r[o++]=128+(t>>>6&63),r[o++]=128+(63&t),i++),i++;return r},ht=e=>{if(r.getAccessType(e))switch(r.getAccessType(e)){case"owner":return"owner";case"editor":return"writer";default:return"reader"}},vt=e=>({user_access_type:ht(e),is_folder:r.getIsFolder(e),fq_path:r.isNewApiMetadata(e)?e.common_metadata.path_lower:e.path_lower,content_id:r.isNewApiMetadata(e)?r.getIsFile(e)?e.common_metadata.file_id:r.getIsSharedFolder(e)?r.getSharedFolderId(e):r.getIsFolder(e)?e.common_metadata.path_lower:e.common_metadata.file_id:r.getIsFile(e)?e.id:r.getIsSharedFolder(e)?e.shared_folder_id:r.getIsFolder(e)?e.path_lower:r.getIsCollection(e)?e.collectionId:"",...{...r.getIsSharedFolder(e)||r.getIsCollection(e)?{ns_id:r.getSharedFolderId(e)}:{}},can_create_edit_link:r.getCanDoAction(e,r.CREATE_EDIT_LINK_TAG),can_create_view_link:r.getCanDoAction(e,r.CREATE_VIEW_LINK_TAG),can_edit_inband_invite:r.getCanDoAction(e,r.INVITE_EDITOR_TAG),can_view_inband_invite:r.getCanDoAction(e,r.INVITE_VIEWER_TAG),max_access:r.getCanDoAction(e,r.CREATE_EDIT_LINK_TAG)||r.getCanDoAction(e,r.INVITE_EDITOR_TAG)?"editor":"viewer"}),ft=e=>e&&"other"!==e[".tag"]?"viewer"===e[".tag"]?"reader":"writer":null,Tt=e=>{const t={link_id:e.id,link_access_level:(a=e.link_permissions.link_access_level,a?a[".tag"]:r.VIEWER[".tag"]),audience:r.getCurrentAudience(e)[".tag"]};var a;const n=(e=>{const t=new URL(e);if(t.search.includes("rlkey"))return{kind:"rlkey",val:t.searchParams.get("rlkey"),link_type:"righteous"};if(t.pathname.includes("/s/")||t.pathname.includes("/sh/")){const e=e=>e.pathname.includes("/raw/")||e.pathname.includes("/dl/")||e.pathname.includes("/print/"),a=e(t)?3:2;return{kind:"tkey",val:t.pathname.split("/")[a],link_type:"shmodel"}}return null})(e.url);return n&&(t[n.kind]=n.val,t.link_type=n.link_type),t},Rt=e=>{const t={tray_style:e.loggingExtras.tray_style,tray_variants:e.loggingExtras.variants};return{platform_name:e.platformName,platform_version:e.platformVersion,build_channel:e.buildChannel,build_number:e.buildNumber,...t}},It=(e,t,a,n)=>{const o=t.shareModalSessionId,i=t.sharingObjectMetadata,s=t.desktopMetadata;return o&&(n={...n,modal_session_id:o}),t.sharingObjectIdentifier&&("file"===t.sharingObjectIdentifier[".tag"]?n={...n,file_id:t.sharingObjectIdentifier.fileId}:"shared_folder"===t.sharingObjectIdentifier[".tag"]?n={...n,ns_id:t.sharingObjectIdentifier.sharedFolderId}:"file_folder"===t.sharingObjectIdentifier[".tag"]?n={...n,fq_path:t.sharingObjectIdentifier.path}:"collection"===t.sharingObjectIdentifier[".tag"]&&(n={...n,ns_id:t.sharingObjectIdentifier.nsId,collection_id:t.sharingObjectIdentifier.collectionId})),i&&!r.isNewApiMetadata(i)&&i.path_lower&&(n={...n,fq_path:i.path_lower}),i&&r.isNewApiMetadata(i)&&i.common_metadata.path_lower&&(n={...n,fq_path:i.common_metadata.path_lower}),i&&!r.isNewApiMetadata(i)&&r.getIsFile(i)&&(n={...n,file_id:i.id}),i&&r.isNewApiMetadata(i)&&r.getIsFile(i)&&(n={...n,file_id:i.common_metadata.file_id}),i&&!r.isNewApiMetadata(i)&&r.getIsSharedFolder(i)&&(n={...n,ns_id:i.shared_folder_id}),i&&r.isNewApiMetadata(i)&&r.getIsSharedFolder(i)&&(n={...n,ns_id:i.metadata_response&&"shared_folder_id"in i.metadata_response?i.metadata_response.shared_folder_id:""}),i&&r.getIsCollection(i)&&(n={...n,ns_id:i.shared_folder_id,collection_id:i.collectionId}),s&&(n={...n,...Rt(s)}),{share_tiburon_event_type:e,share_tib_action_origin_type:a,extras:n}},Lt=(e,t,a,n)=>{const r=t.shareModalSessionId,o=t.sharingLinkMetadata,i=t.sharingObjectMetadata,s=t.desktopMetadata;return r&&(n={...n,modal_session_id:r}),o&&(n={...n,...Tt(o)}),i&&(n={...n,...vt(i)}),s&&(n={...n,...Rt(s)}),t.sharingObjectIdentifier&&("file"===t.sharingObjectIdentifier[".tag"]?n={...n,file_id:t.sharingObjectIdentifier.fileId}:"shared_folder"===t.sharingObjectIdentifier[".tag"]?n={...n,ns_id:t.sharingObjectIdentifier.sharedFolderId}:"file_folder"===t.sharingObjectIdentifier[".tag"]?n={...n,fq_path:t.sharingObjectIdentifier.path}:"collection"===t.sharingObjectIdentifier[".tag"]&&(n={...n,ns_id:t.sharingObjectIdentifier.nsId,collection_id:t.sharingObjectIdentifier.collectionId})),{share_tiburon_event_type:e,share_tib_action_origin_type:a,extras:n}},Ct=(e,t)=>{let a={is_alpha:!0};return t.sharingAccessLevel&&(a={...a,access:t.sharingAccessLevel[".tag"]}),e.createSharedLinkStartTime&&(a={...a,timing:Date.now()-e.createSharedLinkStartTime}),a={...a,include_ns_creation:!1},a},bt=e=>{if(e.shareMe24Metadata){if(e.shareMe24Metadata.shouldStyleForSM21)return r.ScreenName.ManageAccessScreen;if(e.shareMe24Metadata.isShareMe24)return r.ScreenName.ShareMe24ShareScreen}return r.ScreenName.ShareScreen},Mt=()=>{const t=(()=>{const t=C(St);return l.useMemo((()=>({SHARE_MODAL_SHARE__PREVALIDATION__API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptTargetValidation,e,n,a))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptTargetValidation,e,n,a))},SHARE_MODAL_SHARE__PREVALIDATION__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedTargetValidation,e,n,a))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedTargetValidation,e,n,a))},SHARE_MODAL_SHARE__PREVALIDATION__API_ERROR:({event:e,metadata:a,extras:n,origin:o})=>{t(It(r.TiburonEventName.FailTargetValidation,a,o,{...n,error:e.payload.error[".tag"]}))},SHARE_MODAL_SHARE__PREVALIDATION__API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailTargetValidation,e,n,{...a,error:"unknown server error"}))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_ERROR:({event:e,metadata:a,extras:n,origin:o})=>{t(It(r.TiburonEventName.FailTargetValidation,a,o,{...n,error:e.payload.error[".tag"]}))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailTargetValidation,e,n,{...a,error:"unknown server error"}))},SHARE_MODAL_MANAGE_ACCESS__MANAGE_ACCESS__CLICK:({metadata:e,extras:a,origin:n})=>{e.sharingObjectMembership&&(a={...a,access_level:e.sharingObjectMembership.access_type[".tag"]}),t(It(r.TiburonEventName.ClickManageAccess,e,n,a))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_MEMBER_ACCESS__CLICK:({event:e,metadata:a,extras:n,origin:o})=>{t(It(r.TiburonEventName.SelectChangeMemberPermission,a,o,{...n,new_access:"editor"===e.payload.next[".tag"]?"writer":"reader",old_access:"editor"===e.payload.previous[".tag"]?"writer":"reader"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedChangeMemberPermission,e,n,{...a,http_status_code:200,response_status:"success",is_alpha:!1}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedChangeMemberPermission,e,n,{...a,http_status_code:200,response_status:"success",is_alpha:!1}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailChangeMemberPermission,e,n,{...a,is_alpha:!1,http_status_code:0,error_tag:"undefined"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_ERROR:({event:e,metadata:a,extras:n,origin:o})=>{t(It(r.TiburonEventName.FailChangeMemberPermission,a,o,{...n,is_alpha:!1,http_status_code:e.payload.response.statusCode,error_tag:e.payload.response.error[".tag"]}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailChangeMemberPermission,e,n,{...a,is_alpha:!1,http_status_code:0,error_tag:"undefined"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_ERROR:({event:e,metadata:a,extras:n,origin:o})=>{t(It(r.TiburonEventName.FailChangeMemberPermission,a,o,{...n,is_alpha:!1,http_status_code:e.payload.response.statusCode,error_tag:e.payload.response.error[".tag"]}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_ERROR:({event:e,metadata:a,extras:n,origin:o})=>{t(It(r.TiburonEventName.FailTransferFolder,a,o,{...n,is_alpha:!1,http_status_code:e.payload.response.statusCode,error_tag:e.payload.response.error[".tag"]}))},SHARE_MODAL_SHARE__CREATE_LINK__API_START:({metadata:e,extras:a,origin:n,cache:o})=>{e.sharingAccessLevel&&(a={...a,access:e.sharingAccessLevel[".tag"]}),o.createSharedLinkStartTime=Date.now(),t(It(r.TiburonEventName.AttemptCreateSharedLinkWithSettings,e,n,a))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_START:({metadata:e,extras:a,origin:n,cache:o})=>{e.sharingAccessLevel&&(a={...a,access:e.sharingAccessLevel[".tag"]}),o.createSharedLinkStartTime=Date.now(),t(It(r.TiburonEventName.AttemptCreateSharedLinkWithSettings,e,n,a))},SHARE_MODAL_SHARE__CREATE_LINK__API_SUCCESS:({metadata:e,event:a,origin:n,extras:o,cache:i})=>{(e={...e,sharingLinkMetadata:a.payload.response.output}).sharingLinkMetadata&&(o={...o,...Tt(e.sharingLinkMetadata)}),t(It(r.TiburonEventName.SucceedCreateSharedLinkWithSettings,e,n,{http_status_Code:200,response_status:"success",...Ct(i,e),...o}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_SUCCESS:({metadata:e,event:a,origin:n,extras:o,cache:i})=>{(e={...e,sharingLinkMetadata:a.payload.response.output}).sharingLinkMetadata&&(o={...o,...Tt(e.sharingLinkMetadata)}),t(It(r.TiburonEventName.SucceedCreateSharedLinkWithSettings,e,n,{http_status_Code:200,response_status:"success",...Ct(i,e),...o}))},SHARE_MODAL_SHARE__CREATE_LINK__API_ERROR:({metadata:e,event:a,extras:n,origin:o,cache:i})=>{"shared_link_already_exists"!==a.payload.response.error[".tag"]?t(It(r.TiburonEventName.FailCreateSharedLinkWithSettings,e,o,{error_tag:a.payload.response.error[".tag"],http_status_code:a.payload.response.statusCode,fail_at:"link_creation",...Ct(i,e),...n})):t(It(r.TiburonEventName.SucceedCreateSharedLinkWithSettings,e,o,{http_status_code:a.payload.response.statusCode,response_status:"success",...Ct(i,e),...n}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_ERROR:({metadata:e,extras:a,cache:n,origin:o,event:i})=>{"shared_link_already_exists"!==i.payload.response.error[".tag"]?t(It(r.TiburonEventName.FailCreateSharedLinkWithSettings,e,o,{error_tag:i.payload.response.error[".tag"],http_status_code:i.payload.response.statusCode,fail_at:"link_creation",...Ct(n,e),...a})):t(It(r.TiburonEventName.SucceedCreateSharedLinkWithSettings,e,o,{http_status_code:i.payload.response.statusCode,response_status:"success",...Ct(n,e),...a}))},SHARE_MODAL_SHARE__CREATE_LINK__API_FATAL:({metadata:e,extras:a,origin:n,cache:o})=>{t(It(r.TiburonEventName.FailCreateSharedLinkWithSettings,e,n,{fail_at:"link_creation",...Ct(o,e),http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_FATAL:({metadata:e,extras:a,origin:n,cache:o})=>{t(It(r.TiburonEventName.FailCreateSharedLinkWithSettings,e,n,{fail_at:"link_creation",...Ct(o,e),http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_SHARE__CREATE_LINK__CLICK:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.ClickTibCreateLink,e,n,a))},SHARE_MODAL_SETTINGS__CREATE_LINK__CLICK:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.ClickTibCreateLink,e,n,a))},SHARE_MODAL_SHARE__INVITE__START:({metadata:e,extras:a,origin:n,cache:o})=>{o.inviteStartTime=Date.now(),t(It(r.TiburonEventName.ClickInbandShareButton,e,n,{in_progress:!1,access_level:ft(e.sharingAccessLevel),screen:bt(e),...a}));const i=e.sharingLinkMetadata;i&&t(Lt(r.TiburonEventName.ClickShareButtonLinkSettingsStatus,e,n,{...a,isPasswordRequired:i.link_permissions.require_password||!1,isExpirationEnabled:!!i.expires,isDisabledDownloadEnabled:!i.link_permissions.allow_download}))},SHARE_MODAL_SHARE__COPY_LINK__CLICK:({metadata:e,extras:a,origin:n})=>{var o,i;t(Lt(r.TiburonEventName.CopySharedLink,e,n,{...a,tokenized_contact_count:null===(o=e.sharingInviteTargets)||void 0===o?void 0:o.length,sender_trackey:r.getSenderTrackeyFromURL(null===(i=e.sharingLinkMetadata)||void 0===i?void 0:i.url)}))},SHARE_MODAL_SHARE__COPY_LINK__COPY_SUCCESS:({metadata:e,event:a,extras:n,origin:o})=>{var i;e={...e,sharingLinkMetadata:a.payload.linkMetadata},t(Lt(r.TiburonEventName.CopySharedLink,e,o,{...n,sender_trackey:r.getSenderTrackeyFromURL(null===(i=e.sharingLinkMetadata)||void 0===i?void 0:i.url)}))},SHARE_MODAL_SETTINGS__COPY_LINK__COPY_SUCCESS:({metadata:e,event:a,extras:n,origin:o})=>{var i;e={...e,sharingLinkMetadata:a.payload.linkMetadata},t(Lt(r.TiburonEventName.CopySharedLink,e,o,{...n,sender_trackey:r.getSenderTrackeyFromURL(null===(i=e.sharingLinkMetadata)||void 0===i?void 0:i.url),screen:r.ScreenName.SettingsScreen}))},SHARE_MODAL_SHARE__COPY_LINK_LEGO__COPY_SUCCESS:({metadata:e,event:a,extras:n,origin:o})=>{var i;e={...e,sharingLinkMetadata:a.payload.linkMetadata},t(Lt(r.TiburonEventName.CopySharedLink,e,o,{...n,sender_trackey:r.getSenderTrackeyFromURL(null===(i=e.sharingLinkMetadata)||void 0===i?void 0:i.url)}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_START:({metadata:e,event:a,origin:n,extras:o})=>{var i,s;e={...e,sharingLinkMetadata:a.payload.linkMetadata},t(Lt(r.TiburonEventName.CopySharedLink,e,n,{...o,tokenized_contact_count:null===(i=e.sharingInviteTargets)||void 0===i?void 0:i.length,sender_trackey:r.getSenderTrackeyFromURL(null===(s=e.sharingLinkMetadata)||void 0===s?void 0:s.url)}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_ERROR:({metadata:e,extras:a,origin:n})=>{var o;t(Lt(r.TiburonEventName.CopySharedLinkFailure,e,n,{...a,tokenized_contact_count:null===(o=e.sharingInviteTargets)||void 0===o?void 0:o.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__COPY_LINK__COPY_ERROR:({metadata:e,extras:a,origin:n})=>{var o;t(Lt(r.TiburonEventName.CopySharedLinkFailure,e,n,{...a,tokenized_contact_count:null===(o=e.sharingInviteTargets)||void 0===o?void 0:o.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_FORBIDDEN:({metadata:e,extras:a,origin:n})=>{var o;t(Lt(r.TiburonEventName.CopySharedLinkFailure,e,n,{...a,tokenized_contact_count:null===(o=e.sharingInviteTargets)||void 0===o?void 0:o.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__COPY_LINK_LEGO__CREATE_ERROR:({metadata:e,extras:a,origin:n})=>{var o;t(Lt(r.TiburonEventName.CopySharedLinkFailure,e,n,{...a,tokenized_contact_count:null===(o=e.sharingInviteTargets)||void 0===o?void 0:o.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__COPY_LINK_LEGO__COPY_ERROR:({metadata:e,extras:a,origin:n})=>{var o;t(Lt(r.TiburonEventName.CopySharedLinkFailure,e,n,{...a,tokenized_contact_count:null===(o=e.sharingInviteTargets)||void 0===o?void 0:o.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__INVITE__CANCELLED:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailInbandShare,e,n,{error_tag:"contacts_error",error_message:"contact validation error",num_recipients:e.sharingInviteTargets?e.sharingInviteTargets.length:0,access_level:ft(e.sharingAccessLevel),screen:bt(e),...a}))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_ERROR:({metadata:e,extras:a,origin:n,cache:o,event:i})=>{o.inviteStartTime&&(a.timing=Date.now()-o.inviteStartTime),t(Lt(r.TiburonEventName.FailInbandShare,e,n,{...a,error_tag:i.payload.response.error[".tag"],http_status_code:i.payload.response.statusCode,num_recipients:e.sharingInviteTargets?e.sharingInviteTargets.length:0,screen:bt(e)}))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_FATAL:({metadata:e,extras:a,origin:n,cache:o})=>{o.inviteStartTime&&(a.timing=Date.now()-o.inviteStartTime),t(Lt(r.TiburonEventName.FailInbandShare,e,n,{...a,error_tag:"undefined",http_status_code:0,num_recipients:e.sharingInviteTargets?e.sharingInviteTargets.length:0,screen:bt(e)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_ERROR:({event:e,metadata:a,extras:n,origin:o,cache:i})=>{i.inviteStartTime&&(n={...n,timing:Date.now()-i.inviteStartTime}),t(Lt(r.TiburonEventName.FailInbandShare,a,o,{...n,error_tag:e.payload.response.error[".tag"],http_status_code:e.payload.response.statusCode,num_recipients:a.sharingInviteTargets?a.sharingInviteTargets.length:0,screen:bt(a)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_FATAL:({metadata:e,extras:a,origin:n,cache:o})=>{o.inviteStartTime&&(a={...a,timing:Date.now()-o.inviteStartTime}),t(Lt(r.TiburonEventName.FailInbandShare,e,n,{...a,error_tag:"undefined",http_status_code:0,num_recipients:e.sharingInviteTargets?e.sharingInviteTargets.length:0,screen:bt(e)}))},SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__FAILURE:({event:e,metadata:a,extras:n,origin:o,cache:i})=>{var s;i.inviteStartTime&&(n={...n,timing:Date.now()-i.inviteStartTime}),"ApiError"===e.payload.output.type||"PollingApiError"===e.payload.output.type?n={...n,error_tag:e.payload.output.value.response.error[".tag"],http_status_code:e.payload.output.value.response.statusCode}:"NetworkFailure"===e.payload.output.type||"PollingNetworkFailure"===e.payload.output.type?n={...n,error_tag:"network",http_status_code:null!==(s=e.payload.output.value.response.statusCode)&&void 0!==s?s:0}:"PollingFailed"===e.payload.output.type?n={...n,error_tag:"failed",http_status_code:0}:"PollingTimeout"===e.payload.output.type&&(n={...n,error_tag:"network",http_status_code:408}),t(Lt(r.TiburonEventName.FailInbandShare,a,o,{...n,num_recipients:a.sharingInviteTargets?a.sharingInviteTargets.length:0,screen:bt(a)}))},SHARE_MODAL_SETTINGS__PAGE_VIEW:({metadata:e,extras:a,origin:n,event:o})=>{t(It(r.TiburonEventName.ViewSettingsScreen,e,n,{...a,settings_tab:o.payload.selected_tab})),t(It(r.TiburonEventName.ViewSettingsTab,e,n,{...a,settings_tab:o.payload.selected_tab}))},SHARE_MODAL_SETTINGS__TAB_CHANGE:({metadata:e,extras:a,origin:n,event:o})=>{t(It(r.TiburonEventName.ViewSettingsTab,e,n,{...a,settings_tab:o.payload.selected_tab}))},SHARE_MODAL_MANAGE_ACCESS__SETTINGS_GEAR__CLICK:({metadata:e,extras:a,origin:n})=>{t(Lt(r.TiburonEventName.ClickSettingsGear,e,n,{...a,screen:r.ScreenName.ManageAccessScreen}));const o=e.sharingObjectMetadata;o&&(r.getIsFile(o)?t(It(r.TiburonEventName.OpenFileSettingsModal,e,n,a)):r.getIsFolder(o)&&t(It(r.TiburonEventName.OpenFolderSettingsModal,e,n,a)))},SHARE_MODAL_MANAGE_ACCESS__SETTINGS_TEXT__CLICK:({metadata:e,extras:a,origin:n,event:o})=>{t(Lt(r.TiburonEventName.ClickManageAccessPageSettingsText,e,n,{...a,screen:r.ScreenName.ManageAccessScreen,settings_tab:o.payload.settings_tab,link_access_level:o.payload.link_access_level,link_type:o.payload.link_type}));const i=e.sharingObjectMetadata;i&&t(It(r.getIsFile(i)?r.TiburonEventName.OpenFileSettingsModal:r.TiburonEventName.OpenFolderSettingsModal,e,n,a))},SHARE_MODAL_SHARE__SETTINGS_GEAR__CLICK:({metadata:e,extras:a,origin:n})=>{t(Lt(r.TiburonEventName.ClickSettingsGear,e,n,{...a,screen:r.ScreenName.ShareScreen}));const o=e.sharingObjectMetadata;o&&(r.getIsFile(o)?t(It(r.TiburonEventName.OpenFileSettingsModal,e,n,a)):r.getIsFolder(o)&&t(It(r.TiburonEventName.OpenFolderSettingsModal,e,n,a)))},SHARE_MODAL_SHARE__SETTINGS_LINK__CLICK:({metadata:e,extras:a,origin:n})=>{a=e.sharingAccessLevel&&"editor"===e.sharingAccessLevel[".tag"]?{...a,settings_tab:"edit_link_settings"}:{...a,settings_tab:"view_link_settings"},t(Lt(r.TiburonEventName.ClickSettingsText,e,n,a))},SHARE_MODAL_SHARE__MODIFY_LINK__CLICK:({metadata:e,extras:a,origin:n})=>{a=e.sharingAccessLevel&&"editor"===e.sharingAccessLevel[".tag"]?{...a,settings_tab:"edit_link_settings"}:{...a,settings_tab:"view_link_settings"},t(Lt(r.TiburonEventName.OpenLinkSettingsModal,e,n,a))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_SUCCESS:({metadata:e,extras:a,origin:n,cache:o})=>{o.inviteStartTime&&(a={...a,timing:Date.now()-o.inviteStartTime}),t(It(r.TiburonEventName.SucceedInbandShare,e,n,{...a,access_level:ft(e.sharingAccessLevel),num_recipients:e.sharingInviteTargets?e.sharingInviteTargets.length:0,screen:bt(e)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_SUCCESS:({metadata:e,extras:a,cache:n,origin:o})=>{n.inviteStartTime&&(a={...a,timing:Date.now()-n.inviteStartTime}),t(It(r.TiburonEventName.SucceedInbandShare,e,o,{...a,num_recipients:e.sharingInviteTargets?e.sharingInviteTargets.length:0,screen:bt(e)}))},SHARE_MODAL_SHARE__INVITE__NAVIGATE_ATTEMPT:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptNavigateAwayDuringShare,e,n,a))},SHARE_MODAL_SHARE__INVITE__NAVIGATE_AWAY:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedNavigateAwayDuringShare,e,n,a))},SHARE_MODAL_SETTINGS__UPSELL_LINK__CLICKED:({event:e,metadata:a,extras:n,origin:o})=>{n={...n,element_trackingId:"link_settings_pro_upsell",element_href:e.payload.href},t(It(r.TiburonEventName.ElementClick,a,o,n))},SHARE_MODAL_SETTINGS__UPSELL_LINK__EXPOSED:({event:e,metadata:a,extras:n,origin:o})=>{n={...n,element_trackingId:"link_settings_pro_upsell",element_href:e.payload.href},t(It(r.TiburonEventName.ElementView,a,o,n))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptRemoveAllMembers,e,n,a))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_ERROR:({metadata:e,event:a,origin:n,extras:o})=>{t(It(r.TiburonEventName.FailRemoveAllMembers,e,n,{http_status_code:a.payload.response.statusCode,error_message:a.payload.response.error[".tag"],...o}))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailRemoveAllMembers,e,n,{http_status_code:0,error_message:"undefined_error",...a}))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedRemoveAllMembers,e,n,{http_status_code:200,response_status:"success",...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptRemoveMember,e,n,a))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptRemoveMember,e,n,a))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptRemoveMember,e,n,{relinquish_membership:!0,...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptRemoveMember,e,n,{relinquish_membership:!0,...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_ERROR:({metadata:e,extras:a,origin:n,event:o})=>{t(It(r.TiburonEventName.FailRemoveMember,e,n,{http_status_code:o.payload.response.statusCode,error_tag:o.payload.response.error[".tag"],...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailRemoveMember,e,n,{http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_ERROR:({metadata:e,extras:a,origin:n,event:o})=>{t(It(r.TiburonEventName.FailRemoveMember,e,n,{relinquish_membership:!0,http_status_code:o.payload.response.statusCode,error_tag:o.payload.response.error[".tag"],...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailRemoveMember,e,n,{relinquish_membership:!0,http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_FAILURE:({event:e,metadata:a,extras:n,origin:o,cache:i})=>{i.inviteStartTime&&(n={...n,timing:Date.now()-i.inviteStartTime}),"ApiError"===e.payload.output.type||"PollingApiError"===e.payload.output.type?n={...n,error_tag:e.payload.output.value.response.error[".tag"],http_status_code:e.payload.output.value.response.statusCode}:"NetworkFailure"===e.payload.output.type||"PollingNetworkFailure"===e.payload.output.type?n={...n,error_tag:"unknown",http_status_code:0}:"PollingFailed"===e.payload.output.type?n={...n,error_tag:"failed",http_status_code:0}:"PollingTimeout"===e.payload.output.type&&(n={...n,error_tag:"timeout",http_status_code:0}),t(Lt(r.TiburonEventName.FailRemoveMember,a,o,n))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_FAILURE:({event:e,metadata:a,extras:n,origin:o,cache:i})=>{i.inviteStartTime&&(n={...n,timing:Date.now()-i.inviteStartTime}),"ApiError"===e.payload.output.type||"PollingApiError"===e.payload.output.type?n={...n,error_tag:e.payload.output.value.response.error[".tag"],http_status_code:e.payload.output.value.response.statusCode}:"NetworkFailure"===e.payload.output.type||"PollingNetworkFailure"===e.payload.output.type?n={...n,error_tag:"unknown",http_status_code:0}:"PollingFailed"===e.payload.output.type?n={...n,error_tag:"failed",http_status_code:0}:"PollingTimeout"===e.payload.output.type&&(n={...n,error_tag:"timeout",http_status_code:0}),t(Lt(r.TiburonEventName.FailRemoveMember,a,o,{relinquish_membership:!0,...n}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedRemoveMember,e,n,{http_status_code:200,...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedRemoveMember,e,n,{http_status_code:200,...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedRemoveMember,e,n,{relinquish_membership:!0,http_status_code:200,...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedRemoveMember,e,n,{relinquish_membership:!0,http_status_code:200,...a}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptTransferFolder,e,n,a))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailTransferFolder,e,n,{http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedTransferFolder,e,n,{http_status_code:200,...a}))},SHARE_MODAL_DATA_LOADER__INITIAL_LOADER__START:({metadata:e,extras:a,origin:n,cache:o})=>{o.shareModalDataLoadStartTime=Date.now(),o.inviteStartTime=void 0,o.createSharedLinkStartTime=void 0,t(It(r.TiburonEventName.BeginShareFlow,e,n,a))},SHARE_MODAL_DATA_LOADER__INITIAL_LOADER__SUCCESS:({metadata:e,extras:a,origin:n,cache:o})=>{o.shareModalDataLoadStartTime&&(a={...a,timing:Date.now()-o.shareModalDataLoadStartTime}),t(It(r.TiburonEventName.ViewShareModal,e,n,a))},SHARE_MODAL_RELINQUISHED_SCREEN__VIEW:({metadata:e,extras:a,origin:n,cache:o})=>{a={...a,is_relinquished_screen:!0},o.shareModalDataLoadStartTime&&(a={...a,timing:Date.now()-o.shareModalDataLoadStartTime}),t(It(r.TiburonEventName.ViewShareModal,e,n,a))},SHARE_MODAL_ERROR_SCREEN__VIEW:({metadata:a,extras:n,origin:o,event:i})=>{if("response"in i.payload.initialLoadError){const t=i.payload.initialLoadError.response;let a;t.status!==e.Status.FATAL&&(a=t.error[".tag"]);const r=t.error;n={...n,http_status_code:t.statusCode,error_summary:a,error_message:r,failing_endpoint:i.payload.initialLoadError.type}}else n={...n,event:i};t(It(r.TiburonEventName.ViewErrorScreen,a,o,n))},SHARE_MODAL_SETTINGS__LINK_AUDIENCE_CHANGE:({metadata:e,extras:a,origin:n,event:o})=>{if(e.sharingLinksMetadata){const t=r.getByAccessLevel(e.sharingLinksMetadata,o.payload.link_access_level);t&&(a={...a,...Tt(t)})}t(It(r.TiburonEventName.ChangeSharedLinkAudience,e,n,{old_audience:o.payload.previous[".tag"],new_audience:o.payload.next[".tag"],screen:r.ScreenName.SettingsScreen,...a}))},SHARE_MODAL_MANAGE_ACCESS__PARENT_FOLDER_CHANGE_ACCESS_MODAL__VIEW:({metadata:e,extras:a,event:n,origin:o})=>{t(It(r.TiburonEventName.OpenParentFolderAccessModal,e,o,{...a,num_parent_folders:n.payload.numParents}))},SHARE_MODAL_MANAGE_ACCESS__PARENT_FOLDER_REMOVE_ACCESS_MODAL__VIEW:({metadata:e,extras:a,event:n,origin:o})=>{t(It(r.TiburonEventName.OpenParentFolderAccessModal,e,o,{...a,num_parent_folders:n.payload.numParents}))},SHARE_MODAL_SHARE__VIEW:({metadata:e,extras:a,origin:n})=>{let o;e.sharingObjectMetadata&&(o=r.getCanDoAction(e.sharingObjectMetadata,r.INVITE_EDITOR_TAG)),e.sharingObjectMetadata&&r.getIsNonSharedFolder(e.sharingObjectMetadata)&&!o?a={...a,link_only_reason:"limited_permissions"}:e.sharingObjectMetadata&&r.getIsLinkOnlyMode(e.sharingObjectMetadata)?(a=e.sharingObjectMetadata.tooManyMountsError?{...a,link_only_reason:e.sharingObjectMetadata.tooManyMountsError[".tag"]}:{...a,link_only_reason:"is_family"},t(Lt(r.TiburonEventName.ViewLinkOnlyModal,e,n,{...a,share_tab:e.sharingAccessLevel&&"editor"===e.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"}))):(t(Lt(r.TiburonEventName.ViewShareScreen,e,n,{...a,share_tab:e.sharingAccessLevel&&"editor"===e.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"})),t(Lt(r.TiburonEventName.ViewShareTab,e,n,{...a,share_tab:e.sharingAccessLevel&&"editor"===e.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"})))},SHARE_MODAL_SHARE__LINK_ACCESS_LEVEL__CHANGE:({metadata:e,extras:a,origin:n,event:o})=>{t(Lt(r.TiburonEventName.ViewShareTab,e,n,{...a,share_tab:"editor"===o.payload.next[".tag"]?"edit_tab":"view_tab"}))},SHARE_MODAL_MANAGE_ACCESS__VIEW:({metadata:e,extras:a,origin:n,event:o})=>{t(Lt(r.TiburonEventName.ViewManageAccessScreen,e,n,{...a,manage_tab:o.payload.manage_tab,share_modal_initial_screen:o.payload.share_modal_initial_screen}))},SHARE_MODAL_MANAGE_ACCESS_TAB__VIEW:({metadata:e,extras:a,origin:n,event:o})=>{t(Lt(r.TiburonEventName.ViewManageAccessTab,e,n,{...a,manage_tab:o.payload.manage_tab,share_modal_initial_screen:o.payload.share_modal_initial_screen}))},SHARE_MODAL_SHARE__MANAGE_ACCESS__CLICK:({metadata:e,extras:a,origin:n})=>{t(Lt(r.TiburonEventName.ClickWhoCanAccess,e,n,a))},SHARE_MODAL__REQUEST_CLOSE__CALLED:({metadata:e,extras:a,origin:n,event:o,cache:i})=>{e={...e,sharingObjectIdentifier:o.payload.objectIdentifier},e={...e,shareModalSessionId:o.payload.sessionId},i.inviteStartTime&&(a={...a,time_modal_opened:Date.now()-i.inviteStartTime}),t(It(r.TiburonEventName.CloseShareModal,e,n,a))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptTargetSearch,e,n,a))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedTargetSearch,e,n,a))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR:({metadata:e,extras:a,origin:n,event:o})=>{t(It(r.TiburonEventName.FailTargetSearch,e,n,{...a,error:o.payload.response.error[".tag"]}))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailTargetSearch,e,n,{...a,error:"unknown"}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_START:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.AttemptDeleteSharedLink,e,n,a))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_ERROR:({metadata:e,event:a,origin:n,extras:o})=>{t(It(r.TiburonEventName.FailDeleteSharedLink,e,n,{http_status_code:a.payload.response.statusCode,error_message:a.payload.response.error[".tag"],...o}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_FATAL:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.FailDeleteSharedLink,e,n,{http_status_code:0,error_message:"undefined_error",...a}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_SUCCESS:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.SucceedDeleteSharedLink,e,n,{http_status_code:200,response_status:"success",...a}))},SHARE_MODAL_SETTINGS__CREATE_LINK__NAMESPACE_CREATE_ERROR:({metadata:e,extras:a,event:n,origin:o})=>{var i,s;a={...a,http_status_code:0,error_tag:"undefined_error",access:(null===(i=e.sharingAccessLevel)||void 0===i?void 0:i[".tag"])||"unknown"},a="ApiError"===n.payload.output.type||"PollingApiError"===n.payload.output.type?{...a,http_status_code:200,error_tag:n.payload.output.value.response.error[".tag"],access:(null===(s=e.sharingAccessLevel)||void 0===s?void 0:s[".tag"])||"unknown"}:"NetworkFailure"===n.payload.output.type||"PollingNetworkFailure"===n.payload.output.type?{...a,http_status_code:n.payload.output.value.response.statusCode||0}:{...a,error_tag:n.payload.output.type},t(It(r.TiburonEventName.FailCreateNamespaceAfterLinkCreated,e,o,a))},SHARE_MODAL_SHARE__CREATE_LINK__NAMESPACE_CREATE_ERROR:({metadata:e,extras:a,event:n,origin:o})=>{var i,s;a={...a,http_status_code:0,error_tag:"undefined_error",access:(null===(i=e.sharingAccessLevel)||void 0===i?void 0:i[".tag"])||"unknown"},a="ApiError"===n.payload.output.type||"PollingApiError"===n.payload.output.type?{...a,http_status_code:200,error_tag:n.payload.output.value.response.error[".tag"],access:(null===(s=e.sharingAccessLevel)||void 0===s?void 0:s[".tag"])||"unknown"}:"NetworkFailure"===n.payload.output.type||"PollingNetworkFailure"===n.payload.output.type?{...a,http_status_code:n.payload.output.value.response.statusCode||0}:{...a,error_tag:n.payload.output.type},t(It(r.TiburonEventName.FailCreateNamespaceAfterLinkCreated,e,o,a))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__ATTEMPT:({metadata:e,extras:a,origin:n,event:o})=>{t(It(r.TiburonEventName.AttemptSolveDefaultAudienceConflict,e,n,{...a,user_default_link_audience:o.payload.user_default_link_audience,team_default_link_audience:o.payload.team_default_link_audience,final_audience:o.payload.final_audience,is_team_user:o.payload.is_team_user}))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__FAIL:({metadata:e,extras:a,origin:n,event:o})=>{t(It(r.TiburonEventName.FailSolveDefaultAudienceConflict,e,n,{...a,user_default_link_audience:o.payload.user_default_link_audience,team_default_link_audience:o.payload.team_default_link_audience,final_audience:o.payload.final_audience,is_team_user:o.payload.is_team_user}))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__SUCCEED:({metadata:e,extras:a,origin:n,event:o})=>{t(It(r.TiburonEventName.SucceedSolveDefaultAudienceConflict,e,n,{...a,user_default_link_audience:o.payload.user_default_link_audience,team_default_link_audience:o.payload.team_default_link_audience,final_audience:o.payload.final_audience,is_team_user:o.payload.is_team_user}))},SHARE_MODAL_VALIDATE_FOLDER_PATH_NO_PERMISSION:({metadata:e,extras:a,origin:n})=>{t(It(r.TiburonEventName.ValidateFolderPathNoPermission,e,n,a))}})),[t])})(),a=l.useMemo((()=>({})),[]);return l.useCallback(((e,n,r)=>{const o=t[e.type];if(o&&r)try{o({event:e,metadata:n,origin:r,cache:a,extras:{is_sdk:!0}})}catch(e){}}),[t,a])},Nt=({sink:t,children:a,origin:n,actionInfo:r})=>{const o=(()=>{const t=R();return l.useCallback(((a,n)=>{var r;("SANDBOX"===t||t===e.Platforms.DESKTOP&&"developer"===(null===(r=n.desktopMetadata)||void 0===r?void 0:r.buildChannel))&&window.console.log(a,n)}),[t])})(),i=Mt(),s=l.useMemo((()=>S(t,o,i)),[t,o,i]);return l.createElement(p,{sink:s,origin:n,actionInfo:r},a)};Nt.displayName="LoggingProviderWithBuiltIns";const Ot=({loggingSink:t,sdk:a,children:n,redirectWindowToken:o=null,intl:i,platform:s=e.Platforms.SANDBOX,openUrl:_=null,origin:d,actionInfo:c,apiContext:u,onSnackbarShownChange:A})=>l.createElement(At,{intl:i},l.createElement(T,{platform:s},l.createElement(ot,{openUrl:_||nt},l.createElement(L,{sdk:a},l.createElement(Et,{redirectWindowToken:o},l.createElement(Nt,{sink:t||E,origin:d,actionInfo:c},l.createElement(lt,{onSnackbarShownChange:A},l.createElement(r.Provider$1,{apiContext:u},n))))))));Ot.displayName="Provider";const yt=/^www\.dropbox\.com$/,kt=/^meta-.*\.dev\.corp\.dropbox\.com$/,Dt=["/2/sharing_receiving/sharing_tiburon_logger","/2/sharing/targets/search","/2/profile_services/list_linked_services"],Pt=(e,t)=>{if(!e.sharingObjectIdentifier)throw new Error("Missing objectIdentifier while trying to log to PAP");if(!e.sharingObjectMetadata)throw new Error("Missing objectMetadata while trying to log to PAP");if(!t)throw new Error("Missing actionInfo while trying to log to PAP")},Ft=async(e,t)=>{const a=r.PAP_Copy_SharedLink({...e,contentAction:e.contentAction?r.getContentActionFromString(e.contentAction):void 0}),n={isDir:e.isDir?"true":"false"};"start"===e.eventState?r.UDCL.logStart(a,{tags:n,key:t}):r.UDCL.logEnd(a,{tags:n,key:t})},wt=async(e,t)=>{const a=r.PAP_Create_SharedLink({...e,contentAction:e.contentAction?r.getContentActionFromString(e.contentAction):void 0});"start"===e.eventState?r.UDCL.logStart(a,{key:t}):r.UDCL.logEnd(a,{key:t})},Ht=()=>(({logCopyLinkEvent:e,logCreateLinkEvent:t})=>l.useCallback(((a,n,o,i)=>{switch(a.type){case"SHARE_MODAL_SHARE__COPY_LINK__CLICK":Pt(n,i),r.getLinkMetadataSharedLinkProps(a.payload.linkMetadata).then((t=>e({...r.getBaseCopySharedLinkProps("start",i,n,!0),...t},r.getFileIdOrPath(n))));break;case"SHARE_MODAL_SHARE__COPY_LINK__COPY_SUCCESS":Pt(n,i),r.getLinkMetadataSharedLinkProps(a.payload.linkMetadata).then((t=>e({...r.getBaseCopySharedLinkProps("success",i,n,!0),...t},r.getFileIdOrPath(n))));break;case"SHARE_MODAL_SHARE__COPY_LINK__COPY_ERROR":Pt(n,i),r.getLinkMetadataSharedLinkProps(a.payload.linkMetadata).then((t=>e({...r.getBaseCopySharedLinkProps("rejected",i,n,!0),...t},r.getFileIdOrPath(n))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_START":Pt(n,i),t(r.getBaseCreateSharedLinkProps("start",i,n),r.getFileIdOrPath(n)),e(r.getBaseCopySharedLinkProps("start",i,n,!1),r.getFileIdOrPath(n));break;case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_START":Pt(n,i),t(r.getBaseCreateSharedLinkProps("start",i,n),r.getFileIdOrPath(n));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_SUCCESS":case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_SUCCESS":Pt(n,i),r.getLinkMetadataSharedLinkProps(a.payload.response.output,200).then((e=>t({...r.getBaseCreateSharedLinkProps("success",i,n),...e},r.getFileIdOrPath(n))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_ERROR":case"SHARE_MODAL_SHARE__CREATE_LINK__API_FATAL":Pt(n,i);const o=r.getErrorState$1(a.payload.response);t({...r.getBaseCreateSharedLinkProps(o,i,n),...r.getCreateLinkExceptionProps(a.payload.response)},r.getFileIdOrPath(n)),e({...r.getBaseCopySharedLinkProps(o,i,n,!1),...r.getCreateLinkExceptionProps(a.payload.response)},r.getFileIdOrPath(n));break;case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_ERROR":case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_FATAL":Pt(n,i);const s=r.getErrorState$1(a.payload.response);t({...r.getBaseCreateSharedLinkProps(s,i,n),...r.getCreateLinkExceptionProps(a.payload.response)},r.getFileIdOrPath(n));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_ERROR":Pt(n,i),r.getLinkMetadataSharedLinkProps(a.payload.linkMetadata,200).then((t=>e({...r.getBaseCopySharedLinkProps("rejected",i,n,!1),...t},r.getFileIdOrPath(n))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_FORBIDDEN":Pt(n,i),r.getLinkMetadataSharedLinkProps(a.payload.linkMetadata,200).then((t=>e({...r.getBaseCopySharedLinkProps("canceled",i,n,!1),...t},r.getFileIdOrPath(n))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_SUCCESS":Pt(n,i),r.getLinkMetadataSharedLinkProps(a.payload.linkMetadata,200).then((t=>e({...r.getBaseCopySharedLinkProps("success",i,n,!1),...t},r.getFileIdOrPath(n))))}}),[t,e]))({logCopyLinkEvent:Ft,logCreateLinkEvent:wt}),xt=({userApiProps:t,origin:o,actionInfo:i,children:c,platform:u=e.Platforms.METASERVER,shouldDisableImportContacts:E,apiContext:A})=>{const{user:m,isLoading:p}=r.useActiveUser(),g=Ht(),h=l.default.useCallback((e=>{"TEAMS_WEB"===e.type&&r.TeamsWebActionsLogger.log(e.payload.name,e.payload.extra)}),[]),v=l.default.useMemo((()=>S(g,h)),[g,h]),f=(null==A?void 0:A.isNonUserRelativeContext)&&!p?null==m?void 0:m.team_member_id:void 0,T=l.default.useMemo((()=>((e,t)=>{const a=window.location.hostname;if(!yt.test(a)&&!kt.test(a))throw new Error("Cannot initialize the SDK on an unsupported domain.");const r=new n.DropboxAuth({domain:window.location.hostname,domainDelimiter:""});return new n.Dropbox({auth:r,fetch:(a,n)=>{const r=new Headers((null==n?void 0:n.headers)||[]),o=window.location.hostname,i=e.root_ns_id;(yt.test(o)||kt.test(o))&&r.append("X-CSRF-Token",s.readCsrfToken()||""),r.append("X-Dropbox-Uid",e.id.toString());const d=new URL(a.toString()).pathname;t&&!Dt.includes(d)?r.append(_.ApiV2HeaderNames.DropboxApiSelectAdmin,t):t&&Dt.includes(d)?r.append("X-Dropbox-Path-Root",i.toString()):null!==i&&r.append("Dropbox-API-Path-Root",JSON.stringify({".tag":"namespace_id",namespace_id:i.toString()}));const c={...n||{},headers:r};return fetch(a,c)}})})(t,f)),[t,f]),{data:R,isLoading:I,isError:L}=(()=>{const{data:e,isLoading:t,isError:a,error:n}=d.loginAndRegisterConstantsPrefetchRequest.useQuery({apiArg:null,pkgArg:null});return{data:null==e?void 0:e.apiData,isLoading:t,isError:a,error:n}})();if(I||L)return null;const C=E||null==R?void 0:R.redirectWindowToken;return l.default.createElement(Ot,{intl:a.intl,sdk:T,loggingSink:v,redirectWindowToken:C,platform:u,origin:o,actionInfo:i,apiContext:A},c)};xt.displayName="SharingSdkProviderInternal";e.FocusLock=tt,e.MetadataProvider=h,e.SharingSdkProvider=e=>l.default.createElement(r.SafeQueryClientProviderWrapper,null,l.default.createElement(xt,{...e})),e.define=y,e.formatUrl=at,e.handler=O,e.useEndpoint=C,e.useLogger=g,e.useOpenUrl=it,e.usePlatform=R,e.useRedirectWindowToken=()=>l.useContext(ut).redirectWindowToken,e.useShowGenericRequestFailureMessage=()=>{const e=a.useIntl(),t=(()=>{const e=a.useIntl(),t=dt();return l.useCallback((a=>t((t=>l.createElement(r.Snackbar$1,{...t},l.createElement(r.Snackbar$1.Message,null,a),l.createElement(r.Snackbar$1.Actions,null,l.createElement(r.Button,{variant:"transparent",inverse:!0},st(e))))))),[e,t])})();return l.useCallback((()=>t(e.formatMessage({id:"+iNJRS",defaultMessage:"There was a problem completing this request."}))),[e,t])},e.useSnackbar=()=>{const t=a.useIntl(),n=dt(),o=it(),i=R()===e.Platforms.DESKTOP,s=i?{style:{position:"absolute",bottom:-16,left:0,right:0,borderRadius:0,minHeight:"unset"}}:{};return{showCompleted:e=>n((a=>l.createElement(tt,{group:"share-modal"},l.createElement(r.Snackbar$1,{...a,...s,timeout:i?0:void 0,className:"sharingSdkSnackbar",preferComposition:!0},l.createElement(r.Snackbar$1.Accessory,null,l.createElement(r.UIIcon,{src:r.CheckmarkLine})),l.createElement(r.Snackbar$1.Content,null,l.createElement(r.Snackbar$1.Message,null,e.message),l.createElement(r.Snackbar$1.Actions,null,e.actionMessage&&e.actionOnClick&&l.createElement(r.Button,{variant:"transparent",onClick:e.actionOnClick},e.actionMessage),l.createElement(r.Button,{variant:"transparent",onClick:a.onRequestClose},st(t)))))))),showInProgress:e=>n((t=>l.createElement(tt,{group:"share-modal"},l.createElement(r.Snackbar$1,{...t,...s,timeout:0,className:"sharingSdkSnackbar",preferComposition:!0},l.createElement(r.Snackbar$1.Accessory,null,l.createElement(r.Spinner,{size:"small"})),l.createElement(r.Snackbar$1.Content,null,l.createElement(r.Snackbar$1.Message,null,e.message)))))),showFailure:e=>n((a=>{const n=at(e.helpUrl||""),_=l.useCallback((()=>{o(n)}),[n]);return l.createElement(tt,{group:"share-modal"},l.createElement(r.Snackbar$1,{...a,...s,timeout:i?0:void 0,className:"sharingSdkSnackbar",preferComposition:!0},l.createElement(r.Snackbar$1.Accessory,null,l.createElement(r.UIIcon,{src:r.FailLine})),l.createElement(r.Snackbar$1.Content,null,l.createElement(r.Snackbar$1.Message,null,e.message),l.createElement(r.Snackbar$1.Actions,null,e.helpMessage&&e.helpUrl?l.createElement(r.Button,{variant:"transparent",onClick:_},e.helpMessage):null,l.createElement(r.Button,{variant:"transparent",onClick:a.onRequestClose},st(t))))))}))}}}));
//# sourceMappingURL=c_src_bindings_provider.js-vfl5QxFOd.map

//# debugId=0db1c998-f1f1-3780-be60-b0454ad70eec
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="6058aaf0-781f-3143-bb1d-c24fa8246d74")}catch(e){}}();
define(["require","exports","./c_watermarking_utils_getImageDefaultSizes","./c_core_i18n","./e_core_exception","./e_file_viewer_static_scl_page_file","./c_payments_skus_sku_content","./c_dotlottie_common_chunk-B7OIQIGJ","./c_core_notify","./c_src_sink_index","./c_hive_schemas_sharing-request_access_user_events","./c_lodash-es_lodash","react","./c_auth_common_captcha","./c_api_v2_unauthed_client","./c_api_v2_routes_password_confirmation_provider","./c_memoize-one","./c_proto_checkout_js_init_data_checkout_page_pb","./c_proto_storefront_platform_js_init_data_transition_pb"],(function(e,t,r,a,n,i,s,o,u,c,l,d,p,h,m,_,y,f,g){"use strict";function S(e){return e&&e.__esModule?e:{default:e}}var P=S(p);function T(e){return e.ns("checkout")}const v=a.intl.formatMessage({id:"CAxLNf",defaultMessage:"Please enter a valid postal code."});a.intl.formatMessage({id:"0Mt769",defaultMessage:"Please enter a valid address."}),a.intl.formatMessage({id:"RF+x3N",defaultMessage:"Please enter a valid city/town."}),a.intl.formatMessage({id:"OSqOkI",defaultMessage:"Please enter the card holder name."});const x=8,A=15,E=1002,b=1003;class C{constructor(e){this.serializedBillingSchedule=e}get id(){return this.serializedBillingSchedule.id}get description(){return this.serializedBillingSchedule.description}get scheduleDescriptionAdjective(){return(e=>{switch(e){case i.ScheduleId.MONTHLY:return a.intl.formatMessage({id:"dF0ZGK",defaultMessage:"monthly"});case i.ScheduleId.YEARLY:return a.intl.formatMessage({id:"yvyyXC",defaultMessage:"yearly"});default:return""}})(this.id)}get scheduleDescriptionNoun(){switch(this.id){case i.ScheduleId.MONTHLY:return a.intl.formatMessage({id:"AhcQ+n",defaultMessage:"month"});case i.ScheduleId.YEARLY:return a.intl.formatMessage({id:"T/CxU4",defaultMessage:"year"});default:return""}}get unlocalizedName(){return this.serializedBillingSchedule.name}get displayName(){switch(this.serializedBillingSchedule.id){case i.ScheduleId.MONTHLY:return a.intl.formatMessage({id:"dF0ZGK",defaultMessage:"monthly"});case i.ScheduleId.YEARLY:return a.intl.formatMessage({id:"yvyyXC",defaultMessage:"yearly"})}return""}}var I,w,N,L;!function(e){e.POSITIVE_OR_ZERO="positive_or_zero",e.NEGATIVE="negative"}(I||(I={}));class k{static set_locale_number_format(e=",",t="."){}static set_currency_format_map(e){k.currencyFormatMap=e}static roundCurrency(e,t="USD",r){const a=e%1==0?0:r;return k.formatCurrency(e,t,{minimumFractionDigits:a,maximumFractionDigits:a})}static formatCurrency(e,t="USD",r={}){var n;const i=Number(e),s={style:"currency",currency:t,...r},o=a.intl.formatNumberToParts(i,s).reduce(((e,t)=>"currency"!==t.type&&"literal"!==t.type&&"minusSign"!==t.type&&"plusSign"!==t.type?e+t.value:e),""),u=i>=0?I.POSITIVE_OR_ZERO:I.NEGATIVE,c=null!==(n=k.currencyFormatMap[t])&&void 0!==n?n:{};return c[u]?c[u].replace("%v",o):a.intl.formatNumber(i,s)}}k.currencyFormatMap={USD:{[I.POSITIVE_OR_ZERO]:"$%v",[I.NEGATIVE]:"-$%v"}};class D{constructor(e,t){this.cash1=e,this.cash2=t}}class M{}class R{constructor(e,t){this.currency=t;const r=parseFloat(`${e}`);if(isNaN(r)||!this.currency)throw new M;const a=Math.pow(10,2);this.amount=Math.round(r*a)/a}static fromObject(e){if(e.amount&&e.currency)return new R(parseFloat(e.amount),e.currency);throw new M}toObject(){return{amount:this.amount.toString(),currency:this.currency}}add(e){if(this.currency!==e.currency)throw new D(this,e);return new R(this.amount+e.amount,this.currency)}subtract(e){return this.add(new R(-e.amount,e.currency))}multiply(e){return new R(this.amount*e,this.currency)}divide(e){return 0===this.amount&&0===e?new R(0,this.currency):new R(this.amount/e,this.currency)}round(e=2){const t=Math.pow(10,e);return new R(Math.round(this.amount*t)/t,this.currency)}isEqual(e){if(this.currency!==e.currency)throw new D(this,e);return this.amount===e.amount}toString(e=2){return"JPY"===this.currency&&(e=0),k.roundCurrency(this.amount,this.currency,e)}formatCurrency(){return k.formatCurrency(this.amount,this.currency)}static formatWithTaxLabels(e,t){return e&&t?t.doesTaxApply&&t.tax.amount>0?a.intl.formatMessage({id:"69RiKK",defaultMessage:"{price} (taxes included)"},{price:e.formatCurrency()}):e.formatCurrency():""}}class U{constructor(e){this.serializedSku=e,this.billingSchedule=new C(e.billingSchedule);const t=e.productClass===i.ProductClass.PLAN||e.productClass===i.ProductClass.TRIAL;e.content?(this.content=s.SkuContentClient.deserialize(e.content),t||n.reportStack("Expected SerializedSku.content to be undefined",{exc_extra:{sku_code:e.code},severity:n.SEVERITY.CRITICAL,tags:["serialized_skus"]})):t&&n.reportStack("Expected SerializedSku.content but it's missing",{exc_extra:{sku_code:e.code},severity:n.SEVERITY.CRITICAL,tags:["serialized_skus"]})}static deserialize(e){return new U(e)}displayName(e=!1,t=!1,r=-1,n=0){return e?this.displayUntranslatableNameDirectFromSku:this.productFamily===i.ProductFamily.TEAM||this.productFamily===i.ProductFamily.ENTERPRISE?t&&i.ProductPlanType.STANDARD?a.intl.formatMessage({id:"L/kZgp",defaultMessage:"{plan_name}"},{plan_name:i.getDropboxBusinessLegacy()}):this.displayNameForBusinessPlans(n):this.productFamily===i.ProductFamily.PRO||this.productFamily===i.ProductFamily.FAMILY?this.displayNameForIndividualPlans(r):this.displayUntranslatableNameDirectFromSku}displayNameForIndividualPlans(e=-1){const t=function(e){return[x,A,E,b].includes(e)}(e);return this.productClass===i.ProductClass.PLAN?i.productPlanTypeToIndividualDisplayName(this.productType,t):this.productClass===i.ProductClass.ADDON&&this.productType===i.ProductAddonType.EVH?a.intl.formatMessage({id:"YlC/wH",defaultMessage:"{quota} space"},{quota:this.formattedSpecQuotaGb}):""}displayNameForBusinessPlans(e){if(this.productClass===i.ProductClass.PLAN)return i.productPlanTypeToBusinessDisplayName(this.productType,this.productFamily);if(this.productClass===i.ProductClass.LICENSE){let t;switch(this.productType){case i.ProductPlanType.STANDARD:t=i.getTrademarkBusinessLegacy();break;case i.ProductPlanType.NEW_STANDARD:case i.ProductPlanType.STANDARD_TRIAL:t=i.getTrademarkBusinessStandard();break;case i.ProductPlanType.ADVANCED:case i.ProductPlanType.ADVANCED_TRIAL:t=i.getTrademarkBusinessAdvanced();break;case i.ProductPlanType.SERVER:case i.ProductPlanType.SERVER_TRIAL:t=i.productPlanTypeToBusinessDisplayName(i.ProductPlanType.SERVER,this.productFamily);break;case i.ProductPlanType.DS_DBX_TEAM_BUNDLE:case i.ProductPlanType.REPLAY_STANDARD:t=i.productPlanTypeToBusinessDisplayName(this.productType,this.productFamily);break;default:t=""}return a.intl.formatMessage({id:"q/5Q+y",defaultMessage:"{plan_name} licenses{has_multiple_licenses, select, yes { x {license_count}} no {} other {}}"},{plan_name:t,license_count:e,has_multiple_licenses:e>1?"yes":"no"})}return""}displaySpace(){if(this.productClass===i.ProductClass.PLAN){if(this.productType===i.ProductPlanType.STANDARD||this.productType===i.ProductPlanType.TRIAL||this.productType===i.ProductPlanType.ADVANCED||this.productType===i.ProductPlanType.ADVANCED_TRIAL)return a.intl.formatMessage({id:"rQJFG5",defaultMessage:"As much space as you need"});const e=this.longFormSpecQuotaGb;if(e)return a.intl.formatMessage({id:"5dcT/i",defaultMessage:"{space_quota} of space"},{space_quota:e})}return""}descriptionName(){if(this.productClass===i.ProductClass.LICENSE)switch(this.productType){case i.ProductPlanType.STANDARD:switch(this.billingSchedule.id){case i.ScheduleId.MONTHLY:return a.intl.formatMessage({id:"HlL5PF",defaultMessage:"Legacy, billed monthly"});case i.ScheduleId.YEARLY:return a.intl.formatMessage({id:"fgnLlb",defaultMessage:"Legacy, billed yearly"});default:return a.intl.formatMessage({id:"+3S8r3",defaultMessage:"Legacy"})}case i.ProductPlanType.NEW_STANDARD:switch(this.billingSchedule.id){case i.ScheduleId.MONTHLY:return a.intl.formatMessage({id:"ckieZe",defaultMessage:"Standard, billed monthly"});case i.ScheduleId.YEARLY:return a.intl.formatMessage({id:"J7IViB",defaultMessage:"Standard, billed yearly"});default:return a.intl.formatMessage({id:"LfpmB5",defaultMessage:"Standard"})}case i.ProductPlanType.ADVANCED:switch(this.billingSchedule.id){case i.ScheduleId.MONTHLY:return a.intl.formatMessage({id:"FWSVAK",defaultMessage:"Advanced, billed monthly"});case i.ScheduleId.YEARLY:return a.intl.formatMessage({id:"c8xmjm",defaultMessage:"Advanced, billed yearly"});default:return a.intl.formatMessage({id:"TQZHJp",defaultMessage:"Advanced"})}default:return a.intl.formatMessage({id:"RAqfLK",defaultMessage:"Current Plan"})}return this.productClass===i.ProductClass.ADDON&&this.productType===i.ProductAddonType.QUOTA?a.intl.formatMessage({id:"6npKfP",defaultMessage:"Addl. space"}):""}get code(){return this.serializedSku.code}get displayUntranslatableNameDirectFromSku(){return this.serializedSku.displayName}get exclusionGroup(){return this.serializedSku.exclusionGroup}get productFamily(){return this.serializedSku.productFamily}get adminCxId(){return this.serializedSku.adminCxId}get productClass(){return this.serializedSku.productClass}get productType(){return this.serializedSku.productType}get productSpec(){return this.serializedSku.productSpec}get schedule(){return this.serializedSku.schedule}get scheduleId(){return this.serializedSku.billingSchedule.id}get scheduleName(){return this.serializedSku.billingSchedule.name}get scheduleDescription(){return this.serializedSku.billingSchedule.description}get displayCost(){return R.fromObject(this.serializedSku.price.displayCost)}get displayCostIsTaxInclusive(){return this.serializedSku.price.isTaxInclusive}get isProductPlan(){return this.productClass===i.ProductClass.PLAN}get specQuotaGb(){return this.serializedSku.specQuotaGb}get formattedSpecQuotaGb(){if(this.specQuotaGb)return i.formatGigabytes(this.specQuotaGb)}get longFormSpecQuotaGb(){if(this.specQuotaGb)return`${this.formattedSpecQuotaGb} (${this.specQuotaGb} GB)`}get adminCxName(){return this.serializedSku.adminCxName}get isLicenseBased(){return this.serializedSku.isLicenseBased}get isPartialProvisionable(){return this.serializedSku.isPartialProvisionable}get licenseSkuCode(){return this.serializedSku.licenseSkuCode}get isTrialPlan(){return this.productType===i.ProductPlanType.TRIAL||this.productType===i.ProductPlanType.STANDARD_TRIAL||this.productType===i.ProductPlanType.ADVANCED_TRIAL||this.productType===i.ProductPlanType.SERVER_TRIAL||this.productType===i.ProductPlanType.DS_DBX_TEAM_BUNDLE_TRIAL||this.productType===i.ProductPlanType.DBX_BUSINESS_TRIAL||this.productType===i.ProductPlanType.DBX_BUSINESS_PLUS_TRIAL||this.productType===i.ProductPlanType.DASH_TEAM_TRIAL}get isLegacyPlan(){return!(this.isStandardPlan||this.isAdvancePlan||this.isServerPlan||this.isBaseFSSPlan)}get isStandardPlan(){return this.productType===i.ProductPlanType.NEW_STANDARD||this.productType===i.ProductPlanType.STANDARD_TRIAL}get isAdvancePlan(){return this.productType===i.ProductPlanType.ADVANCED||this.productType===i.ProductPlanType.ADVANCED_TRIAL}get isServerPlan(){return this.productType===i.ProductPlanType.SERVER||this.productType===i.ProductPlanType.SERVER_TRIAL}get isBaseFSSPlan(){return this.productType===i.ProductPlanType.BASE_FSS_TEAM}get isEnterprise(){return this.productFamily===i.ProductFamily.ENTERPRISE}get isReplayStandardPlan(){return this.productType===i.ProductPlanType.REPLAY_STANDARD}get adminCxDescription(){if(this.productClass===i.ProductClass.PLAN)return this.adminCxName;if(this.productClass===i.ProductClass.ADDON)switch(this.productSpec){case i.ProductSpec.SPACE_PACK_100G:return"100GB Team Space Extra";case i.ProductSpec.SPACE_PACK_10T:return"10TB Team Space Extra";case i.ProductSpec.SPACE_PACK_50T:return"50TB Team Space Extra";case i.ProductSpec.SPACE_PACK_200T:return"200TB Team Space Extra";case i.ProductSpec.SPACE_PACK_500T:return"500TB Team Space Extra";case i.ProductSpec.SPACE_PACK_1000T:return"1000TB Team Space Extra";case i.ProductSpec.SPACE_PACK_5000T:return"5000TB Team Space Extra"}return""}get adminCxIsValid(){return this.productClass===i.ProductClass.PLAN&&(this.billingSchedule.id!==i.ScheduleId.FIVE_YEARS&&(this.productFamily!==i.ProductFamily.ENTERPRISE||this.billingSchedule.id!==i.ScheduleId.MONTHLY))}get adminCxIsUnlimited(){if(this.productClass!==i.ProductClass.PLAN)return!1;if(this.productFamily===i.ProductFamily.TEAM)switch(this.productType){case i.ProductPlanType.NEW_STANDARD:case i.ProductPlanType.STANDARD_TRIAL:case i.ProductPlanType.SERVER:case i.ProductPlanType.SERVER_TRIAL:return!1}else{if(this.productFamily===i.ProductFamily.ENTERPRISE&&this.productType===i.ProductPlanType.SERVER)return!1;if(this.productFamily===i.ProductFamily.EDUCATION)return!1}return!0}get adminCxIsSpacePackEligible(){return this.productClass===i.ProductClass.PLAN&&!(this.adminCxIsUnlimited||this.productFamily===i.ProductFamily.TEAM&&this.productType===i.ProductPlanType.NEW_STANDARD)}}class B{constructor(e){this._skus=e}static fromSerializedSkus(e){const t=e.map((e=>new U(e)));return new B(t)}get sku(){if(1!==this._skus.length)throw new Error("Unable to resolve to a single SKU");return this._skus[0]}get skus(){return this._skus.slice()}filter(e){return new B(this._skus.filter(e))}withAdminCxId(e){return this.filter((t=>t.adminCxId===e))}withCode(e){return this.filter((t=>t.code===e))}withFamily(e){return this.filter((t=>t.productFamily===e))}withClass(e){return this.filter((t=>t.productClass===e))}withType(e){return this.filter((t=>t.productType===e))}withSchedule(e){return this.filter((t=>t.schedule===e))}monthly(){return this.withSchedule(i.ProductSchedule.MONTHLY)}yearly(){return this.withSchedule(i.ProductSchedule.YEARLY)}peekSkus(){if(this._skus.length>0)return this._skus[0]}contains(e){for(let t=0;t<this._skus.length;t++)if(this._skus[t].code===e.code)return!0;return!1}}class O{constructor(e){if(this.quantityMap={},e.billingSchedule&&(this.schedule=new C(e.billingSchedule)),e.planSku&&(this.planSku=new U(e.planSku)),e.licenseSkus){const t=e.licenseSkus.map((e=>{const t=new U(e.sku);return this.quantityMap[t.code]=e.quantity,t}));this.licenseSkuSet=new B(t)}else this.licenseSkuSet=new B([]);if(e.trialDuration&&(this._trialDuration=e.trialDuration),e.addonSkus){const t=e.addonSkus.map((e=>{const t=new U(e.sku);return this.quantityMap[t.code]=e.quantity,t}));this.addonSkuSet=new B(t)}else this.addonSkuSet=new B([])}fromSubscriptionSkuSet(e){this.schedule=e.schedule,this.planSku=e.plan,this.licenseSkuSet=new B(e.licenses.skus),this.addonSkuSet=new B(e.addons.skus);for(const t in e.quantityMap)this.quantityMap[t]=e.quantityMap[t];return this}get allSkus(){const e=this.licenses.skus.concat(this.addons.skus);return this.planSku&&e.push(this.planSku),new B(e)}get plan(){return this.planSku}get billingSchedule(){return this.schedule}get trialDuration(){return this._trialDuration}quantityForSkuCode(e){const t=this.quantityMap[e];return void 0!==t?t:-1}quantityForEvhAddOn(){if(this.addonSkuSet.skus.length<=0)return 0;let e=this.addonSkuSet.withType(i.ProductAddonType.EVH);return void 0===e.peekSkus()&&(e=this.addonSkuSet.withType(i.ProductAddonType.EVH_FREE)),void 0!==e.peekSkus()?this.quantityMap[e.sku.code]:0}quantityForSku(e){const t=this.quantityMap[e.code];return void 0!==t?t:-1}get licenses(){return this.licenseSkuSet}get totalLicenses(){return void 0!==this.totalLicensesOverride?this.totalLicensesOverride:this.licenseSkuSet.skus.map((e=>this.quantityMap[e.code])).reduce(((e,t)=>e+t))}get addons(){return this.addonSkuSet}equals(e){const t=e.allSkus.skus,r=this.allSkus.skus;return t.length===r.length&&r.every((r=>!!t.some((e=>e.code===r.code))&&this.quantityForSku(r)===e.quantityForSku(r)))}toJSON(){let e;if(void 0===this.totalLicensesOverride){e={};for(const t of this.licenseSkuSet.skus)e[t.code]=this.quantityMap[t.code]}const t={};for(const e of this.addonSkuSet.skus)t[e.code]=this.quantityMap[e.code];return{addonSkus:t,billingScheduleId:this.billingSchedule?this.billingSchedule.id:void 0,licenseSkus:e,planSku:this.planSku?this.planSku.code:void 0,trialDuration:this._trialDuration,totalLicenses:this.totalLicensesOverride}}}class F extends O{static fromSubscriptionStatus(e){const t=e.isOnTrial?e.subState:e.finalSubState;return F.fromSubscriptionState(t)}static fromSubscriptionState(e){return F.fromSubscriptionSkuSet(e)}static fromSubscriptionSkuSet(e){return new F({}).fromSubscriptionSkuSet(e)}setPlan(e){if(e.productClass!==i.ProductClass.PLAN)throw"Can only set plan skus.";return this.planSku=e,this}setTotalLicenses(e){return 1!==this.licenses.skus.length?this.totalLicensesOverride=e:this.setLicenseQuantity(this.licenses.sku,e),this}setLicenseQuantity(e,t=1){if(e.productClass!==i.ProductClass.LICENSE)throw"Can only set license skus.";if(this.totalLicensesOverride=void 0,this.quantityMap[e.code]=t,!this.licenses.contains(e)){const t=this.licenses.skus;t.push(e),this.licenseSkuSet=new B(t)}return this}setAddonQuantity(e,t=1){if(e.productClass!==i.ProductClass.ADDON)throw"Can only set addon skus.";if(this.quantityMap[e.code]=t,!this.addons.contains(e)){const t=this.addons.skus;t.push(e),this.addonSkuSet=new B(t)}return this}setBillingScheduleId(e){return this.overrideBillingScheduleId=e,this}equals(e){return this.overrideBillingScheduleId===e.overrideBillingScheduleId&&super.equals(e)}toJSON(){const e=super.toJSON();return this.overrideBillingScheduleId&&(e.billingScheduleId=this.overrideBillingScheduleId),e}}class V{constructor(e){this.serializedQuotaInfo=e}get extrasQuota(){return this.serializedQuotaInfo.extrasQuota}get formattedExtrasQuota(){return i.format_bytes$1(this.extrasQuota)}get licensesQuota(){return this.serializedQuotaInfo.licensesQuota}get formattedLicenseQuota(){return i.format_bytes$1(this.licensesQuota)}get planQuota(){return this.serializedQuotaInfo.planQuota}get formattedPlanQuota(){return i.format_bytes$1(this.planQuota)}get totalQuota(){return this.serializedQuotaInfo.totalQuota}get formattedTotalQuota(){return i.format_bytes$1(this.totalQuota)}getFormattedQuotaByPlanType(e){if(e===i.ProductPlanType.STANDARD||e===i.ProductPlanType.TRIAL||e===i.ProductPlanType.ADVANCED||e===i.ProductPlanType.ADVANCED_TRIAL)return a.intl.formatMessage({id:"rQJFG5",defaultMessage:"As much space as you need"});const t=this.formattedTotalQuota;return t?a.intl.formatMessage({id:"5dcT/i",defaultMessage:"{space_quota} of space"},{space_quota:t}):""}}class j extends O{constructor(e){var t,r;super(e),this._minLicenseLimitForPlan=e.minLicenseLimitForPlan,this._maxSelfServiceLicenseLimitForPlan=e.maxSelfServiceLicenseLimitForPlan,this._formattedNextBillingDate=e.formattedNextBillingDate,this._isDeactivatedTeam=e.isDeactivatedTeam,e.quotaInfo?this.quotaInfo=new V(e.quotaInfo):n.reportStack("Expected SerializedSubState.quotaInfo but it's missing",{exc_extra:{sku_code:null===(t=e.planSku)||void 0===t?void 0:t.code},severity:n.SEVERITY.CRITICAL,tags:["serialized_skus"]}),e.content?this.content=s.SubStateContentClient.deserialize(e.content):n.reportStack("Expected SerializedSubState.content but it's missing",{severity:n.SEVERITY.CRITICAL,exc_extra:{sku_code:null===(r=e.planSku)||void 0===r?void 0:r.code},tags:["serialized_skus"]}),this._totalUsableLicenses=e.totalUsableLicenses}get minLicenseLimitForPlan(){return this._minLicenseLimitForPlan}get maxSelfServiceLicenseLimitForPlan(){return this._maxSelfServiceLicenseLimitForPlan}get formattedNextBillingDate(){return this._formattedNextBillingDate}get quota(){return this.quotaInfo}get isDeactivatedTeam(){return this._isDeactivatedTeam}get totalUsableLicenses(){return this._totalUsableLicenses}equals(e){return!!super.equals(e)&&this.formattedNextBillingDate===e.formattedNextBillingDate}}class q{constructor(e){this._sku=U.deserialize(e.sku),this._quantity=e.quantity,this._price=R.fromObject(e.price),e.lineItemPrice?this._displayPrice=R.fromObject(e.lineItemPrice):this._displayPrice=R.fromObject(e.price)}get sku(){return this._sku}get quantity(){return this._quantity}get price(){return this._price}get displayPrice(){return this._displayPrice}}class ${constructor(e){this._lineItems=e.lineItems.map((e=>new q(e))),this.baseAmount=R.fromObject(e.baseAmount),this.discountAmount=R.fromObject(e.discountAmount),this._discountPercentage=e.discountPercentage,this._doesTaxApply=e.doesTaxApply,this.taxAmount=R.fromObject(e.taxAmount),this.totalAmount=R.fromObject(e.totalAmount),this._taxRate=e.taxRate,this._taxName=e.taxName,this.totalAmountWithoutPromotions=R.fromObject(e.totalAmountWithoutPromotions),this._promoInfo=e.promoInfo}get lineItems(){return this._lineItems.slice()}get base(){return this.baseAmount}get discount(){return this.discountAmount}get discountPercentage(){return this._discountPercentage}getPerLicenseCost(e){for(const t of this.lineItems)if(t.sku.code===e){const e=t.price.amount/t.quantity,r=1-this.discountPercentage/100,a=t.price.currency,n=new R(e*r,a);return"AUD"===a?new R(n.amount+n.amount*(this.taxRate/100),n.currency):n}}get tax(){return this.taxAmount}get taxRate(){return this._taxRate}get taxName(){return this._taxName}taxString(){return this.taxRate<=0?"":a.intl.formatMessage({id:"hIFy4P",defaultMessage:"(including {tax_rate_str, number, ::percent .##} tax)"},{tax_rate_str:this.taxRate/100})}get total(){return this.totalAmount}get totalLicenses(){return this._lineItems.reduce(((e,t)=>(t.sku.productClass===i.ProductClass.LICENSE&&(e+=t.quantity),e)),0)}get doesTaxApply(){return this._doesTaxApply}get amountWithoutPromotions(){return this.totalAmountWithoutPromotions}get promoInfo(){return this._promoInfo}}class z{constructor(e){e.currentBillingSummary&&(this._currentBillingSummary=new $(e.currentBillingSummary)),e.nextBillingSummary&&(this._nextBillingSummary=new $(e.nextBillingSummary)),this._subState=new j(e.subState),e.scheduledSubState&&(this._scheduledSubState=new j(e.scheduledSubState))}get subState(){return this._subState}get scheduledSubState(){return this._scheduledSubState}get finalSubState(){return this.scheduledSubState?this.scheduledSubState:this.subState}get isOnTrial(){return!!this.subState.plan&&(this.subState.plan.isTrialPlan||void 0!==this.subState.trialDuration)}get formattedNextBillingDate(){return this.subState.formattedNextBillingDate}get currentBillingSummary(){return this._currentBillingSummary}get nextBillingSummary(){return this._nextBillingSummary}get isScheduledForDowngrade(){return null===this.finalSubState.plan||void 0===this.finalSubState.plan}toJSON(){return{scheduledSubState:this.scheduledSubState,subState:this.subState}}}!function(e){e[e.NONE=-1]="NONE",e[e.VAT=1]="VAT",e[e.LEGACY_VAT_EXCEPTION=2]="LEGACY_VAT_EXCEPTION",e[e.LEGACY_SALES_TAX_EXEMPTION=3]="LEGACY_SALES_TAX_EXEMPTION",e[e.MSP_TOTAL_TAX_EXCEPTION=4]="MSP_TOTAL_TAX_EXCEPTION",e[e.ADMIN_TAX_EXEMPTION=5]="ADMIN_TAX_EXEMPTION"}(w||(w={})),function(e){e[e.InitialPlan=1]="InitialPlan",e[e.ExtraLicense=7]="ExtraLicense"}(N||(N={}));class H{constructor(e,t){this.transition=e,this.taxName=t}getExpectedPriceToken(){return this.transition.expected_price}getScheduleId(){return this.transition.state.schedule.id}hasPackrat(){return this.transition.prices.evh&&R.fromObject(this.transition.prices.evh).amount>0}getCurrency(){return this.transition.state.currency}getBilledPrice(){return R.fromObject(this.transition.prices.billed)}getPerLicensePrice(e){for(const t of this.transition.state.per_license_prices)if(t.license_id===e)return R.fromObject(t.price)}getTotalPrice(){return R.fromObject(this.transition.read_only_invoice.total)}getTotalTaxWithheld(){return R.fromObject(this.transition.prices.tax_withheld)}getTotalRecurringPrice(){return R.fromObject(this.transition.state.total_recurring_price)}getTotalNumberOfLicenses(){return this.transition.state.allocated_licenses[0].license_count}getUserPrice(e){let t=R.fromObject(this.transition.state.next_license_prices[0].price);return e&&(t=t.multiply(1-e/100)),t}_getLineItem(e){for(const t of this.transition.read_only_invoice.line_items)if(t.line_item_type===e)return t;return null}getLineItemCount(e){if(e===N.InitialPlan)return this.transition.state.plan.included_license_counts[0].license_count;const t=this._getLineItem(e);return t?t.quantity:0}getLineItemPrice(e){const t=this._getLineItem(e);return t?R.fromObject(t.line_item_price):new R(0,this.getCurrency())}getInitialPlanInfo(){return{count:this.getLineItemCount(N.InitialPlan),price:this.getLineItemPrice(N.InitialPlan)}}getExtraLicensesInfo(){return{count:this.getLineItemCount(N.ExtraLicense),price:this.getLineItemPrice(N.ExtraLicense)}}getTaxPrice(){return R.fromObject(this.transition.prices.tax)}getTaxPercentage(){if(!this.transition.read_only_invoice||!this.transition.read_only_invoice.line_items.length)return 0;const e=this.transition.read_only_invoice.line_items[0];return e.state_tax_percentage?parseFloat(e.state_tax_percentage):e.country_tax_percentage?parseFloat(e.country_tax_percentage):0}getWithheldTaxPercentage(){if(!this.transition.read_only_invoice||!this.transition.read_only_invoice.line_items.length)return 0;const e=this.transition.read_only_invoice.line_items[0];return e.total_withheld_tax_percentage?parseFloat(e.total_withheld_tax_percentage):0}getTaxCountryCode(){return this.transition.read_only_invoice.tax_country_code}getTaxPlanId(){return this.transition.read_only_invoice.tax_plan_id}getDiscountPercentage(){const e=this._getLineItem(N.InitialPlan);return e&&e.discount_percentage?parseFloat(e.discount_percentage):0}get doesTaxApply(){return this.transition.does_tax_apply}}class Y extends z{constructor(e){super(e),e.tvm&&(this.transitionViewModel=new H(e.tvm))}get tvm(){return this.transitionViewModel}toJSON(){const e=super.toJSON();return this.tvm&&(e.expectedPriceToken=this.tvm.getExpectedPriceToken()),e}}class G extends z{constructor(e){super(e)}}t.ThreeDsResultType=void 0,(L=t.ThreeDsResultType||(t.ThreeDsResultType={})).ChallengeShopper="ChallengeShopper",L.IdentifyShopper="IdentifyShopper";const Z="threeDS2ChallengeBackground",Q="threeDS2Wrapper",J="threeDS2Challenge";function X(e){const t=document.getElementById(e);null!==t&&(t.outerHTML="")}function W(e,t,r){return new Promise(((a,i)=>{c.getMetricsReporter().createStats({ns:"three_ds2",name:"fingerprint/attempt"},{}).record(1);const s="threeDS2",o=document.createElement("div");o.setAttribute("style","display: none"),o.setAttribute("id",s),document.body.appendChild(o);e.createFromAction({type:"threeDS2Fingerprint",subtype:"fingerprint",token:t,paymentMethodType:"scheme",paymentData:r},{onAdditionalDetails:(e,t)=>{ae("completed");const r=e;if("threeds2.fingerprint"in r.data.details){const e=r.data.details["threeds2.fingerprint"];a(e)}X(s)},onError:(e=void 0)=>{ae("failed"),e&&e.errorCode?ne(e.errorCode):ne("unknown"),X(s),a("eyJ0aHJlZURTQ29tcEluZCI6Ik4ifQ=="),n.reportStack(`Error in creating Adyen fingerprint action: ${JSON.stringify(e)}`,{severity:n.SEVERITY.CRITICAL,silent:!0,tags:["three_ds_handler_error","three_ds_handler_fingerprint_failed_on_error"]})}}).mount("#"+s)}))}function K(){X(Q),X(Z)}function ee(e,t,r){return new Promise(((a,i)=>{c.getMetricsReporter().createStats({ns:"three_ds2",name:"challenge/attempt"},{}).record(1);const s=(e=void 0)=>{ie("failed"),e&&e.errorCode?se(e.errorCode):se("unknown"),K(),i(),n.reportStack(`Error in creating Adyen challenge action: ${JSON.stringify(e)}`,{severity:n.SEVERITY.CRITICAL,tags:["three_ds_handler_error","three_ds_handler_show_challenge_failed_on_error"]})};!function(e){const t=document.createElement("div");t.setAttribute("id",Z),t.setAttribute("style","width: 100%; height: 100%; position: fixed; top: 0px; left: 0px; z-index: 10001;background-color: rgba(0, 0, 0, 0.24);"),t.onclick=e;const r=document.createElement("div");r.setAttribute("id",Q),r.setAttribute("style","position: fixed; bottom: 50%; left: 50%; transform: translateX(-50%) translateY(50%);background-color: white; border: 1px solid #dddfe1; border-radius: 4px; z-index: 10050;padding: 35px 35px 60px 35px;");const a=document.createElement("p");a.setAttribute("style","font-size: 16px; line-height: 24px; color: #717781; margin: 0 0 25px 0;"),a.textContent="To protect your info, please verify your payment.",r.appendChild(a);const n=document.createElement("div");n.setAttribute("id",J),n.setAttribute("style","border: 1px solid #d9d9d9; border-radius: 3px; padding: 10px;"),r.appendChild(n),document.body.appendChild(t),document.body.appendChild(r)}(s),e.createFromAction({type:"threeDS2Challenge",subtype:"challenge",token:t,paymentMethodType:"scheme",paymentData:r},{onAdditionalDetails:(e,t)=>{ie("completed");const r=e;if("threeds2.challengeResult"in r.data.details){const e=r.data.details["threeds2.challengeResult"];K(),a(e)}},onError:s,size:"02"}).mount("#"+J)}))}function te(){return window.navigator.language?window.navigator.language:window.navigator.browserLanguage}function re(){if(!window)return;const e=window.screen?window.screen.width:"",t=window.screen?window.screen.height:"",r=window.screen?window.screen.colorDepth:"",a=window.navigator?window.navigator.userAgent:"",n=!!window.navigator&&navigator.javaEnabled();let i="";window.navigator&&(i=te());const s={screenWidth:e,screenHeight:t,colorDepth:r,userAgent:a,timeZoneOffset:(new Date).getTimezoneOffset(),language:i,javaEnabled:n};return JSON.stringify(s)}function ae(e){c.getMetricsReporter().createStats({ns:"three_ds2",name:"fingerprint/status"},{status:e}).record(1)}function ne(e){c.getMetricsReporter().createStats({ns:"three_ds2",name:"fingerprint/error"},{type:e}).record(1)}function ie(e){c.getMetricsReporter().createStats({ns:"three_ds2",name:"challenge/status"},{status:e}).record(1)}function se(e){c.getMetricsReporter().createStats({ns:"three_ds2",name:"challenge/error"},{type:e}).record(1)}function oe(e){var t,r,a;const n=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/payments/ajax_transition_view_model",s=null!==(r=null==e?void 0:e.routeParams)&&void 0!==r?r:{},o=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new i.AjaxURL(i.replacePattern(n,s),o)}function ue(e){var t,r,a;const n=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/payments/ajax_perform_transition",s=null!==(r=null==e?void 0:e.routeParams)&&void 0!==r?r:{},o=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new i.AjaxURL(i.replacePattern(n,s),o)}function ce(e){var t,r,a;const n=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/payments/ajax_price_transition",s=null!==(r=null==e?void 0:e.routeParams)&&void 0!==r?r:{},o=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new i.AjaxURL(i.replacePattern(n,s),o)}function le(e){var t,r,a;const n=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/payments/ajax_validate_and_perform_transition",s=null!==(r=null==e?void 0:e.routeParams)&&void 0!==r?r:{},o=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new i.AjaxURL(i.replacePattern(n,s),o)}class de{constructor({skipNotifyError:e=!1}={}){this.subChangePlanCache={},this.strikethroughPricesCache={},this.handlePerformTransitionResponse=e=>{if(0===e.indexOf("err:")){const t=e.substr(4);return this.handlePerformTransitionError(t),Promise.reject({err:t,type:"AjaxError"})}const t=JSON.parse(e);return t.errorMessage?(this.skipNotifyError||u.Notify.error(t.errorMessage),Promise.reject({err:t.errorMessage,type:t.errorType||null})):t.redirect?(i.redirect(t.redirect),Promise.reject(t.redirect)):Promise.resolve(new G(t.result))},this.handlePerformTransitionError=e=>{let t=null;try{t=JSON.parse(e)}catch(e){}finally{this.handle3DsMessage&&t&&this.handle3DsMessage(t)}},this.updateThreeDsData=e=>{this.threeDsData=e},this.updateThreeDsMessageHandler=e=>{this.handle3DsMessage=e},this.handlePriceTransitionResponse=e=>{const t=JSON.parse(e);return t.errorMessage?(this.skipNotifyError||u.Notify.error(t.errorMessage),Promise.reject(t.errorMessage)):Promise.resolve(new Y(t))},this.skipNotifyError=e}performPersonalTransition(e){return this.performTransition(e,!0)}performTransition(e,t=!1,r=!1){const a=i.WebRequest$1({url:ue(),skipNotifyError:this.skipNotifyError,data:{sub_change_plan:JSON.stringify(e),for_personal:t,reapply_scheduled_changes:r,browser_info:re(),three_ds_data:this.threeDsData},subject_user:o.mustGetActiveUserId()}).then(this.handlePerformTransitionResponse);return this.updateThreeDsData(""),a}priceTransition(e,t){return i.WebRequest$1({url:ce(),skipNotifyError:this.skipNotifyError,data:{sku_code:e.code,team_id:t}}).then(this.handlePriceTransitionResponse)}validateAndPerformTransition(e,t=!1){return i.WebRequest$1({url:le(),skipNotifyError:this.skipNotifyError,data:{sub_diff:JSON.stringify(e),for_personal:t},subject_user:o.mustGetActiveUserId()}).then(this.handlePerformTransitionResponse)}fetchPriceData(e){return new Promise(((t,r)=>{clearTimeout(this.currentPriceTimeout),this.currentPriceTimeout=setTimeout((()=>{i.WebRequest$1({url:oe(),skipNotifyError:this.skipNotifyError,data:e,subject_user:o.getActiveUserId()}).then(t,r)}),200)}))}price(e,t,r,a,n){return this.priceBatch({transition:e},t,r,a,n).then((e=>e?e.transition:void 0))}priceSet(e,t,r,a,n){const i={},s=e.length;for(let t=0;t<s;t++)i["subDiff:"+t]=e[t];return this.priceBatch(i,t,r,a,n).then((e=>e?Object.getOwnPropertyNames(e).reduce(((t,r)=>(t.push(e[r]),t)),[]):void 0))}priceBatch(e,t,r,a,n){const i={},s={};Object.keys(e).forEach((a=>{const n=new pe(e[a],t,r).hash();if(n in this.subChangePlanCache){i[a]=this.subChangePlanCache[n];const s=new pe(e.strikethrough_prices,t,r);i.strikethoughPrices=this.strikethroughPricesCache[s.hash()]}else s[a]=e[a]}));const o=this.priceRequestToken=Math.random()*Number.MAX_VALUE;return Object.keys(s).length?this.fetchPriceData({requests:JSON.stringify(s),billing_details:t?JSON.stringify(t):"",pricing_options:r?JSON.stringify(r):"",is_pro:a?"true":"",is_for_multiseat_plan:n?"true":"false"}).then((e=>{if(o!==this.priceRequestToken)return;if(0===e.indexOf("err:")){const t=e.substr(4);return Promise.reject(t)}if(0===e.indexOf("htmlerr:")){const t=e.substr(8);return Promise.reject(t)}const a=JSON.parse(e);return Object.keys(a).forEach((e=>{const n=a[e],o=new pe(s[e],t,r);i[e]="yearlyPricePerYear"in n?this.strikethroughPricesCache[o.hash()]=n:this.subChangePlanCache[o.hash()]=new Y(n)})),i})):Promise.resolve(i)}cancelPriceRequest(){this.priceRequestToken=-1,clearTimeout(this.currentPriceTimeout)}}class pe{constructor(e,t,r){this.request=e,this.billingDetails=t,this.pricingOptions=r}hash(){return JSON.stringify(this)}}const he={AE:{prefix:"",regex:/^[0-9]{15}$/,examples:["123456789012345"],maxLength:15},AL:{prefix:"",regex:/^[JKLM]\d{8}[A-Z]$/,examples:["K12345678L"],maxLength:10},AM:{prefix:"",regex:/^[0-9]{8}\/[0-9]$/,examples:["12345678/1"],maxLength:10},AT:{prefix:"AT",regex:/^ATU[0-9]{8}$/,examples:["ATU12345678"],maxLength:11},AU:{prefix:"",regex:/^[0-9]{11}$/,examples:["12345678912"],maxLength:11},BB:{prefix:"",regex:/^[0-9]{13}$/,examples:["1234567890123"],maxLength:13},BD:{prefix:"",regex:/^[0-9]{13}$/,examples:["1234567890123"],maxLength:13},BE:{prefix:"BE",regex:/^BE(0?|1)[0-9]{9}$/,examples:["BE0123456789","BE1123456789","BE1234567890"],maxLength:12},BG:{prefix:"BG",regex:/^BG[0-9]{9,10}$/,examples:["BG123456789","BG1234567890"],maxLength:12},BH:{prefix:"",regex:/^[0-9]{15}$/,examples:["123456789012345"],maxLength:15},BS:{prefix:"",regex:/^[0-9]{9}$/,examples:["123456789"],maxLength:9},BY:{prefix:"",regex:/^[0-9]{9}$/,examples:["123456789"],maxLength:9},CA:{prefix:"",regex:/^[0-9]{9,10}$/,examples:["123456789","1234567890"],maxLength:10},CH:{prefix:"CH",regex:/^CHE[0-9]{9}(TVA|MWST|IVA)$/,examples:["CHE123456789TVA","CHE123456789MWST","CHE123456789IVA"],maxLength:16},CL:{prefix:"",regex:/^[0-9]{8}[0-9A-Z]$/,examples:["12345678L"],maxLength:9},CY:{prefix:"CY",regex:/^CY[0-9]{8}[A-Z]$/,examples:["CY12345678X"],maxLength:11},CZ:{prefix:"CZ",regex:/^CZ[0-9]{8,10}$/,examples:["CZ12345678","CZ123456789","CZ1234567890"],maxLength:12},DE:{prefix:"DE",regex:/^DE[0-9]{9}$/,examples:["DE123456789"],maxLength:11},DK:{prefix:"DK",regex:/^DK[0-9]{8}$/,examples:["DK12345678"],maxLength:10},EE:{prefix:"EE",regex:/^EE[0-9]{9}$/,examples:["EE123456789"],maxLength:11},GE:{prefix:"",regex:/^([0-9]{9}|[0-9]{11})$/,examples:["123456789","12345678901"],maxLength:11},GR:{prefix:"EL",regex:/^EL[0-9]{9}$/,examples:["EL123456789"],maxLength:11},EG:{prefix:"",regex:/^[0-9]{3}-[0-9]{3}-[0-9]{3}$/,examples:["123-456-789"],maxLength:11},ES:{prefix:"ES",regex:/^ES([A-Z][0-9]{7}[0-9A-Z]|[0-9A-Z][0-9]{7}[A-Z])$/,examples:["ESX12345678","ES12345678X","ESX1234567X"],maxLength:11},FI:{prefix:"FI",regex:/^FI[0-9]{8}$/,examples:["FI12345678"],maxLength:10},FR:{prefix:"FR",regex:/^FR[0-9A-Z]{2}[0-9]{9}$/,examples:["FR12345678901","FRX1234567890","FR1X123456789","FRXX123456789"],maxLength:13},GB:{prefix:"GB",regex:/^GB([0-9]{9}|[0-9]{12}|GD[0-9]{3}|HA[0-9]{3})$/,examples:["GB123456789","GB123456789012","GBGD123","GBHA123"],maxLength:14},HR:{prefix:"HR",regex:/^HR[0-9]{11}$/,examples:["HR12345678901"],maxLength:13},HU:{prefix:"HU",regex:/^HU[0-9]{8}$/,examples:["HU12345678"],maxLength:10},IE:{prefix:"IE",regex:/^IE([0-9][0-9A-Z+*][0-9]{5}[A-Z]{1,2}|[0-9]{7}WI)$/,examples:["IE1X23456X","IE1234567XX"],maxLength:11},IN:{prefix:"",regex:/^[0-9A-Z]{15}$/,examples:["TS1234567891234"],maxLength:15},IS:{prefix:"",regex:/^[0-9]{5,6}$/,examples:["123456","12345"],maxLength:6},IT:{prefix:"IT",regex:/^IT[0-9]{11}$/,examples:["IT12345678901"],maxLength:13},KE:{prefix:"",regex:/^[PA][0-9]{9}[A-Z]$/,examples:["P123456789X","A123465798X"],maxLength:11},KH:{prefix:"",regex:/^[0-9]{9}$/,examples:["123456789"],maxLength:9},KR:{prefix:"",regex:/^[0-9]{10}$/,examples:["1234567890"],maxLength:10},KZ:{prefix:"",regex:/^[0-9]{12}$/,examples:["123456789123"],maxLength:12},LI:{prefix:"CH",regex:/^CHE[0-9]{9}(TVA|MWST|IVA)$/,examples:["CHE123456789TVA","CHE123456789MWST","CHE123456789IVA"],maxLength:16},LT:{prefix:"LT",regex:/^LT([0-9]{9}|[0-9]{12})$/,examples:["LT123456789","LT123456789012"],maxLength:14},LU:{prefix:"LU",regex:/^LU[0-9]{8}$/,examples:["LU12345678"],maxLength:10},LV:{prefix:"LV",regex:/^LV[0-9]{11}$/,examples:["LV12345678901"],maxLength:13},MD:{prefix:"",regex:/^[0-9]{7}$/,examples:["1234567"],maxLength:7},MT:{prefix:"MT",regex:/^MT[0-9]{8}$/,examples:["MT12345678"],maxLength:10},MY:{prefix:"A",regex:/^[A-Z]{1}[0-9]{14}$/,examples:["A12345678901234"],maxLength:15},NL:{prefix:"NL",regex:/^NL[0-9]{9}B[0-9]{2}$/,examples:["NL123456789B01"],maxLength:14},NO:{prefix:"NO",regex:/^NO[0-9]{9}(MVA)?$/,examples:["NO123456789","NO123456789MVA"],maxLength:14},NZ:{prefix:"",regex:/^[0-9]{8,9}$/,examples:["123456789","12345678"],maxLength:9},OM:{prefix:"OM",regex:/^OM[0-9]{10}$/,examples:["OM1234567890"],maxLength:12},PE:{prefix:"",regex:/^[0-9]{11}$/,examples:["12345678912"],maxLength:11},PH:{prefix:"",regex:/^[0-9]{3}-[0-9]{3}-[0-9]{3}-[0-9]{3}$/,examples:["000-123-456-001"],maxLength:15},PL:{prefix:"PL",regex:/^PL[0-9]{10}$/,examples:["PL1234567890"],maxLength:12},PT:{prefix:"PT",regex:/^PT[0-9]{9}$/,examples:["PT123456789"],maxLength:11},RO:{prefix:"RO",regex:/^RO[0-9]{2,10}$/,examples:["RO12","RO1234567890"],maxLength:12},SA:{prefix:"",regex:/^[0-9]{15}$/,examples:["123456789012345"],maxLength:15},SE:{prefix:"SE",regex:/^SE[0-9]{12}$/,examples:["SE123456789012"],maxLength:14},SG:{prefix:"",regex:/^[0-9A-Z]{10}$/,examples:["RG12345678"],maxLength:10},SI:{prefix:"SI",regex:/^SI[0-9]{8}$/,examples:["SI12345678"],maxLength:10},SK:{prefix:"SK",regex:/^SK[0-9]{10}$/,examples:["SK1234567890"],maxLength:12},TH:{prefix:"",regex:/^[0-9]{13}$/,examples:["1234567890123"],maxLength:13},TR:{prefix:"",regex:/^[0-9]{10}$/,examples:["1234567890"],maxLength:10},TW:{prefix:"",regex:/^[0-9]{8}$/,examples:["12345678"],maxLength:8},TZ:{prefix:"",regex:/^[0-9]{8}[A-Z]$/,examples:["12345678A"],maxLength:9},UA:{prefix:"",regex:/^([0-9]{9}|[0-9]{12})$/,examples:["123456789012","123456789"],maxLength:12},UZ:{prefix:"",regex:/^[0-9]{9}$/,examples:["123456789"],maxLength:9},ZW:{prefix:"1",regex:/^1[0-9]{7}$/,examples:["12345678"],maxLength:8}};function me(e,t){return!t.trim().length||(t=t.replace(/\s+/g,""),!!he[e]&&he[e].regex.test(t))}function _e(e){var t,r,a;const n=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/business/transition-model",s=null!==(r=null==e?void 0:e.routeParams)&&void 0!==r?r:{},o=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new i.AjaxURL(i.replacePattern(n,s),o)}class ye{constructor(e,t,r,a,n,i,s){this.plan_ids=e,this.schedule_ids=t,this.license_ids_and_counts=r,this.currencies=a,this.country_code=n,this.zip_code=i,this.vat_id=s,this.renew=!1,this.discount_ratio=0,this.discount_allow_monthly=!1}set_only_license_count(e){const t=Object.keys(this.license_ids_and_counts)[0];this.license_ids_and_counts[t]=e}get_only_license_count(){const e=Object.keys(this.license_ids_and_counts)[0];return this.license_ids_and_counts[e]}set_country_code(e){this.country_code=e}set_zip_code(e){this.zip_code=e}set_currencies(e){this.currencies=e}set_renew(e){this.renew=e}set_discount_ratio(e){this.discount_ratio=e}set_discount_allow_monthly(e){this.discount_allow_monthly=e}set_vat_id(e){""!==e&&me(this.country_code||"",e)?this.vat_id=e:this.vat_id=""}cache_key(e=!1){let t;return this.currencies&&!e&&(t=this.currencies.join(",")),[this.plan_ids.join(","),this.schedule_ids.join(","),this.get_only_license_count(),t,this.country_code,this.zip_code,this.vat_id,this.renew,this.discount_ratio].join(":")}to_json(){return{...this.renew?{renew:1}:{},plan_ids:JSON.stringify(this.plan_ids),schedule_ids:JSON.stringify(this.schedule_ids),license_ids_and_counts:JSON.stringify(this.license_ids_and_counts),currencies:this.currencies?JSON.stringify(this.currencies):"",country_code:this.country_code,zip_code:this.zip_code,vat_id:this.vat_id,discount_percentage:JSON.stringify(100*this.discount_ratio),discount_allow_monthly:this.discount_allow_monthly}}static from_transition_view_models(e){const t=[],r=[],a=[];let n,i=null,s=null,o=null;for(const u of e){let e;if(t.push(u.state.plan.id),r.push(u.state.schedule.id),a.push(u.state.currency),void 0===n){for(e of(n={},u.state.allocated_licenses))n[e.license_id]=e.license_count;d.isObject(u.read_only_invoice)&&(i=u.read_only_invoice.tax_country_code||null,s=u.read_only_invoice.tax_exclusion_id||null,o=u.read_only_invoice.tax_zip_code||null)}else{for(e of(l.assert(u.state.allocated_licenses.length===Object.keys(n).length,"License sets differ"),u.state.allocated_licenses))l.assert(n.hasOwnProperty(`${e.license_id}`),"License sets differ"),l.assert(n[e.license_id]===e.license_count,"License count must match");l.assert(i===(u.read_only_invoice&&u.read_only_invoice.tax_country_code||null),"country code must match"),l.assert(o===(u.read_only_invoice&&u.read_only_invoice.tax_zip_code||null),"zip code must match"),l.assert(s===(u.read_only_invoice&&u.read_only_invoice.tax_exclusion_id||null),"VAT ID must match")}}return new ye(d.uniq(t),d.uniq(r),n||{},d.uniq(a),i,o,s)}}class fe{constructor(e){if(this.transition_view_model=e,this.transition_view_model.read_only_invoice?this.current_total=R.fromObject(this.transition_view_model.read_only_invoice.total):this.current_total=new R(0,this.transition_view_model.state.currency),this.price_token=this.transition_view_model.expected_price,this.transition_view_model.state.per_license_prices.length?this.per_license_price=R.fromObject(this.transition_view_model.state.per_license_prices[0].price):this.per_license_price=new R(0,this.transition_view_model.state.currency),this.recurring_total=R.fromObject(this.transition_view_model.state.total_recurring_price),this.transition_view_model.prices?this.tax=R.fromObject(this.transition_view_model.prices.tax):this.tax=new R(0,this.recurring_total.currency),this.transition_view_model.total_recurring_taxes?this.recurring_tax=R.fromObject(this.transition_view_model.total_recurring_taxes):this.recurring_tax=new R(0,this.recurring_total.currency),this.recurring_total_tax=this.recurring_total.add(this.recurring_tax),this.tax_percentage=0,this.transition_view_model.read_only_invoice){const{line_items:e}=this.transition_view_model.read_only_invoice,t=e.length>0?e[0]:void 0;t&&!d.isEmpty(t.country_tax_percentage)?this.tax_percentage=parseFloat(t.country_tax_percentage):t&&!d.isEmpty(t.state_tax_percentage)&&(this.tax_percentage=parseFloat(t.state_tax_percentage))}}}class ge{constructor(e){this.has_inflight_request=()=>Object.keys(this.transition_view_model_requests).length>0,this.add_to_cache=(e,t=!1)=>{const r=ye.from_transition_view_models(e).cache_key(t),a=e.map((e=>new fe(e)));return this.transition_info_cache[r]=a,a},this.get_transition_info_for=e=>this.transition_info_cache.hasOwnProperty(e)?this.transition_info_cache[e]:null,this.default_transition_view_models=e,this.transition_view_model_requests={},this.transition_info_cache={},this.add_to_cache(this.default_transition_view_models)}get(e,t,r){const a=ye.from_transition_view_models(this.default_transition_view_models);t.total_users&&a.set_only_license_count(t.total_users),t.country_code&&a.set_country_code(t.country_code),t.currency&&a.set_currencies([t.currency]),!0===t.remove_currency&&a.set_currencies([]),t.zip_code&&a.set_zip_code(t.zip_code),d.isBoolean(t.renew)&&a.set_renew(t.renew),(t.vat_id||""===t.vat_id)&&a.set_vat_id(t.vat_id),t.discount_ratio&&a.set_discount_ratio(t.discount_ratio),d.isBoolean(t.discount_allow_monthly)&&a.set_discount_allow_monthly(t.discount_allow_monthly);const n=a.cache_key(),s=this.get_transition_info_for(n);if(s)e(s);else if(!this.transition_view_model_requests[n])return this.transition_view_model_requests[n]=!0,i.SilentBackgroundRequest$1({url:_e(),type:"GET",dataType:"json",data:a.to_json(),subject_user:o.getActiveUserId(),success:r=>{delete this.transition_view_model_requests[n];const a=this.add_to_cache(r,t.remove_currency);e(a)},error:e=>{d.isFunction(r)&&r(e),delete this.transition_view_model_requests[n]}})}}const Se=d.debounce(((e,t)=>{e(function(e){return{type:"UpdateRecentLoadEventStatus",recentLoadEventStatus:e}}(t))}),400),Pe=new de,Te=d.debounce(((e,t,r,a,n,i)=>{const s={discountPercentage:100*n,discountAllowMonthly:i,selectedAddonIds:[]};let o;if(t.currentPlanSku){const e=new F({});e.setPlan(t.currentPlanSku),e.setTotalLicenses(r),o=[e]}else o=t.subChangePlans.plans.map((e=>{const t=F.fromSubscriptionStatus(e);return t.setTotalLicenses(r),t}));Pe.priceSet(o,a,s,!1,!0).then((t=>{if(t){const r=t.filter((e=>e instanceof Y));!function(e,t){e({type:"UpdateTransitionsSuccess",subChangePlans:t}),Se(e,!1)}(e,r)}})).catch((t=>{e(function(e){return{type:"UpdateTransitionsError",error:e}}(t))}))}),400),ve=d.debounce(((e,t,r)=>{const a=l.URI.parse(i.get_href()).getQuery().modal,n={zip_code:t,vat:r,is_pricing_only:!0,is_multi_seat:!0,update_billing_mode:a&&"string"==typeof a?a:""};T(new i.DefaultUserApiV2Client(i.mustGetActiveUserApiV2Properties())).rpc("get_update_billing_modal_info",n,{}).then((({subscription_data:t})=>{t&&e({type:"UpdateBillingPriceSuccess",subscriptionData:t})})).catch((t=>e({type:"UpdateBillingPriceError",error:t})))}),600),xe=d.debounce(((e,t,r,n,i)=>{const{transition:s}=t().pageState,o=new ge([s]),c={total_users:n,country_code:i.countryCode,zip_code:i.zipCode,vat_id:i.vat,renew:!0};o.get((t=>{const r=t[0].transition_view_model;e(function(e){return{type:"UpdateRenewTransitionsSuccess",transition:e}}(r))}),c,(t=>{u.Notify.error(a.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),e(function(e){return{type:"UpdateRenewTransitionsError",error:e}}(t))}))}),600);function Ae(e=!1,t=!1){return(r,a)=>{const{formData:i,pricingState:s,pageState:o}=a();if(t){const e=i.zipCode.rawValue,t=i.vat.errorState?"":i.vat.formattedValue;r({type:"UpdateBillingPriceStart"}),ve(r,e,t)}else{const{discountInfo:t}=s,{transition:u}=o;let c,l;if(i.numberOfUsers)c=i.numberOfUsers.formattedValue;else{if(!u||1!==(null==u?void 0:u.state.allocated_licenses.length)||!(null==u?void 0:u.state.allocated_licenses[0].license_count))return void n.reportStack("License count should not be undefined when updating pricing",{severity:n.SEVERITY.NONCRITICAL,tags:["pricing_actions_update_price"]});c=null==u?void 0:u.state.allocated_licenses[0].license_count}let d=!0;t&&(l=t.discountRatio,d=t.allowMonthly);const p={countryCode:i.countryCode.formattedValue,zipCode:i.zipCode.rawValue,vat:i.vat.errorState?"":i.vat.formattedValue};e?(r({type:"UpdateRenewTransitionsStart"}),xe(r,a,s,c,p)):(r({type:"UpdateTransitionsStart"}),Te(r,s,c,p,l,d))}}}t.FormValueHelper=void 0,function(e){function t(e){return!!e.serverError}e.isValid=function(e){return 0===e.errorState},e.hasServerError=t,e.shouldShowError=function(r){return(!e.isValid(r)||t(r))&&r.showError},e.getFormErrorMessage=function(r,a){return t(r)?P.default.createElement("span",{dangerouslySetInnerHTML:{__html:u.purify.sanitize(r.serverError)}}):e.isValid(r)?"":a}}(t.FormValueHelper||(t.FormValueHelper={}));const Ee=(e,t)=>{if(t===i.Variant.OFF)return;const r={growthbookVariantInfo:{feature:e,variant:t}};i.logExplicitExposure(r)};var be,Ce,Ie;t.PaymentMethod=void 0,(be=t.PaymentMethod||(t.PaymentMethod={}))[be.CreditCard=1]="CreditCard",be[be.PayPal=2]="PayPal",be[be.DirectDeposit=3]="DirectDeposit",be[be.Ideal=5]="Ideal",be[be.ApplePay=6]="ApplePay",be[be.DlocalRBI=9]="DlocalRBI",be[be.NoPayment=10]="NoPayment",function(e){e.DirectDebit="direct_debit",e.ApplePay="apple_pay",e.GooglePay="google_pay",e.ACH="ach",e.Other="other"}(Ce||(Ce={})),function(e){e.FlexibleCheckout="flexible_checkout",e.UnifiedCheckout="unified_checkout",e.UpdateBilling="update_billing"}(Ie||(Ie={}));const we=[Ie.FlexibleCheckout,Ie.UnifiedCheckout];function Ne(){return window.top!==window.self}function Le(){if("undefined"==typeof window||"undefined"==typeof document)return!1;const e="undefined"!=typeof window?window:void 0,t=null==e?void 0:e.isSecureContext;return void 0!==t&&Boolean(t)}const ke={accountHolderName:"owner_name",adyenEncryptedCard:"adyen_encrypted_card",encryptedCardForNetworkToken:"encrypted_card_for_network_token",bin:"bin",birthDay:"birthDay",birthMonth:"birthMonth",birthYear:"birthYear",browserInfo:"browser_info",threeDsData:"three_ds_data",captcha:"recaptcha_response",companySize:"company_size",countryCode:"country_code",cpf:"cpf",cpfName:"cpf_name",email:"email",emailsToInvite:"emails_to_invite",firstName:"fname",iban:"iban",idealBankId:"bank_id",idealBankName:"bank_name",lastName:"lname",mandateSigned:"mandate_signed",marketingOptIn:"marketing_opt_in",nonce:"nonce",numberOfUsers:"team_num_users",password:"password",paymentMethod:"payment_method",paypalNonce:"paypal_nonce",schedule:"schedule_id",scheduleId:"schedule_id",selectedUser:"selected_user",teamName:"team_name",teamPhone:"team_phone",termsAndService:"tos_agree",vat:"vat",declarationConfirmation:"declaration_confirmation",zipCode:"zip",city:"city",phone:"phone",name:"name",address:"address",applePayToken:"apple_pay_token",pan:"pan",addressStreet:"address_street",addressNumber:"address_number"};for(const e of Object.keys(ke));class De{constructor(e){this.request=()=>{i.WebRequest({url:this.options.url,type:null!=this.options.type?this.options.type:void 0,data:this.options.data||{},success:this.success,complete:this.complete,error:this.error,...this.subjectUserIfPresent()})},this.subjectUserIfPresent=()=>this.options.subject_user?{subject_user:this.options.subject_user}:{},this.success=(e,t,r)=>{const a=this.extractErrors(r.responseText);if(a)return this.handleErrors(a),void("function"==typeof this.options.error&&this.options.error(r,t,a));!(e=JSON.parse(r.responseText)).redirect||this.options.is_framed?e.reload?i.reload():(this.performActions(e.actions||[]),"function"==typeof this.options.success&&this.options.success(e,t,r)):i.unsafeRedirect(e.redirect)},this.performActions=e=>(()=>{const t=[];for(const r of Array.from(e)){const[e,a]=Array.from(r);switch(e){case"notify":t.push(u.Notify.success(a));break;case"notifyError":t.push(u.Notify.error(new u.HTML(a),this.options.errorDuration||void 0));break;default:t.push(void 0)}}return t})(),this.extractErrors=e=>{if(0!==e.indexOf("err:"))return!1;e=e.substr(4);try{return JSON.parse(e)}catch(t){return"string"==typeof e?e:a.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})}},this.error=(e,t,r)=>{const a=this.extractErrors(e.responseText);return"abort"!==t&&this.handleErrors(a),"function"==typeof this.options.error?this.options.error(e,t,r):void 0},this.handleErrors=e=>!1===e?u.Notify.error(a.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})):"string"==typeof e?u.Notify.error(e):void 0,this.complete=(e,t)=>"function"==typeof this.options.complete?this.options.complete(e,t):void 0,null==e&&(e={}),this.options=e}}function Me(e){var t,r,a;const n=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/get_viewer",s=null!==(r=null==e?void 0:e.routeParams)&&void 0!==r?r:{},o=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new i.AjaxURL(i.replacePattern(n,s),o)}const Re=async(e=!1)=>{if(!e){const e=await i.fetchViewer();l.assert(!e.is_signed_in,"Attempted to use dangerousDoNotUseDeprecatedRefreshViewerAfterLogin but already logged in")}const t=await new Promise(((e,t)=>i.WebRequest({url:Me(),success:r=>{try{e(JSON.parse(r))}catch(e){t({error:e})}},error:(e,r,a)=>{t({error:a})}}))),r=(t._user_data||[]).find((({id:e})=>e===t.active_user_id));!function(e){const t=o.getInitData();e={...t.authRequestInfo||{},...e},o.init({...t,authRequestInfo:new o.AuthRequestInfo(e)})}({activeUser:new o.User({id:o.protoInt64.parse(t.active_user_id||"0"),rootNsId:o.protoInt64.parse((null==r?void 0:r.root_ns_id)||"0")}),activeTeam:new o.Team({id:o.protoInt64.parse(t.team_id||"0")}),authRole:Number(t.auth_role||"0"),authActionType:Number(t.auth_action_type||"0")}),await i.invalidateViewer()},Ue="/checkout/update_billing_info",Be="/checkout/update_billing_info/multi_seat";var Oe,Fe;function Ve(e,t,r){if(!e||!t||!r)return null;const a=Number(e),n=Number(t),i=Number(r);return Date.UTC(i,n-1,a)/1e3}function je(){const e=l.URI.parse(i.get_href()).getQuery();return e.modal||e.update_billing_mode||""}!function(e){e.BlurEmail="BlurEmail",e.ClickGoogleSignup="ClickGoogleSignup",e.EnablePurchaseButton="EnablePurchaseButton",e.SubmitFormStart="SubmitFormStart",e.SubmitFormSuccess="SubmitFormSuccess",e.SubmitFormError="SubmitFormError",e.ShowFormFieldErrors="ShowFormFieldErrors",e.SubmitCaptcha="SubmitCaptcha",e.TriggerCaptcha="TriggerCaptcha",e.CaptchaShown="CaptchaShown",e.UpdateTransitions="UpdateTransitions",e.UpdateSchedule="UpdateSchedule",e.UpdateProductPlanType="UpdateProductPlanType",e.UpdateNumberOfUsers="UpdateNumberOfUsers",e.UpdateFirstName="UpdateFirstName",e.UpdateLastName="UpdateLastName",e.UpdateEmail="UpdateEmail",e.UpdatePassword="UpdatePassword",e.UpdateTeamName="UpdateTeamName",e.UpdateTeamPhone="UpdateTeamPhone",e.UpdateCompanySize="UpdateCompanySize",e.UpdatePaymentMethod="UpdatePaymentMethod",e.UpdateCountryCode="UpdateCountryCode",e.UpdateZipCode="UpdateZipCode",e.BlurZipCode="BlurZipCode",e.UpdateVat="UpdateVat",e.BlurVat="BlurVat",e.UpdateVatProvincial="UpdateVatProvincial",e.BlurVatProvincial="BlurVatProvincial",e.UpdateDeclarationConfirmation="UpdateDeclarationConfirmation",e.UpdateCpf="UpdateCpf",e.BlurCpf="BlurCpf",e.UpdateCpfName="UpdateCpfName",e.UpdateNonce="UpdateNonce",e.UpdatePayPalNonce="UpdatePayPalNonce",e.BlurCCField="BlurCCField",e.UpdateAdyenEncryptedCard="UpdateAdyenEncryptedCard",e.UpdateEncryptedCardForNetworkToken="UpdateEncryptedCardForNetworkToken",e.UpdateBrowserInfo="UpdateBrowserInfo",e.UpdateThreeDsData="UpdateThreeDsData",e.TriggerThreeDsChallenge="TriggerThreeDsChallenge",e.TriggerThreeDsFingerprint="TriggerThreeDsFingerprint",e.UpdateBIN="UpdateBIN",e.UpdateAccountHolderName="UpdateAccountHolderName",e.BlurAccountHolderName="BlurAccountHolderName",e.UpdateIBAN="UpdateIBAN",e.BlurIBAN="BlurIBAN",e.UpdateMandateSigned="UpdateMandateSigned",e.UpdateIdealBank="UpdateIdealBank",e.UpdateMarketingOptIn="UpdateMarketingOptIn",e.UpdateTermsAndService="UpdateTermsAndService",e.UpdateEmailsToInvite="UpdateEmailsToInvite",e.EmailCapturedError="EmailCapturedError",e.EmailTakenError="EmailTakenError",e.EmailTakenWarning="EmailTakenWarning",e.PaymentBannerError="PaymentBannerError",e.UpdateApplePayToken="UpdateApplePayToken",e.ApplePayStartup="ApplePayStartup",e.ApplePayFlowType="ApplePayFlowType",e.ApplePayPopupShown="ApplePayPopupShown",e.ApplePayClosedByFailure="ApplePayPopupCloseByFailure",e.ApplePayError="ApplePayError",e.ApplePayClosedBySuccess="ApplePayClosedBySuccess",e.UpdateSelectedAddons="UpdateSelectedAddons",e.UpdateBirthDay="updateBirthDay",e.UpdateBirthMonth="updateBirthMonth",e.UpdateBirthYear="updateBirthYear",e.UpdatePan="UpdatePan",e.UpdateName="UpdateName",e.UpdateAddressNumber="UpdateAddressNumber",e.UpdateAddressStreet="UpdateAddressStreet",e.BlurPan="BlurPan",e.BlurName="BlurName",e.BlurAddressNumber="BlurAddressNumber",e.BlurAddressStreet="BlurAddressStreet",e.UpdateInvoiceBusinessName="UpdateInvoiceBusinessName",e.UpdateInvoiceStreetAddress="UpdateInvoiceStreetAddress",e.UpdateInvoiceCity="UpdateInvoiceCity",e.UpdateInvoiceProvince="UpdateInvoiceProvince",e.BlurInvoiceBusinessName="BlurInvoiceBusinessName",e.BlurInvoiceStreetAddress="BlurInvoiceStreetAddress",e.BlurInvoiceCity="BlurInvoiceCity",e.BlurInvoiceProvince="BlurInvoiceProvince",e.PaymentsWebRequestErrorCallbackTriggered="PaymentsWebRequestErrorCallbackTriggered"}(Oe||(Oe={})),t.SubmitFormTriggerType=void 0,(Fe=t.SubmitFormTriggerType||(t.SubmitFormTriggerType={})).ButtonClick="button_click",Fe.RecaptchaV2="recaptcha_v2",Fe.ThreeDsChallenge="three_ds_challenge",Fe.ThreeDsFingerprint="three_ds_fingerprint";const qe={zipCode:"zip",promo_ids:"promoIds",total_price:"totalPrice",encryptedCardForNetworkToken:"networkTokenEncryptedCard",idealBankId:"bankId",idealBankName:"bankName",accountHolderName:"ownerName"},$e=["zip","vat","country","countryCode","currency","code","dcode","promoIds","totalPrice","declarationConfirmation","invoiceBusinessName","invoiceStreetAddress","invoiceCity","invoiceProvince"],ze=["currency","code","dcode","promo_ids","total_price"],He=["ccn","ccode","expmo","expyr","bin","cpf","cpfName","adyenEncryptedCard","networkTokenEncryptedCard","threeDsData","browserInfo","deviceData","cardType","nonce"],Ye=["name","pan","addressStreet","addressNumber"],Ge=["payerId","token","hasGatewayToken","paypalNonce"],Ze=["iban","ownerName","mandateSigned"],Qe=["bankId","bankName"],Je=["applePayToken"],Xe=["companySize","teamName","teamPhone","numberOfUsers"];function We(e,r,a,s,o=[],u=!1,c=""){const l={},d={},p={};for(const e of r){const t=a[e];p[qe[e]||e]=t.formattedValue}for(const e of ze){const t=s[e];p[qe[e]||e]=t}switch($e.filter((e=>p.hasOwnProperty(e))).forEach((e=>l[e]=p[e])),a.paymentMethod.formattedValue){case t.PaymentMethod.CreditCard:{l.paymentMethod=i.StorefrontPlatformPaymentMethod.PAYMENT_CARD;const e={};He.filter((e=>p.hasOwnProperty(e))).forEach((t=>e[t]=p[t]));const t=new g.CreditCardSpecificPurchaseUserInput(e);l.paymentMethodSpecificUserInput={value:t,case:"creditCardSpecificPurchaseUserInput"};break}case t.PaymentMethod.DlocalRBI:{l.paymentMethod=i.StorefrontPlatformPaymentMethod.DLOCAL_RBI;const e={};Ye.filter((e=>p.hasOwnProperty(e))).forEach((t=>e[t]=p[t]));const t=new g.DlocalRBISpecificPurchaseUserInput(e);l.paymentMethodSpecificUserInput={value:t,case:"dlocalRbiSpecificPurchaseUserInput"};break}case t.PaymentMethod.PayPal:{l.paymentMethod=i.StorefrontPlatformPaymentMethod.PAYPAL;const e={};Ge.filter((e=>p.hasOwnProperty(e))).forEach((t=>e[t]=p[t]));const t=new g.PaypalSpecificPurchaseUserInput(e);l.paymentMethodSpecificUserInput={value:t,case:"paypalSpecificPurchaseUserInput"};break}case t.PaymentMethod.DirectDeposit:{l.paymentMethod=i.StorefrontPlatformPaymentMethod.SEPA;const e={};Ze.filter((e=>p.hasOwnProperty(e))).forEach((t=>e[t]=p[t]));const t=new g.DirectDebitSpecificPurchaseUserInput(e);l.paymentMethodSpecificUserInput={value:t,case:"directDebitSpecificPurchaseUserInput"};break}case t.PaymentMethod.Ideal:{l.paymentMethod=i.StorefrontPlatformPaymentMethod.IDEAL;const e={};Qe.filter((e=>p.hasOwnProperty(e))).forEach((t=>e[t]=p[t]));const t=new g.IdealSpecificPurchaseUserInput(e);l.paymentMethodSpecificUserInput={value:t,case:"idealSpecificPurchaseUserInput"};break}case t.PaymentMethod.ApplePay:{l.paymentMethod=i.StorefrontPlatformPaymentMethod.APPLE_PAY;const e={};Je.filter((e=>p.hasOwnProperty(e))).forEach((t=>e[t]=p[t]));const t=new g.ApplePaySpecificPurchaseUserInput(e);l.paymentMethodSpecificUserInput={value:t,case:"applePaySpecificPurchaseUserInput"};break}case t.PaymentMethod.NoPayment:l.paymentMethod=i.StorefrontPlatformPaymentMethod.NO_PAYMENT;break;default:const e=`Unsupported payment method: ${a.paymentMethod.formattedValue}`;n.reportException({err:new Error(e),severity:n.SEVERITY.CRITICAL,tags:["checkout_unsupported_payment_method"]})}Xe.filter((e=>p.hasOwnProperty(e))).forEach((e=>d[e]=p[e]));return{pricingToken:e,purchaseUserInput:new g.PurchaseUserInput(l),purchaseTeamInput:new g.PurchaseTeamInput(d),products:o,useExistingPayment:u,storefrontPlatformConfigToken:c}}const Ke=new Set(["firstName","lastName","email","password","promoIds","requestId","scheduleId","submitSeq","termsAndService","marketingOptIn","birthDay","birthMonth","birthYear"]);var et;t.PortableCheckoutOutboundMessageType=void 0,(t.PortableCheckoutOutboundMessageType||(t.PortableCheckoutOutboundMessageType={})).READY="READY",t.PortableCheckoutInboundMessageType=void 0,(et=t.PortableCheckoutInboundMessageType||(t.PortableCheckoutInboundMessageType={})).SUCCESSFUL_PURCHASE_COMPLETE="SUCCESSFUL_PURCHASE_COMPLETE",et.IFRAME_INITIALIZED="IFRAME_INITIALIZED";const tt=(e,r)=>{var a;if(e.responseText)try{const r=JSON.parse(e.responseText);if(r.payment_result){const e={message_type:t.PortableCheckoutInboundMessageType.SUCCESSFUL_PURCHASE_COMPLETE};null===(a=window.parent)||void 0===a||a.postMessage(e,window.location.origin)}else if(r.redirect)return void i.unsafeRedirect(r.redirect,window.top)}catch(e){return}};function rt(e){return{type:Oe.SubmitFormError,data:e}}function at(){return{type:Oe.SubmitCaptcha}}function nt(e,t){return{type:Oe.ShowFormFieldErrors,fieldNames:e,origin:t}}function it(){return{type:Oe.EmailTakenError}}function st(){return{type:Oe.EmailCapturedError}}function ot(e){return{type:Oe.PaymentBannerError,msg:e}}function ut(e){return{type:Oe.ApplePayClosedByFailure,msg:e}}function ct(e){return{type:Oe.UpdateApplePayToken,value:e}}function lt(e){return{type:Oe.UpdateThreeDsData,value:e}}function dt(e,r){return 0===function(e,r){const a=[];for(const n of r){const r=e[n];t.FormValueHelper.isValid(r)||a.push(n)}return a}(e,r).length}const pt=a.defineMessages({header:{id:"m+ZGp8",defaultMessage:"Order Summary"},summary:{id:"iapC9d",defaultMessage:"Summary"},loading:{id:"idKJbp",defaultMessage:"Loading Order Summary"},subtotalPrice:{id:"2dRYCe",defaultMessage:"Subtotal"},trialPrice:{id:"RFDTxf",defaultMessage:"<strike>{basePrice}</strike> <free>FREE</free>"},yearlySubscription:{id:"8BxGTp",defaultMessage:"Yearly subscription"},monthlySubscription:{id:"fzF3+c",defaultMessage:"Monthly subscription"},total:{id:"Vj8SCm",defaultMessage:"Total"},billedNowPrice:{id:"XYyI20",defaultMessage:"Billed now"},billedTrialEndPrice:{id:"692zwC",defaultMessage:"Total"},trialEndsDate:{id:"AM9xOF",defaultMessage:"Trial ends {trialEndDate}"},promoLineItemLimited:{id:"D3M17o",defaultMessage:"Limited-time offer"},promoFreeMonths:{id:"EDzII1",defaultMessage:"+ {freeMonths, plural, one{# month} other{# months}} free with your first year"},percentDiscountMonthly:{id:"fCyWzN",defaultMessage:"{planName} discount ({discount, number, ::percent .##} off your first {numMonths, plural, one{# month} other{# months}})"},percentDiscountYearly:{id:"TuiQ5u",defaultMessage:"{planName} discount ({discount, number, ::percent .##} off {numYears, plural, one{# year} other{# years}})"},percentDiscountSavings:{id:"avUgyF",defaultMessage:"Save {discount, number, ::percent .##} with a {isYearly, select, yes {yearly} other {monthly}} subscription"},volumeDiscountSavings:{id:"ZSGzg0",defaultMessage:"Save {discount, number, ::percent .##} when you buy {minimumLicenseQuantity} or more licenses"},percentDiscountCode:{id:"EqlvfQ",defaultMessage:"{planName} discount ({discount, number, ::percent .##} off)"},promoExpirationDate:{id:"P3DEnh",defaultMessage:"Must claim by {promoExpirationDate}"},priceBeingSubtracted:{id:"ZE382A",defaultMessage:"-{subtractedPrice}"},withheldTaxName:{id:"p620Oo",defaultMessage:"Withheld {taxName}"},withheldTaxNameAndRate:{id:"u4ITaA",defaultMessage:"Withheld {taxName} ({taxRate, number, ::percent .##})"},taxNameAndRate:{id:"oxuROY",defaultMessage:"{taxName} ({taxRate, number, ::percent .##})"},perUserPerMonthPrice:{id:"cN98h4",defaultMessage:"{numberOfUsers} users ({perUserPerMonthPrice} per user per month)"},numUsers:{id:"RNbUc6",defaultMessage:"{numberOfUsers} users"},formattedLicensePrice:{id:"727Ja/",defaultMessage:"{numberOfUsers} x {pricePerLicense}"},licensesBeingPurchased:{id:"BOFEVc",defaultMessage:"{numberOfLicenses, plural, one{# license} other{# licenses}}"},licenseBasedAddonDisplayName:{id:"21+El5",defaultMessage:"{addonName} x {numberOfLicenses}"},estimatedLocalCurrencyTotalAmount:{id:"exnpO/",defaultMessage:"**Estimated amount {estimatedLocalCurrencyTotalAmount}"},estimatedLocalCurrencyDisclosure:{id:"hzjX/8",defaultMessage:"**Estimated amount is displayed for your convenience with FX Rate of {estimatedLocalCurrencyConversionRate} to 1 USD. The actual charge for the initial purchase and ongoing renewals shown on your bank statement may vary due to FX Rates fluctuations."},freeBilledPrice:{id:"tYjCsi",defaultMessage:"FREE"},teamMembers:{id:"7yFaN1",defaultMessage:"Team members"},licenses:{id:"2+UEH+",defaultMessage:"Licenses"},billingCycle:{id:"Xf7F5g",defaultMessage:"Billing Cycle"},billingPeriod:{id:"tKWoAx",defaultMessage:"Billing period"},yearly:{id:"Lci7Gy",defaultMessage:"Yearly"},monthly:{id:"9lC3+v",defaultMessage:"Monthly"},featureListBanner:{id:"jr0rJc",defaultMessage:"What's included in your plan"},xDayFreeTrial:{id:"OdNQs8",defaultMessage:"{trialDuration} day free trial"},xDaysFreeTrial:{id:"B3fXrI",defaultMessage:"{pro_trial_days} days free"},billedOn:{id:"sqSTsL",defaultMessage:"Billed on {charge_date}"},billedToday:{id:"NqeG1u",defaultMessage:"Billed today"},trialChargeDateDisclaimer:{id:"QtfeHY",defaultMessage:"We won't charge you until your free trial ends on {charge_date}"},orderSummaryChargeDateTooltipLabel:{id:"OsITTA",defaultMessage:"Show more information about when you'll be charged"}});t.CHECKOUT_UPDATE_BILLING_INFO=Ue,t.CHECKOUT_UPDATE_BILLING_INFO_MULTI_SEAT=Be,t.Cash=R,t.CashUtil=k,t.GetCheckoutRoutes=T,t.GetUrlForCheckoutAjaxPricing=function(e){var t,r,a;const n=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/checkout/ajax_pricing",s=null!==(r=null==e?void 0:e.routeParams)&&void 0!==r?r:{},o=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new i.AjaxURL(i.replacePattern(n,s),o)},t.GetUrlForGetBraintreeToken=function(e){var t,r,a;const n=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/payments/braintree_token",s=null!==(r=null==e?void 0:e.routeParams)&&void 0!==r?r:{},o=null!==(a=null==e?void 0:e.base)&&void 0!==a?a:window.location.origin;return new i.AjaxURL(i.replacePattern(n,s),o)},t.PaymentFormSpec=class{constructor(e,t,r,a){this.isQRCodeFlowEnabled=!1,this.spec=e,this.applePayEligibilitySource=t,this.projectApplePay=null!=r?r:i.Variant.OFF,this.applePayQRCodeFlowVariant=null!=a?a:i.Variant.OFF,this.isQRCodeFlowEnabled=a===i.Variant.ON;const n=y.is_android()&&y.is_mobile_or_tablet(),s=this.applePayEligibilitySource===Ie.UnifiedCheckout&&we.includes(this.applePayEligibilitySource);this.projectApplePay===i.Variant.V2&&s&&!Ne()&&!n&&Le()&&Ee("max_2026_01_15_apple_pay_qr_code_flow",this.applePayQRCodeFlowVariant),!Ne()&&function(e=i.Variant.OFF,t=!1){if(y.is_android()&&y.is_mobile_or_tablet())return!1;const r=window.ApplePaySession;try{return e===i.Variant.V2&&t?Le():!!["function","object"].includes(typeof r)&&"function"==typeof r.canMakePayments&&!!r.canMakePayments()}catch{return!1}}(r,this.isQRCodeFlowEnabled)&&t&&we.includes(t)&&this.projectApplePay!==i.Variant.OFF?this.applePayEligibilitySource===Ie.FlexibleCheckout?"V1"===this.projectApplePay||"V2"===this.projectApplePay?Ee("subscriptions_2025_10_07_project_apple_pay_m2",this.projectApplePay):Ee("subscriptions_2025_07_07_project_apple_pay",this.projectApplePay):this.applePayEligibilitySource===Ie.UnifiedCheckout&&("V1"===this.projectApplePay||"V2"===this.projectApplePay?Ee("max_2025_11_25_unified_checkout_apple_pay_m2",this.projectApplePay):Ee("purse_2025_09_09_unified_checkout_apple_pay",this.projectApplePay)):this.hide_apple_pay()}hide_apple_pay(){this.spec.default_available_payment_methods=this.remove_apple_pay(this.spec.default_available_payment_methods);for(const e in this.spec.available_payment_methods_overrides_by_country)this.spec.available_payment_methods_overrides_by_country[e]=this.remove_apple_pay(this.spec.available_payment_methods_overrides_by_country[e])}isTeam(){return this.spec.is_team}idealBanks(){return this.spec.ideal_banks}available_payment_methods_for_country(e){var t;return(null===(t=this.spec.available_payment_methods_overrides_by_country)||void 0===t?void 0:t[e])?this.spec.available_payment_methods_overrides_by_country[e]:this.only_default_payment_methods()}only_default_payment_methods(){return this.spec.default_available_payment_methods}remove_apple_pay(e){var r;const a=null!==(r=null==e?void 0:e.indexOf(t.PaymentMethod.ApplePay))&&void 0!==r?r:-1;return a>=0&&e.splice(a,1),e}default_payment_method(){return this.spec.default_available_payment_methods[0]}default_payment_method_for_country(e){var t;return null===(t=this.available_payment_methods_for_country(e))||void 0===t?void 0:t[0]}supported_credit_cards_for_country(e){var t;return(null===(t=this.spec.supported_credit_cards_overrides_by_country)||void 0===t?void 0:t[e])?this.spec.supported_credit_cards_overrides_by_country[e]:this.spec.default_supported_credit_cards}should_show_vat_for_country(e,t){var r;return(null===(r=this.spec.countries_with_vat)||void 0===r?void 0:r.indexOf(e))>-1&&(!t||this.should_show_vat_for_product(t))}should_show_vat_for_product(e){return[i.StorefrontPlatformProductType.PROFESSIONAL,i.StorefrontPlatformProductType.TRANSFER,i.StorefrontPlatformProductType.HS_DBX_PRO_BUNDLE,i.StorefrontPlatformProductType.HELLOSIGN_ESSENTIALS,i.StorefrontPlatformProductType.TEAM_BASIC,i.StorefrontPlatformProductType.STANDARD,i.StorefrontPlatformProductType.ADVANCED,i.StorefrontPlatformProductType.TEAM_SERVER,i.StorefrontPlatformProductType.HELLOSIGN_STANDARD,i.StorefrontPlatformProductType.EDUCATION,i.StorefrontPlatformProductType.ENTERPRISE,i.StorefrontPlatformProductType.HELLOSIGN_STANDARD_API,i.StorefrontPlatformProductType.DS_DBX_TEAM_BUNDLE,i.StorefrontPlatformProductType.TEAM_DEPRECATED,i.StorefrontPlatformProductType.DBX_BUSINESS,i.StorefrontPlatformProductType.DBX_BUSINESS_PLUS,i.StorefrontPlatformProductType.DASH_BUSINESS,i.StorefrontPlatformProductType.DASH_BUSINESS_STANDARD,i.StorefrontPlatformProductType.DASH_ENTERPRISE,i.StorefrontPlatformProductType.TEAM_BASE_FSS,i.StorefrontPlatformProductType.REPLAY_STANDARD,i.StorefrontPlatformProductType.REPLAY_FREEMIUM,i.StorefrontPlatformProductType.SELECT,i.StorefrontPlatformProductType.DROPBOX_OS_FREEMIUM,i.StorefrontPlatformProductType.DASH_TEAM_FREEMIUM].includes(e)}should_require_cpf(e,r){return"BR"===e&&r===t.PaymentMethod.CreditCard}allow_zip_code_for_country(e){var t;return-1===(null===(t=this.spec.countries_without_zip_code)||void 0===t?void 0:t.indexOf(e))}requires_tos(){return this.spec.require_tos}shouldHideIdealAndSepa(e,t,r){const a=t===i.StorefrontPlatformProductCategory.TRIAL&&!this.isTeam(),n=t===i.StorefrontPlatformProductCategory.TRIAL&&e===i.StorefrontPlatformProductType.PROFESSIONAL;return a||n||"USD"===r}},t.SubscriptionChangePlan=Y,t.SubscriptionDiff=F,t.SubscriptionService=de,t.SubscriptionStatus=z,t.ThreeDsHandler=class{constructor({updateThreeDsData:r,submitThreeDsChallenge:a,triggerThreeDsChallenge:i,submitThreeDsFingerprint:s,triggerThreeDsFingerprint:o,isDesktop:c,isSeleniumChangesTest:l}){this.handle3DsMessage=e=>e.challengeToken?this.adyenCheckout.then((r=>{ee(r,e.challengeToken||"",e.paymentData||"").then((r=>{const a=JSON.stringify({paymentData:e.paymentData,resultType:t.ThreeDsResultType.ChallengeShopper,result:r});this.updateThreeDsData(a),this.submitThreeDsChallenge()})),this.triggerThreeDsChallenge()})).catch((e=>{n.reportException({err:e,severity:n.SEVERITY.CRITICAL,tags:["three_ds_handler_error","three_ds_handler_show_challenge_failed"]})})):e.fingerprintToken?this.adyenCheckout.then((r=>{W(r,e.fingerprintToken||"",e.paymentData||"").then((r=>{const a=JSON.stringify({paymentData:e.paymentData,resultType:t.ThreeDsResultType.IdentifyShopper,result:r});this.updateThreeDsData(a),this.submitThreeDsFingerprint()})).catch((e=>{u.Notify.error(e)})),this.triggerThreeDsFingerprint()})).catch((e=>{n.reportException({err:e,severity:n.SEVERITY.CRITICAL,tags:["three_ds_handler_error","three_ds_handler_fingerprint_failed"]})})):(void 0===e.challengeToken&&void 0===e.fingerprintToken||n.reportException({err:new Error("Both the fingerprintToken and the challengeToken were empty"),severity:n.SEVERITY.CRITICAL,tags:["three_ds_handler_error","three_ds_2_message_malformed"]}),null),this.updateThreeDsData=r,this.submitThreeDsChallenge=a,this.triggerThreeDsChallenge=i,this.submitThreeDsFingerprint=s,this.triggerThreeDsFingerprint=o,this.adyenCheckout=function(t,r,a,n){return new Promise(((i,s)=>{t||n?s("loadAdyenCheckout: request made on Selenium or Desktop"):new Promise((function(t,r){e(["./c_adyen_adyen-web_adyen"],t,r)})).then((function(e){return e.adyen})).then((({default:e})=>{const t=function(e,t){let r,a;return e?(r="pub.v2.1115569318761439.aHR0cHM6Ly93d3cuZHJvcGJveC5jb20.0qcdSLg1Z9fkg0jVafTITHpHnWXMLHlN6AJNY32SBmo",a="live"):(r="pub.v2.8215476853122361.aHR0cHM6Ly9tZXRhLWxlaS1kYnguZGV2LmNvcnAuZHJvcGJveC5jb20.OyPyKCNBSA0_6dB5nYI4bOu9O-2egkLII-LayLtGbaI",a="test"),{locale:t,environment:a,originKey:r,paymentMethodsResponse:()=>{}}}(r,a),n=new e(t);i(n)})).catch((()=>{s("loadAdyenCheckout: request failed")}))}))}(l,!0,te(),c)}},t.TransitionViewModel=H,t.ZipCodeErrorMessage=v,t.applePayClosedByFailure=ut,t.applePayClosedBySuccess=function(e){return{type:Oe.ApplePayClosedBySuccess,msg:e}},t.applePayError=function(e){return{type:Oe.ApplePayError,msg:e}},t.applePayFlowType=function(e){return{type:Oe.ApplePayFlowType,msg:e}},t.applePayPopupShown=function(e){return{type:Oe.ApplePayPopupShown,msg:e}},t.applePayStartup=function(e){return{type:Oe.ApplePayStartup,msg:e}},t.blurAccountHolderName=function(e){return{type:Oe.BlurAccountHolderName,value:e}},t.blurAddressNumber=function(e){return{type:Oe.BlurAddressNumber,value:e}},t.blurAddressStreet=function(e){return{type:Oe.BlurAddressStreet,value:e}},t.blurCCField=function(e){return{type:Oe.BlurCCField,creditCardIframeFields:e}},t.blurCpf=function(e){return{type:Oe.BlurCpf,value:e}},t.blurIBAN=function(e){return{type:Oe.BlurIBAN,value:e}},t.blurInvoiceBusinessName=function(e){return{type:Oe.BlurInvoiceBusinessName,value:e}},t.blurInvoiceCity=function(e){return{type:Oe.BlurInvoiceCity,value:e}},t.blurInvoiceProvince=function(e){return{type:Oe.BlurInvoiceProvince,value:e}},t.blurInvoiceStreetAddress=function(e){return{type:Oe.BlurInvoiceStreetAddress,value:e}},t.blurName=function(e){return{type:Oe.BlurName,value:e}},t.blurPan=function(e){return{type:Oe.BlurPan,value:e}},t.blurVat=function(e){return{type:Oe.BlurVat,value:e}},t.blurVatProvincial=function(e){return{type:Oe.BlurVatProvincial,value:e}},t.blurZipCode=function(e){return{type:Oe.BlurZipCode,value:e}},t.collectBrowserInfo=re,t.constructPurchaseArgs=We,t.fieldsToServerProps=ke,t.getTaxNameForCountry=function(e,t,r){return t&&e&&t[e]?t[e]:r||a.intl.formatMessage({id:"dytYFt",defaultMessage:"Tax"})},t.getUpdateBillingMode=je,t.getVatExamples=function(e){return he[e]?he[e].examples:[]},t.getVatPrefix=function(e){return he[e]?he[e].prefix:""},t.hasVat=function(e){return!!he[e]},t.isValidSubmitState=dt,t.orderSummaryMessages=pt,t.paymentBannerError=ot,t.showFormFieldErrors=nt,t.submitForm=function(e,a,s,c={},p,m,_,y,g,S=[],P,v,x,A,E){return c.time_on_page_ms=window.performance.now(),(b,C)=>{dt(C().formData,a)?Promise.all([s(),i.fetchViewer()]).then((([s,I])=>{const{pageState:w,formData:N}=C();let L;L=!1===w.existingAccountShowing?I.is_signed_in&&I.personal_email===N.email.formattedValue:!!w.existingAccountShowing||I.is_signed_in;const k=!L||w.isAgeGatingRequired;s?function(e,a,s,c,p,m,_,y,g,S,P,v=[],x,A,E,b,C){const I=o.getActiveUserId(),w={};w.update_billing_mode=je(),w.tos_variant=void 0!==b?f.CheckoutTOSVariant[b]:"",w.subscription_id=C||"";const N=a===Ue||a===Be;if("/checkout/ajax_buy"===a&&P){const e=We(P,c,s,p,v,x,E),t=o.marshalProto(new f.PurchaseArgs(e));w.encoded_purchase_args=t,c=c.filter((e=>Ke.has(e)))}else if("/pro/ajax_try"===a||"/pro/ajax_paypal_try"===a||"/checkout/ajax_try"===a){const e=We("",c,s,p,v,x),t=o.marshalProto(new f.PurchaseArgs(e));w.encoded_purchase_args=t}else if(N){const e=We("",c,s,p,v);e.purchaseUserInput&&(w.serialized_purchase_user_input=o.marshalProto(e.purchaseUserInput)),A&&(w.preview_token=A)}for(const e of c){const t=s[e];w[ke[e]]=t.formattedValue}d.assignIn(w,p);const L=t=>{for(const r of t)if(r.length>=3){const t=r[0],a=r[2];if("notifyError"===t)"emailTaken"===a?e(it()):"emailCaptured"===a&&e(st())}},k=t=>{t.data&&"funcaptcha-component"===t.data.origin&&l.URI.parse(t.origin).getAuthority()===r.getDomains().FUNCAPTCHA_SERVER&&("loaded"!==t.data.event&&"retry"!==t.data.event||e({type:Oe.CaptchaShown}),"played"===t.data.event&&window.removeEventListener("message",k),"closed"===t.data.event&&(e({type:Oe.EnablePurchaseButton}),window.removeEventListener("message",k)))},D=function(t,r,a){var n;const s=l.URI.parse(i.get_href()).removeQuery("modal");window.history.replaceState(void 0,document.title,s.toString()),e(function(e,t){return{type:Oe.SubmitFormSuccess,data:e,additionalData:t}}(t,p)),(null===(n=null==t?void 0:t.actions)||void 0===n?void 0:n.length)&&L(t.actions)},M=function(t,r,i){let s=null;try{s=JSON.parse(i)}catch(e){}finally{if(e((o=s||i,{type:Oe.PaymentsWebRequestErrorCallbackTriggered,error:o})),s&&s.funcaptcha_response?(window.addEventListener("message",k),n.reportException({err:new Error("(Not an error) Captcha required"),severity:n.SEVERITY.NONCRITICAL,tags:["client_payments_web_request_error"],exc_extra:{data_keys:Object.keys(s)}})):e(rt(s||i)),g&&s&&(s.challengeToken||s.fingerprintToken)&&(n.reportException({err:new Error("(Not an error) Attempting to handle 3DS message"),severity:n.SEVERITY.NONCRITICAL,tags:["client_payments_web_request_error"],exc_extra:{data_keys:Object.keys(s)}}),g(s)),s&&s.error_type&&s.msg&&("Payment"===s.error_type?(n.reportException({err:new Error("Payment error"),severity:n.SEVERITY.CRITICAL,tags:["client_payments_web_request_error"],exc_extra:{data_keys:Object.keys(s)}}),e(ot(s.msg))):n.reportException({err:new Error("General payment web request error"),severity:n.SEVERITY.CRITICAL,tags:["client_payments_web_request_error"],exc_extra:{data_keys:Object.keys(s)}})),_){let t="";t=m?"CHECKOUT_CREATE_FORM":a===Ue?"INDIVIDUAL_UPDATE_BILLING_MODAL":a===Be?"TEAM_UPDATE_BILLING_MODAL":"BUY_PURCHASE_FORM";h.handle_captcha_errors(_,s,t)&&e({type:Oe.TriggerCaptcha})}}var o};if(_){const r=h.get_captcha_responses(_);r["g-recaptcha-response"]&&(w["g-recaptcha-response"]=r["g-recaptcha-response"],S=t.SubmitFormTriggerType.RecaptchaV2,e(at())),r["funcaptcha-response"]&&(w["funcaptcha-response"]=r["funcaptcha-response"],S=t.SubmitFormTriggerType.RecaptchaV2,e(at()))}e(function(e=t.SubmitFormTriggerType.ButtonClick,r){return{type:Oe.SubmitFormStart,trigger:e,additionalData:r}}(S,p));const R=window.location!==window.parent.location;if(y&&!i.isTest()){y.getWrappedComponent().invokeFPJSIframeAndLog(w.email,I);const e=i.get_visitor_id(y);e&&(e["visitor-id"]&&e["fp-request-id"]?(w["visitor-id"]=e["visitor-id"],w["fp-request-id"]=e["fp-request-id"]):e.fp_sealed_result&&(w.fp_sealed_result=e.fp_sealed_result))}const U=new De({url:a,data:w,success:D,error:M,subject_user:I,is_framed:R,complete:R?tt:void 0});if(m)new De({url:"/checkout/create_user",type:"POST",data:{fname:w.fname,lname:w.lname,email:w.email,is_trial:"trial"===w.signup_type,password:w.password,plan_id:w.plan_id,product:w.product,marketing_opt_in:w.marketing_opt_in,tos_agree:w.tos_agree,schedule_id:w.schedule_id,signup_url:w.signup_url,signup_tag:w.signup_tag,signup_referrer:w.signup_referrer,tracking_params:w.tracking_params,birthdate_ts:Ve(w.birthDay,w.birthMonth,w.birthYear),"funcaptcha-response":w["funcaptcha-response"],fp_sealed_result:w.fp_sealed_result,tos_variant:w.tos_variant},subject_user:o.getActiveUserId(),success:async t=>{var r;if(null===(r=null==t?void 0:t.actions)||void 0===r?void 0:r.length)return L(t.actions),void e(rt(t));await async function(){await Re(!0)}(),m=!1,U.options.subject_user=o.getActiveUserId(),U.options.data["funcaptcha-response"]="",U.request()},error:M}).request();else if(N){const e=a===Be,t=new i.DefaultUserApiV2Client(i.mustGetActiveUserApiV2Properties()),r={serialized_purchase_user_input:w.serialized_purchase_user_input,preview_request_token:w.preview_token,update_billing_mode:w.update_billing_mode,is_multi_seat:e,funcaptcha_response:w["funcaptcha-response"],subscription_id:w.subscription_id};T(t).rpc("update_billing_info",r,{}).then((e=>{if(e.update_completed&&D({data:{success:!0}}),e.redirect_url&&(n.reportException({err:new Error("(Not an error) Redirecting user to external billing"),severity:n.SEVERITY.NONCRITICAL,tags:["client_update_billing_failure"]}),i.unsafeRedirect(e.redirect_url)),g&&e.three_ds_error_data)try{const t=JSON.parse(e.three_ds_error_data);n.reportException({err:new Error("(Not an error) Attempting to handle 3DS message"),severity:n.SEVERITY.NONCRITICAL,tags:["client_update_billing_failure"],exc_extra:{data_keys:Object.keys(t)}}),g(t)}catch(e){n.reportException({err:e,severity:n.SEVERITY.CRITICAL,tags:["client_update_billing_failure"]})}else e.captcha_error_data&&M(null,null,e.captcha_error_data)})).catch((e=>{n.reportException({err:e,severity:n.SEVERITY.NONCRITICAL,tags:["client_update_billing_failure"]}),M(null,null,e.message||""),e.message&&u.Notify.error(e.message)}))}else U.request();_&&h.clear_captcha_response(_);S!==t.SubmitFormTriggerType.ThreeDsChallenge&&S!==t.SubmitFormTriggerType.ThreeDsFingerprint||e(lt(""));S===t.SubmitFormTriggerType.RecaptchaV2&&e(ct(""))}(b,e,N,a,c,k,p,m,_,y,g,S,P,v,x,A,E):N.paymentMethod.formattedValue===t.PaymentMethod.ApplePay&&b(ut("Step 2 - User Closed Most Likely"))})):b(nt(a,"SubmitForm"))}},t.triggerThreeDsChallenge=function(){return{type:Oe.TriggerThreeDsChallenge}},t.triggerThreeDsFingerprint=function(){return{type:Oe.TriggerThreeDsFingerprint}},t.updateAccountHolderName=function(e){return{type:Oe.UpdateAccountHolderName,value:e}},t.updateAddressNumber=function(e){return{type:Oe.UpdateAddressNumber,value:e}},t.updateAddressStreet=function(e){return{type:Oe.UpdateAddressStreet,value:e}},t.updateAdyenEncryptedCard=function(e){return{type:Oe.UpdateAdyenEncryptedCard,value:e}},t.updateApplePayToken=ct,t.updateBIN=function(e){return{type:Oe.UpdateBIN,value:e}},t.updateBrowserInfo=function(e){return{type:Oe.UpdateBrowserInfo,value:e}},t.updateCountryCode=function(e){return{type:Oe.UpdateCountryCode,value:e}},t.updateCpf=function(e){return{type:Oe.UpdateCpf,value:e}},t.updateCpfName=function(e){return{type:Oe.UpdateCpfName,value:e}},t.updateDeclarationConfirmation=function(e){return t=>{t({type:Oe.UpdateDeclarationConfirmation,value:e})}},t.updateEncryptedCardForNetworkToken=function(e,t){return{type:Oe.UpdateEncryptedCardForNetworkToken,cardType:e,encryptedCard:t}},t.updateIBAN=function(e){return{type:Oe.UpdateIBAN,value:e}},t.updateIdealBank=function(e){return{type:Oe.UpdateIdealBank,value:e}},t.updateInvoiceBusinessName=function(e){return{type:Oe.UpdateInvoiceBusinessName,value:e}},t.updateInvoiceCity=function(e){return{type:Oe.UpdateInvoiceCity,value:e}},t.updateInvoiceProvince=function(e){return{type:Oe.UpdateInvoiceProvince,value:e}},t.updateInvoiceStreetAddress=function(e){return{type:Oe.UpdateInvoiceStreetAddress,value:e}},t.updateMandateSigned=function(e){return{type:Oe.UpdateMandateSigned,value:e}},t.updateName=function(e){return{type:Oe.UpdateName,value:e}},t.updateNonce=function(e,t){return{type:Oe.UpdateNonce,value:e,creditCardIframeFields:t}},t.updatePan=function(e){return{type:Oe.UpdatePan,value:e}},t.updatePayPalNonce=function(e,t){return{type:Oe.UpdatePayPalNonce,value:e,email:t}},t.updatePaymentMethod=function(e){return{type:Oe.UpdatePaymentMethod,value:e}},t.updateTermsAndService=function(e){return{type:Oe.UpdateTermsAndService,value:e}},t.updateThreeDsData=lt,t.updateVatAndPrice=function(e,t,r=!0,a=!1){return n=>{n({type:"PrepareToUpdateTransitions"}),n(function(e){return{type:Oe.UpdateVat,value:e}}(e)),a&&n(Ae(t,r))}},t.updateVatProvincialAndPrice=function(e,t,r=!0,a=!1){return n=>{var i;n({type:"PrepareToUpdateTransitions"}),n((i=e,{type:Oe.UpdateVatProvincial,value:i})),a&&n(Ae(t,r))}},t.updateZipCodeAndPrice=function(e,t,r=!0,a=!1){return n=>{var i;n({type:"PrepareToUpdateTransitions"}),n((i=e,{type:Oe.UpdateZipCode,value:i})),a&&n(Ae(t,r))}},t.validIBANForCountry=function(e){if((e=e.replace(/\s+/g,"")).length<2)return!1;switch(e.substring(0,2)){case"AT":return/^AT[0-9]{18}$/.test(e);case"BE":return/^BE[0-9]{14}$/.test(e);case"CY":return/^CY[0-9]{10}[0-9a-zA-Z]{16}$/.test(e);case"CZ":return/^CZ[0-9]{22}$/.test(e);case"DE":return/^DE[0-9]{20}$/.test(e);case"EE":return/^EE[0-9]{18}$/.test(e);case"ES":return/^ES[0-9]{22}$/.test(e);case"FI":return/^FI[0-9]{16}$/.test(e);case"FR":return/^FR[0-9]{12}[0-9a-zA-Z]{11}[0-9]{2}$/.test(e);case"GR":return/^GR[0-9]{9}[0-9a-zA-Z]{16}$/.test(e);case"HU":return/^HU[0-9]{26}$/.test(e);case"HR":return/^HR[0-9]{19}$/.test(e);case"IE":return/^IE[0-9]{2}[0-9a-zA-Z]{4}[0-9]{14}$/.test(e);case"IT":return/^IT[0-9]{2}[A-Z]{1}[0-9]{10}[0-9a-zA-Z]{12}$/.test(e);case"LU":return/^LU[0-9]{5}[0-9a-zA-Z]{13}$/.test(e);case"NL":return/^NL[0-9]{2}[A-Z]{4}[0-9]{10}$/.test(e);case"PL":return/^PL[0-9]{26}$/.test(e);case"PT":return/^PT[0-9]{23}$/.test(e);case"SE":return/^SE[0-9]{22}$/.test(e)}return!1},t.validateCpf=function(e){if(14===e.length)return!0;if(11!==e.length)return!1;let t=0;for(let r=0;r<9;r++)t+=parseInt(e.charAt(r),10)*(10-r);let r=t%11;if(t=r<2?0:11-r,t!==parseInt(e.charAt(9),10))return!1;let a=0;for(let t=0;t<10;t++)a+=parseInt(e.charAt(t),10)*(11-t);return r=a%11,a=r<2?0:11-r,a===parseInt(e.charAt(10),10)},t.validateForm=function(e){return(t,r)=>{dt(r().formData,e)||t(nt(e,"ValidateForm"))}},t.validateVat=me}));
//# sourceMappingURL=c_components_order_summary_redesign_order_summary_utils.js-vflP68ktz.map

//# debugId=6058aaf0-781f-3143-bb1d-c24fa8246d74
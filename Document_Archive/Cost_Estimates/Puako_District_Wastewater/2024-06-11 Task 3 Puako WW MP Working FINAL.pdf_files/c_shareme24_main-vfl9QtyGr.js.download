!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="67eac12f-4a11-3ff2-8614-32d8a2c73508")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_file","./c_memoize-one","./c_over-quota_utils_use_get_plans","./c_over-quota_utils_oq_price_decrease_helper","./c_dig-icons_assets_ui-icon_line_qr-code","./c_ui_contextual-nudge_campaign-contextual-nudge-section","./c_core_i18n","./e_data_modules_stormcrow","./c_src_bindings_provider","./c_common_components_layout","./c_utils_dsx_dsx-react","./c_content-member-list_internals_content-member-list","./c_inband-screen_internals_share-modal-share","./e_core_exception","./c_src_utils_initials","./c_over-quota_over-quota-sweep-blocking-modal_show_over_quota_modal_or_continue","./c_common_components_buttons","./c_settings-page_internals_settings-page-wrapper","./c_user_metadata_api","./c_dig-icons_assets_ui-icon_line_settings","./c_dig-icons_assets_ui-icon_line_send","./c_hive_schemas_sharing-request_access_user_events","./c_dotlottie_common_chunk-B7OIQIGJ","./c_api_v2_unauthed_client","./c_api_v2_routes_password_confirmation_provider","./c_src_sink_index"],(function(e,t,a,n,i,o,r,s,l,c,d,u,g,m,_,p,E,f,S,y,C,v,b,h,k,L,A,T){"use strict";function I(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var w=I(t),$=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},N=[0],M=new Map;function x(e,n){var i=void 0===n?{}:n,o=i.threshold,r=void 0===o?N:o,s=i.root,l=i.rootMargin,c=void 0===l?"0px":l,d=a.useSafeState(),u=d[0],g=d[1];return t.useEffect((function(){var t=e&&"current"in e?e.current:e;if(t){var a=!0,n=function(e){var t,a=null!==(t=e.root)&&void 0!==t?t:document,n=M.get(a);n||(n=new Map,M.set(a,n));var i=JSON.stringify([e.rootMargin,e.threshold]),o=n.get(i);if(!o){var r=new Map,s=new IntersectionObserver((function(e){return e.forEach((function(e){var t;return null===(t=r.get(e.target))||void 0===t?void 0:t.forEach((function(t){return setTimeout((function(){return t(e)}),0)}))}))}),e);o={observer:s,observe:function(e,t){var a=r.get(e);a||(a=new Set,r.set(e,a),s.observe(e)),a.add(t)},unobserve:function(e,t){var o=r.get(e);o&&(o.delete(t),o.size||(r.delete(e),s.unobserve(e),r.size||(s.disconnect(),n.delete(i),n.size||M.delete(a))))}},n.set(i,o)}return o}({root:s&&"current"in s?s.current:s,rootMargin:c,threshold:r}),i=function(e){a&&g(e)};return n.observe(t,i),function(){a=!1,n.unobserve(t,i)}}}),$([e,s,c],r,!0)),u}const R={".tag":"no_one"},O={".tag":"password"},D={".tag":"team"},P={".tag":"public"};const U={".tag":"viewer"},B={".tag":"editor"},V={".tag":"default"};const j=async(e,t)=>{a.prefetchListObjectMembersData(t),m.prefetchListSharedLinks(t),"file"===t[".tag"]&&a.prefetchSeenStateInfoData(t.fileId);const n=await a.fetchObjectMembers(t,!0);if(n){const{groups:t,users:a,invitees:i}={...n};0===a.length&&0===t.length&&0===i.length&&e&&(n.users=[q(e)]);const o=n.users.map((e=>e.user.account_id)),r=await m.getAccountBatch(o);if("SUCCESS"===r.status){const t=Object.values(r.output),a=t.find((t=>t.account_id===(null==e?void 0:e.account_id)));(null==a?void 0:a.profile_photo_url)&&F(a.profile_photo_url),t.slice(0,2).forEach((e=>{e.profile_photo_url&&F(e.profile_photo_url)}))}}},F=e=>{(new Image).src=e},q=e=>({access_type:{".tag":"owner"},user:{account_id:e.account_id,email:e.email,display_name:e.display_name,same_team:!0,disabled:!1}}),H=Symbol("ON_INITIAL_LOAD_START"),K=Symbol("ON_INITIAL_LOAD_FAILURE"),G=Symbol("ON_INITIAL_LOAD_CANCEL"),W=Symbol("ON_INITIAL_LOAD_SUCCESS"),Q=Symbol("ON_FOLDER_ALREADY_SHARED"),Y=Symbol("ON_TEST_INITIAL_LOAD_START"),z=Symbol("ON_TEST_INITIAL_LOAD_SUCCESS"),X=Symbol("ON_TEST_INITIAL_LOAD_CANCEL"),J=Symbol("ON_TEST_INITIAL_LOAD_FAILURE"),Z=Symbol("ON_TEST_REFRESH_LOAD_START"),ee=Symbol("ON_TEST_REFRESH_LOAD_SUCCESS"),te=Symbol("ON_TEST_REFRESH_LOAD_CANCEL"),ae=Symbol("ON_TEST_REFRESH_LOAD_FAILURE"),ne=Symbol("ON_DOUBLE_READ_DIFF"),{useEmitter:ie,defaultEmitter:oe}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s=t(_.Context),l={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},c={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};if(e.key!==H){if(e.key===K){let t="none";if("response"in e.payload.error)try{const a=e.payload.error.response.error;".tag"in a&&(t=a[".tag"]||"none")}catch(e){t="loggingFailure"}const n={...l,errorType:e.payload.error.type,errorTag:t,objMetadataNewApiVariant:e.payload.objMetadataNewApiVariant};return a.UDCL.logEnd(a.PAP_Load_ShareModal({eventState:"failed",...c}),{key:s,tags:n}),void a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"failed",key:s,tags:n})}if(e.key===G){const t={...l,objMetadataNewApiVariant:e.payload.objMetadataNewApiVariant};return a.UDCL.logEnd(a.PAP_Load_ShareModal({eventState:"canceled",...c}),{eventState:"canceled",key:s,tags:t}),void a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"canceled",key:s,tags:t})}if(e.key===W){const t={...l,objMetadataNewApiVariant:e.payload.objMetadataNewApiVariant};return a.UDCL.logEnd(a.PAP_Load_ShareModal({eventState:"success",...c}),{key:s,tags:t}),void a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"success",key:s,tags:t})}if(e.key!==Q)if(e.key!==Y)if(e.key!==z)if(e.key!==X)if(e.key!==J)if(e.key!==Z)if(e.key!==ee)if(e.key!==te)if(e.key!==ae){if(e.key===ne){const t=e.payload.diffs.reduce(((e,t)=>({...e,[`diff_${t.field}`]:"true"})),{});a.UDCL.logEvent("ops.sm24.double_read_diff",{tags:t,detail:{fileId:e.payload.fileId,diffs:e.payload.diffs}})}}else{let t="none";if("response"in e.payload.error)try{const a=e.payload.error.response;".tag"in a&&(t=a[".tag"]||"none")}catch(e){t="loggingFailure"}a.UDCL.logEnd("ops.sm24.test_refresh_data_load",{eventState:"failed",key:s,tags:{...l,errorType:e.payload.error.type,errorTag:t}})}else a.UDCL.logEnd("ops.sm24.test_refresh_data_load",{eventState:"canceled",key:s,tags:l});else a.UDCL.logEnd("ops.sm24.test_refresh_data_load",{eventState:"success",key:s,tags:l});else a.UDCL.logStart("ops.sm24.test_refresh_data_load",{key:s,tags:l});else{let t="none";if("response"in e.payload.error)try{const a=e.payload.error.response;".tag"in a&&(t=a[".tag"]||"none")}catch(e){t="loggingFailure"}a.UDCL.logEnd("ops.sm24.test_initial_data_load",{eventState:"failed",key:s,tags:{...l,errorType:e.payload.error.type,errorTag:t}})}else a.UDCL.logEnd("ops.sm24.test_initial_data_load",{eventState:"canceled",key:s,tags:l});else a.UDCL.logEnd("ops.sm24.test_initial_data_load",{eventState:"success",key:s,tags:l});else a.UDCL.logStart("ops.sm24.test_initial_data_load",{key:s,tags:l});else a.UDCL.logEvent("ops.sm24.already_shared",{tags:l})}else{const t={...l,objMetadataNewApiVariant:e.payload.objMetadataNewApiVariant};a.UDCL.logStart("ops.sm24.initial_data_load",{key:s,tags:t})}})),re=e=>{const t=ie(),{isNonUserRelativeContext:n}=a.useSharingApiContext();return w.useCallback((async()=>{const i=e.$nonce.get(),o=e.$options.get(),r=e.$state.get();let s=o.objectIdentifier;"loaded"===r.status&&(s=r.objectIdentifier);const l=o.objMetadataNewApiVariant,d="V1"===l&&s.fileId,u=!d,g="ON"===l&&s.fileId;t.select(H).emit({objMetadataNewApiVariant:l});const m=a=>{e.$state.set({status:"error",errorType:"INITIAL_LOAD_ERROR",loadError:a}),t.select(K).emit({error:a,objMetadataNewApiVariant:l})},_=await a.getSharingApiv2ResponseWithErrors(a.sharingPrefsPackage.fetchQuery(c.queryClient,{})),f=await a.getSharingApiv2ResponseWithErrors(a.sharingAccountInfoPackage.fetchQuery(c.queryClient,{},{staleTime:18e5}));let S,y,C,v;if(d?y=await a.getSharingApiv2ResponseWithErrors(a.sharingObjectMetadataPackage.fetchQuery(c.queryClient,{apiArg:{file_id:s.fileId},pkgArg:{isNonUserRelativeContext:n}},{staleTime:3e5})):S=await c.queryClient.fetchQuery(["object-metadata",o.objectIdentifier],(()=>E.getSharingObjectMetadata(s,n))),g&&(t.select(Y).emit(null),C=await a.getSharingApiv2ResponseWithErrors(a.sharingObjectMetadataPackage.fetchQuery(c.queryClient,{apiArg:{file_id:s.fileId},pkgArg:{isNonUserRelativeContext:n}},{staleTime:3e5})),"SUCCESS"===C.status?t.select(z).emit(null):"ERROR"===C.status?t.select(J).emit({error:{type:"METADATA_ERROR_V2",response:C.error}}):t.select(J).emit({error:{type:"METADATA_FATAL_V2",response:{status:a.Status$1.FATAL,error:C}}})),i!==e.$nonce.get())return t.select(G).emit({objMetadataNewApiVariant:l}),void(g&&t.select(X).emit(null));if(u){if(!S)return void m({type:"OTHER"});if("SUCCESS"!==S.status)return void("ERROR"===S.status?(p.reportStack("SM24 initial data loader error",{severity:p.SEVERITY.NONCRITICAL,tags:["sm24_initial_data_loader_error_V1"],exc_extra:{file_id:s.fileId,error:S},silent:!1}),m({type:"METADATA_ERROR",response:S})):(p.reportStack("SM24 initial data loader error",{severity:p.SEVERITY.NONCRITICAL,tags:["sm24_initial_data_loader_fatal_V1"],exc_extra:{file_id:s.fileId,error:S},silent:!1}),m({type:"METADATA_FATAL",response:S})));v=S.output}else{if(!y)return void m({type:"OTHER"});if("SUCCESS"!==y.status)return void("ERROR"===y.status?(p.reportStack("SM24 initial data loader error",{severity:p.SEVERITY.NONCRITICAL,tags:["sm24_initial_data_loader_error_V2"],exc_extra:{file_id:s.fileId,error:y},silent:!1}),m({type:"METADATA_ERROR_V2",response:y})):(p.reportStack("SM24 initial data loader error",{severity:p.SEVERITY.NONCRITICAL,tags:["sm24_initial_data_loader_fatal_V2"],exc_extra:{file_id:s.fileId,error:y},silent:!1}),m({type:"METADATA_FATAL_V2",response:y})));v=y.output}if(g&&"SUCCESS"===(null==C?void 0:C.status)){const e=a.normalizeNewApiMetadata(C.output),n=a.normalizeOldApiMetadata(v),{redactedDiffs:i,originalDiffs:o}=a.diffNormalizedMetadata(n,e);if(i.length>0){const e=C.output.common_metadata.file_id;if(t.select(ne).emit({fileId:e,diffs:i}),o.length>0){const t=["sm24_metadata_diff",...o.map((e=>e.field)).map((e=>`diff_field_${e}`))];p.reportStack("SM24 metadata diff found",{severity:p.SEVERITY.NONCRITICAL,tags:t,exc_extra:{file_id:e,original_diffs:o},silent:!0})}}}if("SUCCESS"!==f.status||"SUCCESS"!==_.status)return void("SUCCESS"!==_.status?"ERROR"===_.status?m({type:"SHARING_PREFS_ERROR",response:_}):m({type:"SHARING_PREFS_FATAL",response:_}):"SUCCESS"!==f.status?m({type:"SHARING_ACCOUNT_INFO_ERROR"}):m({type:"OTHER"}));let b=s;"file_folder"===s[".tag"]&&a.getIsSharedFolder(v)&&(b={".tag":"shared_folder",sharedFolderId:a.getSharedFolderId(v),fileId:s.fileId}),e.$state.set({status:"loaded",objectIdentifier:b,memberActionsInProgress:{},memberAccountIdsAlreadyFetched:{},accountMetadata:f.output,memberAccounts:{},objectMetadata:v,sharingPrefs:_.output}),t.select(W).emit({objMetadataNewApiVariant:l})}),[e,t])},se=e=>{const t=(e=>w.useCallback((t=>{(e.$options.get().onRefreshError||(()=>{}))(t)}),[e]))(e),{isNonUserRelativeContext:n}=a.useSharingApiContext(),i=ie();return w.useCallback((async()=>{const o=e.$state.get();if("loaded"!==o.status)return;const r=e.$nonce.get(),s=e.$state.get(),l=e.$options.get().objMetadataNewApiVariant,d="V1"===l&&o.objectIdentifier.fileId,u=!d,g="ON"===l&&o.objectIdentifier.fileId;let m,_,p,f;if(d?_=await a.getSharingApiv2ResponseWithErrors(a.sharingObjectMetadataPackage.fetchQuery(c.queryClient,{apiArg:{file_id:o.objectIdentifier.fileId},pkgArg:{isNonUserRelativeContext:n}},{staleTime:3e5})):m=await E.getSharingObjectMetadata(o.objectIdentifier,n),g&&(i.select(Z).emit(null),p=await a.getSharingApiv2ResponseWithErrors(a.sharingObjectMetadataPackage.fetchQuery(c.queryClient,{apiArg:{file_id:o.objectIdentifier.fileId},pkgArg:{isNonUserRelativeContext:n}},{staleTime:3e5})),"SUCCESS"===p.status?i.select(ee).emit(null):"ERROR"===p.status?i.select(ae).emit({error:{type:"METADATA_ERROR_V2",response:p.error}}):i.select(ae).emit({error:{type:"METADATA_FATAL_V2",response:{status:a.Status$1.FATAL,error:p}}})),e.$nonce.get()!==r||"loaded"!==s.status)return null;if(u){if(!m)return void t({type:"OTHER"});if("ERROR"===m.status)return t({type:"METADATA_ERROR",response:m}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"METADATA_ERROR",response:m}});if("FATAL"===m.status)return t({type:"FATAL",response:m}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"FATAL",response:m}});f=m.output}else{if(!_)return void t({type:"OTHER"});if("ERROR"===_.status)return t({type:"METADATA_ERROR_V2",response:_}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"METADATA_ERROR_V2",response:_}});if("FATAL"===_.status)return t({type:"FATAL",response:_}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"FATAL",response:_}});f=_.output}let S=s.objectIdentifier;return"file_folder"===s.objectIdentifier[".tag"]&&a.getIsSharedFolder(f)&&(S={".tag":"shared_folder",sharedFolderId:a.getSharedFolderId(f),fileId:s.objectIdentifier.fileId}),e.$state.set({...s,objectMetadata:f,objectIdentifier:S}),null}),[e,t,i])},le=e=>{const t=re(e),{variant:n,isLoading:i}=a.useExperimentVariant("sm24_obj_metadata_new_api"),o=!i,[r,s]=w.useState(null);w.useEffect((()=>{const i=null===(l=e.$options.get()).sessionId?null:"file"===l.objectIdentifier[".tag"]?`file:${l.sessionId}:${a.getContentIdOrPathFromObjectIdentifier(l.objectIdentifier)}`:"file_folder"===l.objectIdentifier[".tag"]?`folder:${l.sessionId}:${a.getContentIdOrPathFromObjectIdentifier(l.objectIdentifier)}`:`shared_folder:${l.sessionId}:${a.getContentIdOrPathFromObjectIdentifier(l.objectIdentifier)}`;var l;if(null===i)return null!==r&&s(null),void("unloaded"!==e.$state.get().status&&g.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"unloaded"})})));o&&(i===r&&"unloaded"!==e.$state.get().status||(g.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"loading"})})),s(i),e.$options.set({...e.$options.get(),objMetadataNewApiVariant:n}),a.logExposure({feature:"sm24_obj_metadata_new_api",variant:n}),t()))}))},ce=e=>{const t=se(e),a=re(e),n=(e=>w.useCallback((t=>{const a=e.$state.get();"loaded"===a.status&&e.$state.set({...a,objectIdentifier:t})}),[e]))(e),i=g.useStore(e.$state);return w.useMemo((()=>({...i,refreshObjectMetadata:t,refreshModal:a,onObjectIdentifierChanged:n})),[i,t,a,n])},de=e=>{const t=(e=>g.useInitStore(e,(()=>({$nonce:g.store(0),$options:g.store(e),$state:g.store({status:"unloaded"})}))))(e);return le(t),(e=>{const t=e.$state.get(),{user:n,isLoading:i}=a.useActiveUser(),o="loaded"===t.status&&!a.getIsLinkOnlyMode(t.objectMetadata)&&(a.getCanInvite(t.objectMetadata,_.VIEWER)||a.getCanInvite(t.objectMetadata,_.EDITOR)),r=e.$options.get().objectIdentifier;w.useEffect((()=>{o&&!i&&n&&j(n,r)}),[o,i,n,r])})(t),(e=>{w.useEffect((()=>()=>{g.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"unloaded"})}))}),[])})(t),ce(t)},ue=({children:e,...t})=>{const a=de(t);return w.createElement(c.QueryClientProvider,{client:c.queryClient},w.createElement(w.Fragment,null,e(a)))};ue.displayName="ShareModalDataLoader";const ge=w.createContext({status:"unloaded"}),me=({children:e,...t})=>w.createElement(ue,{...t},(t=>w.createElement(ge.Provider,{value:t},e)));me.displayName="Provider";const _e=()=>w.useContext(ge);a.injectInternalStyle("/static/metaserver/static/js/growth/ui/over-quota/over-quota-share-banner-component/over_quota_share_banner_component.module.out-vflEEG0ol.css",(e=>"._bannerSection_l7aro_1{margin-bottom:var(--dig-spacing__micro__medium);margin-top:var(--dig-spacing__micro__small)}"));const pe="_bannerSection_l7aro_1";a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/common/components/banner-notification.module.out-vfloD7-h9.css",(e=>"@keyframes _banner-enter-animation_18wtf_1{0%{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}@keyframes _banner-exit-animation_18wtf_1{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-8px)}}._bannerWrapper_18wtf_27{overflow:hidden;transition:height var(--dig-motion__presets__slide-out__duration) var(--dig-motion__presets__slide-out__easing)}._banner_18wtf_27{align-items:center;border-radius:var(--dig-radius__xlarge) var(--dig-radius__xlarge) 0 0;display:flex;padding:var(--dig-spacing__micro__medium) var(--dig-spacing__macro__medium)}._bannerMobile_18wtf_44{padding-left:var(--dig-spacing__micro__large);padding-right:var(--dig-spacing__micro__large)}._bannerEnter_18wtf_49{animation:_banner-enter-animation_18wtf_1 var(--dig-motion__presets__slide-in__duration) var(--dig-motion__presets__slide-in__easing)}._bannerExit_18wtf_54{animation:_banner-exit-animation_18wtf_1 var(--dig-motion__presets__slide-out__duration) var(--dig-motion__presets__slide-out__easing) forwards}._banner_18wtf_27>span:last-child{align-items:center;display:flex;justify-content:space-between;width:100%}._bannerActions_18wtf_66{align-items:center;display:flex;gap:var(--dig-spacing__micro__small);margin-left:auto;padding-top:0}._bannerWarning_18wtf_75{background-color:hsla(45,91%,83%,.2);border-bottom:1px solid var(--dig-color__warning__surface--state-2)}._bannerAlert_18wtf_95,._bannerNeutral_18wtf_90{border-bottom:1px solid var(--dig-color__border__subtle)}._bannerAlert_18wtf_95{background-color:var(--dig-color__alert__surface)}"));const Ee="_bannerWrapper_18wtf_27",fe="_banner_18wtf_27",Se="_bannerMobile_18wtf_44",ye="_bannerEnter_18wtf_49",Ce="_bannerExit_18wtf_54",ve="_bannerActions_18wtf_66",be="_bannerWarning_18wtf_75",he="_bannerAlert_18wtf_95",ke="_bannerNeutral_18wtf_90",Le=({message:e,icon:t,type:n,action:i,isDismissible:o,onDismiss:r})=>{const[s,l]=w.useState(!1),c=w.useRef(null),[d,u]=w.useState(null);w.useEffect((()=>{c.current&&u(c.current.offsetHeight)}),[e]),w.useEffect((()=>{if(s&&r){const e=setTimeout((()=>{r()}),200);return()=>clearTimeout(e)}}),[s,r]);const{small:g}=a.useBreakpoint({strategy:"maxWidth"}),m=a.cx(fe,{[be]:"warning"===n,[he]:"alert"===n,[ke]:"warning"!==n&&"alert"!==n,[Se]:g},ye,{[Ce]:s}),_=Ee,p=w.useCallback((()=>{l(!0)}),[]),E={height:s?0:d?`${d}px`:"auto"};return w.createElement("div",{ref:c,className:_,style:E},w.createElement(a.Banner,{type:n,className:m,withLeftIcon:w.createElement(a.UIIcon,{src:t})},w.createElement(a.Banner.Message,null,e),(i||o)&&w.createElement(a.Banner.Actions,{className:ve},i&&w.createElement(a.Button,{variant:"outline",size:"small",onClick:()=>{var e;null==i||i.onClick();null!==(e=null==i?void 0:i.dismissOnClick)&&void 0!==e&&e&&r&&p()},isLoading:i.isLoading},i.label),o&&w.createElement(a.IconButton,{variant:"outline",size:"small",onClick:p},w.createElement(a.UIIcon,{src:a.CloseLine})))))};Le.displayName="BannerNotification";const Ae=({onUpgrade:e,shouldUseSm26Design:t=!1})=>{var n,s,l,c,d,u,g,m,_,p,E;const[f,S]=w.default.useState(!1),y=a.useExperimentVariant("end_state_web_overquota_restrictions"),C=a.useExperimentVariant("lifecycle_2026_01_12_locked_team_restriction"),v=y&&y.variant===a.Variant.V1,b="ON"===a.useExperimentVariant("overquota_glide_modal").variant,h=w.default.useRef(!1),k=(null==y?void 0:y.variant)?y.variant:a.Variant.OFF,{user:L}=a.useActiveUser(),{viewer:A}=a.useViewer(),T=(null==L?void 0:L.is_team)&&(null==A?void 0:A.team_is_locked),I=C&&C.variant===a.Variant.V1&&T,$=(null==C?void 0:C.variant)?C.variant:a.Variant.OFF,{quotaUpsellInfo:N,isLoadingQuotaUpsellInfo:M,quotaUpsellInfoError:x}=a.useQuotaUpsellInfo(L,y.variant===a.Variant.OFF&&C.variant===a.Variant.OFF),R=!(y.isLoading||M||y.error||x),O=(null===(n=null==N?void 0:N.restrictions)||void 0===n?void 0:n.enforce_restrictions)||(null===(s=null==N?void 0:N.restrictions)||void 0===s?void 0:s.show_restrictions_warning),D=!(C.isLoading||C.error||M||x),P=null===(l=null==N?void 0:N.team_info)||void 0===l?void 0:l.current_user_can_change_or_upgrade_billing,U=v&&O||I&&(null==N?void 0:N.team_info),B=(null===(u=null===(d=null===(c=null==N?void 0:N.quota)||void 0===c?void 0:c.allocation)||void 0===d?void 0:d.individual)||void 0===u?void 0:u.allocated)||0,V=(null===(g=null==N?void 0:N.quota)||void 0===g?void 0:g.used)||0,j=null===(m=null==N?void 0:N.restrictions)||void 0===m?void 0:m.overquota_start_time_utc_seconds,F=j?Date.now()/1e3-j:void 0,q=!!(null===(_=null==N?void 0:N.restrictions)||void 0===_?void 0:_.enforce_restrictions),H=a.getOverQuotaReason(null==N?void 0:N.overquota_reason),K=null!==(p=o.getOrganicOrChurnedFromString(H))&&void 0!==p?p:"unlabeled";if(w.default.useEffect((()=>{R&&O&&[a.Variant.V1,a.Variant.CONTROL,a.Variant.HOLDOUT].includes(k)&&(a.logExposure({feature:"end_state_web_overquota_restrictions",variant:k}),a.logAdditionalExposureDetails(k,"share_modal_banner",N))}),[k,O,R,N]),w.default.useEffect((()=>{T&&D&&N&&[a.Variant.V1,a.Variant.CONTROL].includes($)&&(a.logExposure({feature:"lifecycle_2026_01_12_locked_team_restriction",variant:$}),a.logAdditionalExposureDetailsForLockedStateTeam($,"share_modal_banner",N))}),[$,D,I,N,T]),w.default.useEffect((()=>{R&&U&&!h.current&&(a.UDCL.logEvent({class:"quota",action:"shown",object:"overquota_share_modal_banner",properties:{quotaLimit:B,quotaUsed:V,secondsOverquota:F,hardblocked:q,organicOrChurned:K}},{tags:{hardblocked:q?"true":"false",organicOrChurned:K}}),h.current=!0)}),[R,U,B,V,F,q,K]),!R)return null;if(!U)return null;const G=!!(null===(E=null==N?void 0:N.restrictions)||void 0===E?void 0:E.show_restrictions_warning)&&!T,W=function(e,t,a){var n;return a?i.SHARING_ENFORCE_RESTRICTION_LOCKED_STATE_TEAM:e?(null===(n=null==t?void 0:t.restrictions)||void 0===n?void 0:n.restrictions_start_time_utc_seconds)?i.SHARING_RESTRICTION_WARNING(i.getRestrictionsDateString(t.restrictions.restrictions_start_time_utc_seconds)):i.SHARING_RESTRICTION_WARNING_NO_DATE:i.SHARING_ENFORCE_RESTRICTIONS}(G,N,!!T),Q=T&&!P?()=>{}:()=>{a.UDCL.logEvent({class:"quota",action:"select",object:"overquota_share_modal_banner",properties:{quotaLimit:B,quotaUsed:V,secondsOverquota:F,hardblocked:q,organicOrChurned:K,actionElement:"upgrade"}},{tags:{actionElement:"upgrade",hardblocked:q?"true":"false",organicOrChurned:K}}),b?(S(!0),a.openDoormanUpsellModal({modalVersion:"glide-upsell-modal-dp-only",trialCardsLocation:a.TrialCardsLocation.OVERQUOTA_SHARE_BANNER,reloadPageAfterPurchase:!0,onDisplayed:()=>{null==e||e()}})):(T?a.redirect("/plans?_tk=locked_state_team_restrictions_modal"):a.redirect("/out-of-space?_tk=oq_restrictions_modal"),null==e||e())},Y=T?P?i.VIEW_PLANS:i.CONTACT_ADMIN:i.UPGRADE;return t?w.default.createElement(Le,{message:W,icon:G?a.WarningLine:r.OverQuotaLine,type:G?"warning":"alert",action:{label:Y,onClick:Q,isLoading:f,dismissOnClick:!1},isDismissible:!1}):w.default.createElement(a.Box,{className:pe,"data-testid":"over-quota-share-banner-component"},w.default.createElement(a.Banner,{type:G?"warning":"alert",borderRadius:"Large"},w.default.createElement(a.Box,{display:"flex",justifyContent:"space-between",flexDirection:T?"column":"row",alignItems:T?"flex-start":"center"},w.default.createElement(a.Banner.Message,null,W),w.default.createElement(a.Banner.Actions,null,w.default.createElement(a.Button,{variant:"transparent",onClick:Q,isLoading:f},Y)))))};Ae.displayName="OverquotaShareBannerComponent";const Te=l.defineMessage({id:"UaJBfk",defaultMessage:"QR code for sharing"}),Ie=l.defineMessage({id:"ZFsp0l",defaultMessage:"Download"}),we=l.defineMessage({id:"vaYU6E",defaultMessage:"Save"}),$e=l.defineMessage({id:"E89n5D",defaultMessage:"Download QR code"}),Ne=l.defineMessage({id:"EQKjGC",defaultMessage:"Anyone with the code can view."}),Me=l.defineMessage({id:"J8vTeR",defaultMessage:"Team members with the code can view."}),xe=l.defineMessage({id:"8JPLVJ",defaultMessage:"Manage link access"}),Re=l.defineMessage({id:"lx/NTL",defaultMessage:"Manage link settings"}),Oe=l.defineMessage({id:"tllLrY",defaultMessage:"Only people invited can view."}),De=l.defineMessage({id:"bWq9cz",defaultMessage:"Couldn’t create QR code. You don’t have permission to create a QR code to this content."}),Pe=l.defineMessage({id:"tpMKHD",defaultMessage:"We can’t find this file anymore. Try checking activity or folder history to see what happened."}),Ue=l.defineMessage({id:"zGqflr",defaultMessage:"You can’t share until you verify your email address."}),Be=l.defineMessage({id:"zM/n79",defaultMessage:"Couldn’t create QR code. Please try again later."}),Ve=l.defineMessage({id:"s2Zxdl",defaultMessage:"Couldn’t create QR code."}),je=l.defineMessage({id:"05SzGG",defaultMessage:"Couldn’t create QR code.<br></br>Try again later."});var Fe;!function(e){e.PATH_FORBIDDEN="path_forbidden",e.PATH_NOT_FOUND="path_not_found",e.EMAIL_NOT_VERIFIED="email_not_verified",e.SERVICE_UNAVAILABLE="service_unavailable",e.UNKNOWN="unknown"}(Fe||(Fe={}));const qe=e=>`data:image/png;base64,${e}`;a.injectInternalStyle("/static/metaserver/static/js/sharing/features/sharing_qr_code/get_qr_code_modal.module.out-vflNN1fVL.css",(e=>"._get-qr-code-modal_dbu8m_1>div{background-color:var(--dig-color__background__subtle);border:1px solid var(--dig-color__border__subtle)}._get-qr-code-modal-image_dbu8m_6{display:flex;width:100%}._get-qr-code-modal-spinner_dbu8m_11{align-items:center;aspect-ratio:1/1;display:flex;justify-content:center;width:100%}._get-qr-code-modal-body_dbu8m_19{padding-bottom:var(--spacing__unit--3);padding-top:calc(var(--spacing__unit--1)*6)}._get-qr-code-modal-filename_dbu8m_25{white-space:nowrap}@media (min-width:601px){._get-qr-code-modal-body_dbu8m_19{padding-top:var(--spacing__unit--3)}._get-qr-code-modal_dbu8m_1 button.dig-Modal-close-btn{display:none}}"));const He=({base64QrCode:e})=>w.default.createElement("img",{"data-testid":"qr-code-modal-image",className:"_get-qr-code-modal-image_dbu8m_6",src:qe(e),alt:l.intl.formatMessage(Te)});He.displayName="GetQrCodeModalImage";const Ke=()=>w.default.createElement("div",{className:"_get-qr-code-modal-spinner_dbu8m_11"},w.default.createElement(a.Spinner,{size:"medium"})),Ge=a.createApiv2Query({nsClient:a.GetSharingQrCodeRoutes,rpc:"get_qr_code"}),We="Micro XLarge",Qe="Micro Medium",Ye="Micro Small",ze="Micro Large",Xe=({children:e,isSm26:t})=>{var n;const i="dark"===(null===(n=a.useTheme())||void 0===n?void 0:n.mode),{small:o}=a.useBreakpoint({strategy:"maxWidth"});return t&&!o?w.default.createElement(a.Box,{display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:i?void 0:"Secondary On Base",borderRadius:"XXLarge",paddingTop:We,paddingBottom:We,style:{width:"100%"},"data-testid":"qr-code-outer-wrapper"},e):w.default.createElement(w.default.Fragment,null,e)};Xe.displayName="QrBoxWrapper";const Je=()=>w.default.createElement(a.Box,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",style:{paddingTop:"100px",paddingBottom:"150px"}},w.default.createElement(a.UIIcon,{src:a.FailLine,size:"large",color:"var(--dig-color__text__subtle)"}),w.default.createElement(a.Box,{marginTop:"Micro Small"},w.default.createElement(a.Title,{size:"small",weightVariant:"emphasized",color:"subtle"},l.intl.formatMessage(je,{br:()=>w.default.createElement("br",null)}))));Je.displayName="GetQrCodeError";const Ze=({isSm26:e})=>{var t;const n="dark"===(null===(t=a.useTheme())||void 0===t?void 0:t.mode),{small:i}=a.useBreakpoint({strategy:"maxWidth"}),o=e&&!i,r=o?204:void 0;return w.default.createElement(w.default.Fragment,null,w.default.createElement(Xe,{isSm26:e},w.default.createElement(a.Box,{padding:"Micro XLarge",marginTop:o?void 0:"Micro Small",borderWidth:"1",borderColor:"Border Subtle",borderStyle:"Solid",backgroundColor:n?"Secondary Surface - State 1":"Background Base",borderRadius:"XLarge",style:r?{width:`${r}px`,height:`${r}px`}:void 0},w.default.createElement(Ke,null))),w.default.createElement(a.Box,{marginTop:e?Qe:ze,marginBottom:e&&i?"Micro Large":void 0,textAlign:e?"center":void 0},w.default.createElement(a.Button,{size:"large",variant:"primary",fullWidth:!0,"data-uxa-log":"download_qr_code_modal_button","aria-label":l.intl.formatMessage($e),disabled:!0,autoFocus:!0},l.intl.formatMessage(e?we:Ie)),w.default.createElement(a.Box,{marginTop:e?Ye:ze},w.default.createElement(a.Skeleton.Text,null)," ",w.default.createElement(a.Skeleton.Text,null))))};Ze.displayName="GetQrCodeLoading";const et=({objectIdentifier:e,user:t,onSettingsClick:i,qrCodeResponse:o,fileName:r,filePath:s,isSm26:c})=>{var d,u;const g=null!==(d=o.qrcode)&&void 0!==d?d:"",m=o.effective_audience,{small:_}=a.useBreakpoint({strategy:"maxWidth"}),p=c&&!_,E=p?204:void 0,f=w.default.useCallback(((i,o)=>{const r=a.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,l=n.get_browser_info(),c=e.fileId;a.ShareTibEventLogger.log(t.id,i,r,{file_id:c,fq_path:s,is_folder:"file"!==e[".tag"],browser:l.browser,browser_version:l.version,...o})}),[e,s,t.id]);w.default.useEffect((()=>{const e=o.link_url;if(e){const t=a.parseLink(e),n=t.doesContainShmodelLink?a.ShareTibEventLogger.get_shmodel_extra_for_logging(void 0,a.getCleanedSharingUrl(t)):a.ShareTibEventLogger.get_scl_extra_for_logging(void 0,a.getCleanedSharingUrl(t)),i={sender_trackey:t.searchParams.get("st"),...n};f(a.TiburonEventName.CreateQrCode,i)}}),[f,o.link_url]);const S="dark"===(null===(u=a.useTheme())||void 0===u?void 0:u.mode),y=(e=>{switch(e){case"public":return Ne;case"team":return Me;case"no_one":return Oe;default:return""}})(m);return w.default.createElement(w.default.Fragment,null,w.default.createElement(Xe,{isSm26:c},w.default.createElement(a.Box,{padding:"Micro XLarge",marginTop:p?void 0:"Micro Small",borderWidth:"1",borderColor:"Border Subtle",borderStyle:"Solid",backgroundColor:S?"Secondary Surface - State 1":"Background Base",borderRadius:"XLarge",style:E?{width:`${E}px`,height:`${E}px`}:void 0},w.default.createElement(He,{base64QrCode:g}))),w.default.createElement(a.Box,{marginTop:c?Qe:ze,marginBottom:c&&_?"Micro Large":void 0,textAlign:c?"center":void 0},w.default.createElement(a.Button,{size:"large",variant:"primary",onClick:e=>{e.preventDefault(),((e,t)=>{const a=document.createElement("a");a.href=qe(e),a.download=`${t}_QR.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a)})(g,r)},fullWidth:!0,"data-uxa-log":"download_qr_code_modal_button","aria-label":l.intl.formatMessage($e),autoFocus:!0},l.intl.formatMessage(c?we:Ie)),w.default.createElement(a.Box,{marginTop:c?Ye:ze},y?w.default.createElement(a.Text,null,l.intl.formatMessage(y)):null,i?w.default.createElement(w.default.Fragment,null," ",w.default.createElement(a.Link,{hasNoUnderline:!0,href:"#",onClick:e=>{e.preventDefault(),i()},"data-uxa-log":"settings_qr_code_modal_button",display:"inline"},l.intl.formatMessage(c?Re:xe))):null)))};et.displayName="GetQrCodeLoaded";const tt=e=>{const{user:t,onGetQrCodeError:n,objectIdentifier:i,fileName:o,filePath:r,isSm26:s}=e,c=(e=>{const t=Ge.useQuery({apiArg:{read_path:e}},{staleTime:0});return w.useMemo((()=>t?t.isLoading?{isLoading:!0}:t.isError?{isLoading:!1,isError:!0,error:t.error.appError}:{output:t.data.apiData,isLoading:!1,isError:!1}:{isLoading:!0}),[t])})(a.getContentIdOrPathFromObjectIdentifier(i)),d=w.default.useRef(!1);return w.default.useEffect((()=>{var e;if(!1===d.current&&!c.isLoading&&(void 0===t||c.isError||void 0===c.output||void 0===c.output.qrcode||""===c.output.qrcode)){d.current=!0;const t=c.isError?null===(e=c.error)||void 0===e?void 0:e[".tag"]:void 0;s||(a.Snackbar.warn(l.intl.formatMessage((e=>{switch(e){case Fe.PATH_FORBIDDEN:return De;case Fe.PATH_NOT_FOUND:return Pe;case Fe.EMAIL_NOT_VERIFIED:return Ue;case Fe.SERVICE_UNAVAILABLE:return Be;default:return Ve}})(t))),null==n||n())}}),[n,t,c,s]),c.isLoading?w.default.createElement(Ze,{isSm26:s}):void 0===t||c.isError||void 0===c.output||void 0===c.output.qrcode||""===c.output.qrcode?s?w.default.createElement(Je,null):null:w.default.createElement(et,{...e,user:t,qrCodeResponse:c.output,fileName:o,filePath:r})};tt.displayName="GetQrCodeInner";const at=e=>{const{user:t,isLoading:n}=a.useActiveUser();return n?w.default.createElement(Ze,{isSm26:e.isSm26}):w.default.createElement(tt,{...e,user:t})};at.displayName="GetQrCode";var nt;!function(e){e.MAIN="main",e.QRCODE="qrcode",e.INBAND="inband",e.MANAGE_ACCESS="manage_access",e.COPY_LINK="copy_link",e.SETTINGS="settings",e.ERROR="error"}(nt||(nt={}));const it=e=>{const t=w.useRef(null),[n,i]=w.useState(-1),o=d.usePlatform()===d.Platforms.DESKTOP;w.useEffect((()=>{e.isOpen&&t.current&&"inband"!==e.currentScreen&&t.current.focus()}),[e.isOpen,e.currentScreen]);const r=e.onEscape,s=w.useCallback((e=>{if(!t.current)return;if("Shift"===e.key)return;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)){const t=e.target;t&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName||"true"===t.contentEditable||t.isContentEditable)||(e.preventDefault(),e.nativeEvent.stopImmediatePropagation())}return"Escape"===e.key?(r(e),e.preventDefault(),void e.nativeEvent.stopImmediatePropagation()):void 0}),[r,n,i]),l="anchored_v1"===e.displayMode?e.onAnchorInvalid:void 0,c=x("anchored_v1"===e.displayMode?t:null,{threshold:[.99]});w.useLayoutEffect((()=>{c&&!c.isIntersecting&&l&&l()}),[c,null==c?void 0:c.isIntersecting,l]);const g="anchored_v1"===e.displayMode?e.anchorRef:null;if(w.useEffect((()=>{if("anchored_v1"!==e.displayMode||!l||null===g)return;const t=g.current;if(!t||"object"!=typeof t||!("nodeType"in t))return;const a=new MutationObserver((e=>{var a,n;for(const i of e)if("childList"===i.type)for(const e of Array.from(i.removedNodes))if(e===t||(null===(n=(a=e).contains)||void 0===n?void 0:n.call(a,t)))return void l()}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>{a.disconnect()}}),[e.displayMode,l,g]),"centered_v1"===e.displayMode){const n=e.currentScreen===nt.SETTINGS?500:e.currentScreen===nt.COPY_LINK?400:380;return w.createElement(a.Modal,{open:e.isOpen,width:n,ariaHideApp:!1,onRequestClose:e.onClickOutside,overlayStyles:o?{overflow:"visible"}:void 0,contentStyles:o?{borderRadius:"unset"}:void 0,ref:t,isCentered:!0},w.createElement(d.FocusLock,{group:"share-modal"},w.createElement("div",{"data-testid":"shareme24-modal","data-uxa-log":"sm24-modal","data-uxa-interactions":"shown",className:a.cx(u.outerWrapper,{[u.outerWrapperDesktop]:o}),ref:e.modalCallbackRef,style:{width:n}},null!==e.header&&w.createElement(a.Modal.Header,{className:u.headerSection},e.header),w.createElement(a.Modal.Body,{className:a.cx(u.modalInnerWrapper,{[u.modalInnerWrapperMainExit]:e.isExitingMainToQr,[u.modalInnerWrapperSettings]:e.currentScreen===nt.SETTINGS}),onAnimationEnd:e.onOverlayOrModalAnimationEnd},e.children))))}if("drawer"===e.displayMode){const t="main"===e.currentScreen,n=t?"auto":"100%";return w.createElement(a.Drawer.ModalDrawer,{onRequestClose:e.onClickOutside,"aria-label":"sm24-drawer",isOpen:e.isOpen,alignment:"bottom",height:n,className:t?u.roundedCorner:void 0,"data-testid":"shareme24-drawer",shouldAnimate:!0,hasScrollLock:e.hasScrollLock},w.createElement(d.FocusLock,{group:"share-modal"},w.createElement("div",{className:a.cx(u.drawerOuterWrapper)},w.createElement(a.Drawer.Container,null,t?w.createElement("div",{className:u.handle}):void 0,w.createElement(a.Drawer.Header,{className:u.drawerHeader},w.createElement(a.Drawer.Layout,null,w.createElement(a.Drawer.LayoutItem,{width:"fill"},w.createElement(a.Drawer.Layout,null,e.header)))),w.createElement(a.Drawer.Body,{className:a.cx(u.modalInnerWrapper,u.drawerBody,{[u.drawerBodySettings]:e.currentScreen===nt.SETTINGS,[u.modalInnerWrapperMainExit]:e.isExitingMainToQr}),onAnimationEnd:e.onOverlayOrModalAnimationEnd},e.children)))))}return w.createElement(a.ClickOutside,{className:u.clickOutside,isActive:e.isOpen,onClickOutside:e.onClickOutside,shouldClickOutsideWhenDefaultPrevented:!1,"data-uxa-log":"sm24-clickaway","data-uxa-interactions":"click"},w.createElement(a.Overlay,{className:a.cx(u.overlay,{[u.overlayMainExit]:e.isExitingMainToQr}),offsetDistance:e.offsetDistance,anchorRef:e.anchorRef,placement:e.placement,auto:!0,onAnimationEnd:e.onOverlayOrModalAnimationEnd,elementResize:!0},w.createElement(d.FocusLock,{group:"share-modal"},w.createElement("div",{"data-testid":"shareme24-modal",className:a.cx(u.outerWrapper),style:{width:e.currentScreen===nt.SETTINGS?500:e.currentScreen===nt.COPY_LINK?400:380},onKeyDown:s,ref:a=>{t&&(t.current=a),"function"==typeof e.modalCallbackRef&&e.modalCallbackRef(a)},"data-uxa-log":"sm24-modal","data-uxa-interactions":"shown",tabIndex:0},null!==e.header&&w.createElement(a.Modal.Header,{className:u.headerSection},e.header),w.createElement(a.Modal.Body,{className:a.cx(u.modalInnerWrapper,{[u.modalInnerWrapperMainExit]:e.isExitingMainToQr,[u.modalInnerWrapperSettings]:e.currentScreen===nt.SETTINGS}),onAnimationEnd:e.onOverlayOrModalAnimationEnd},e.children)))))};it.displayName="Wrapper";const ot=({styleName:e,...t})=>w.createElement("div",{className:`${u.buttonRow} ${e}`,"aria-hidden":t.hidden,...t},t.children);ot.displayName="ButtonRow";const rt=({styleName:e,...t})=>w.createElement("div",{className:`${u.buttonRowButtonWrapper} ${e}`,"aria-hidden":t.hidden,...t},t.children);rt.displayName="ButtonRowButtonWrapper";const st="SHARING_BANNED_MODAL",lt=e=>{const[n,i]=t.useState(!0),o=l.intl.formatMessage({id:"sHjsEB",defaultMessage:"Couldn’t complete share"}),r=l.intl.formatMessage({id:"3Ob1gB",defaultMessage:"We’ve interrupted your sharing activity. For details or to contact support, read our <link>help center article.</link>"},{link:e=>w.default.createElement(a.Button,{variant:"transparent",href:a.ABUSE_HELP_ARTICLE_LINK,target:"_blank",hasUnderline:!1},e)});return w.default.createElement(a.Modal,{open:n,isCentered:!0,withCloseButton:"Close",onRequestClose:()=>i(!1),onAfterClose:e.onAfterClose,"aria-labelledby":"sharing-banned-modal-title"},w.default.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},w.default.createElement(a.Modal.Title,{id:"sharing-banned-modal-title"},o)),w.default.createElement(a.Modal.Body,null,r),w.default.createElement(a.Modal.Footer,null))};lt.displayName="SharingBannedModal";const ct=Symbol("ON_CLICK_PROGRESSIVE"),dt=Symbol("ON_MOUSE_ENTER_PROGRESSIVE"),ut=Symbol("ON_MOUSE_LEAVE_PROGRESSIVE"),{useEmitter:gt,defaultEmitter:mt}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};if(e.key===ct)return a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"copy_link"}}),void a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"copy_link"}});if(e.key!==dt){if(e.key!==ut)return a.exhausts(e,void 0);a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"copy_link"}})}else a.UDCL.logEvent(y.PAP_Hover_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"copy_link"}),{tags:{...s,action:"copy_link"}})})),_t=e=>{const{objectMetadata:t,accountMetadata:n,onCopyLinkButtonClicked:i,componentViewTime:o}=e,r=a.isNewApiMetadata(t),[s,c]=w.useState(!1),[d,u]=w.useState(!1),[g,m]=w.useState(0),_=w.useRef(null),p=gt(),f=E.isTmrMember(n),y=a.getCanCreateLink(t,a.VIEWER,f),C=a.getCanCreateLink(t,a.EDITOR,f)||y,v=w.useCallback((()=>{const e=d?Date.now()-g:void 0,t=Date.now()-o;p.select(ct).emit({dwellTime:e,timeSinceView:t}),i()}),[o,p,d,i,g]),b=w.useCallback((()=>{m(Date.now()),u(!0),p.select(dt).emit(null),c(!0)}),[p]),h=w.useCallback((()=>{const e=d?Date.now()-g:void 0;u(!1),p.select(ut).emit({dwellTime:e}),c(!1)}),[p,d,g]),k=w.useMemo((()=>!!r&&!C),[r,C]);return w.createElement(w.Fragment,null,w.createElement(S.ButtonWrapper,{ref:_,onMouseEnter:b,onMouseLeave:h,"data-uxa-log":"sharing-lego-copy_link-button.loaded","data-uxa-interactions":"shown click"},w.createElement(S.VerticalButton,{onClick:v,disabled:k,"data-testid":"copy-link-entry-button"},w.createElement(S.ButtonIconContainer,null,w.createElement(a.UIIcon,{src:a.LinkLine,size:"medium","data-testid":"copy-link-entry-button-icon"})),w.createElement(S.Spacer,null),w.createElement(S.ButtonInnerColumn,null,w.createElement(S.ButtonTitle,{content:(L=l.intl,L.formatMessage({id:"1xxmJZ",defaultMessage:"Copy link"}))})))),(()=>{let e=null;return r&&!C&&(e=w.createElement(a.Text,null,l.intl.formatMessage({id:"wVml0u",defaultMessage:"You don’t have permission to copy this link."}))),e?w.createElement(a.Tooltip.Control,{open:s,placement:"top",auto:!0,triggerRef:_,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1)},e):null})());var L};_t.displayName="CopyLinkEntryButtonInner";const pt=e=>{const{objectIdentifier:t,onCopyLinkButtonClicked:n,componentViewTime:i}=e,o=E.useSharingObjectMetadata(t.fileId),r=E.useSharingAccountInfo(),s=o.isLoading,l=!o.isLoading&&o.isError,c=s||l?void 0:o.output,d=r.isLoading,u=!r.isLoading&&r.isError,g=d||u?void 0:r.output;return s||d?w.createElement(S.ButtonWrapper,{"data-uxa-log":"sharing-lego-copy-link-button.loading","data-uxa-interactions":"shown click"},w.createElement(S.VerticalButton,{disabled:!0},w.createElement(S.ButtonIconContainer,null,w.createElement(a.UIIcon,{src:a.LinkLine,size:"medium"})),w.createElement(S.Spacer,null),w.createElement(S.ButtonInnerColumn,null,w.createElement(a.Skeleton.Text,{size:"small",style:{marginTop:22}})))):c&&g?w.createElement(_t,{accountMetadata:g,objectMetadata:c,onCopyLinkButtonClicked:n,componentViewTime:i}):null};pt.displayName="CopyLinkEntryButton";const Et=Symbol("ON_CLICK"),ft=Symbol("ON_MOUSE_ENTER"),St=Symbol("ON_MOUSE_LEAVE"),{useEmitter:yt,defaultEmitter:Ct}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};if(e.key===Et)return a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"copy_link"}}),void a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"copy_link"}});e.key!==ft?e.key!==St||a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"copy_link"}}):a.UDCL.logEvent(y.PAP_Hover_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"copy_link"}),{tags:{...s,action:"copy_link"}})})),vt=({store:e,objectMetadata:t,isSimpleCopyLinkPending:n=!1})=>{const i=!!t&&a.isNewApiMetadata(t),[o,r]=w.useState(!1),s=w.useRef(null),c=yt(),d=!!t&&a.getCanCreateLink(t,a.VIEWER,!1),u=!!t&&a.getCanCreateLink(t,a.EDITOR,!1),g=d||u,m=w.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,a=Date.now()-e.$componentViewTime.get();c.select(Et).emit({dwellTime:t,timeSinceView:a}),e.$isHovered.set(!1),e.$props.get().onClickCopyLinkButton()}),[c,e]),_=w.useCallback((()=>{c.select(ft).emit(null),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now()),r(!0)}),[c,e]),p=w.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;c.select(St).emit({dwellTime:t}),e.$isHovered.set(!1),e.$hoverStartTime.set(0),r(!1)}),[c,e]);w.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const E=n||!!i&&!g;return w.createElement(w.Fragment,null,w.createElement(S.ButtonWrapper,{ref:s,onMouseEnter:_,onMouseLeave:p,"data-uxa-log":"sm24-copy_link-button.loaded","data-uxa-interactions":"shown click"},w.createElement(S.VerticalButton,{onClick:m,disabled:E,"data-testid":"copy-link-button"},w.createElement(S.ButtonIconContainer,null,w.createElement(a.UIIcon,{src:a.LinkLine,size:"medium","data-testid":"copy-link-icon"})),w.createElement(S.Spacer,null),w.createElement(S.ButtonInnerColumn,null,w.createElement(S.ButtonTitle,{content:(f=l.intl,f.formatMessage({id:"1xxmJZ",defaultMessage:"Copy link"}))})))),(()=>{let e=null;return i&&!g&&(e=w.createElement(a.Text,null,l.intl.formatMessage({id:"wVml0u",defaultMessage:"You don’t have permission to copy this link."}))),e?w.createElement(a.Tooltip.Control,{open:o,placement:"top",auto:!0,triggerRef:s,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1)},e):null})());var f};vt.displayName="LoadedButton";const bt=()=>w.createElement(S.ButtonWrapper,{"data-uxa-log":"sm24-copy-link-button.loading","data-uxa-interactions":"shown click"},w.createElement(S.VerticalButton,{disabled:!0},w.createElement(S.ButtonIconContainer,null,w.createElement(a.UIIcon,{src:a.LinkLine,size:"medium"})),w.createElement(S.Spacer,null),w.createElement(S.ButtonInnerColumn,null,w.createElement(a.Skeleton.Text,{size:"small",style:{marginTop:22}}))));bt.displayName="LoadingButton";const ht=({store:e,isSimpleCopyLinkPending:t})=>{const{variant:n,isLoading:i}=a.useExperimentVariant("sm24_obj_metadata_new_api"),o=_e();return i||"V1"===n&&"loading"===o.status?w.createElement(bt,null):"V1"===n&&"error"===o.status?null:"V1"===n&&"loaded"===o.status?w.createElement(vt,{store:e,objectMetadata:o.objectMetadata,isSimpleCopyLinkPending:t}):w.createElement(vt,{store:e})};ht.displayName="Inner";const kt=e=>{const t=(e=>g.useInitStore(e,(e=>({$props:e,$isHovered:g.store(!1),$hoverStartTime:g.store(0),$componentViewTime:g.store(0)}))))(e);return w.createElement(ht,{store:t,isSimpleCopyLinkPending:e.isSimpleCopyLinkPending})};var Lt;kt.displayName="CopyLinkButton",function(e){e.MAIN="main",e.QRCODE="qrcode",e.INBAND="inband",e.MANAGE_ACCESS="manage_access",e.COPY_LINK="copy_link",e.SETTINGS="settings",e.ERROR="error"}(Lt||(Lt={}));const At=({store:e})=>{const{objectIdentifier:t,shouldUseSimpleCopyLink:n,isSimpleCopyLinkPending:i}=g.useStore(e.$props),o=g.useStore(e.$componentViewTime),{variant:r,isLoading:s}=a.useExperimentVariant("sm24_copy_link"),l=w.useCallback((()=>{g.batch((()=>{e.$props.get().copyLinkHandler(),e.$props.get().onActionClicked(!0)}))}),[e]),c=d.usePlatform()===d.Platforms.METASERVER,u=w.useCallback((()=>{let t=()=>{};const a=new Promise((e=>{t=e}));if("undefined"!=typeof ClipboardItem&&navigator.clipboard.write){const e=new ClipboardItem({"text/plain":a});navigator.clipboard.write([e])}else a.then((e=>navigator.clipboard.writeText(e)));const n={write:e=>t(e)};c?(e.$clipboardWriter.set(n),e.$isClickawayLocked.set(!0),f.showOQModalOrContinue({action:"share_link",continueCallback:()=>{g.batch((()=>{e.$currentScreen.set(Lt.COPY_LINK),e.$isClickawayLocked.set(!1)}))},abortCallback:()=>{e.$isClickawayLocked.set(!1)}})):g.batch((()=>{e.$clipboardWriter.set(n),e.$currentScreen.set(Lt.COPY_LINK)}))}),[e,c]);return w.useMemo((()=>!n&&(!s&&r&&a.logExposure({feature:"sm24_copy_link",variant:r}),!s&&"V3"===r)),[n,r,s])?w.createElement(pt,{onCopyLinkButtonClicked:u,objectIdentifier:t,componentViewTime:o}):w.createElement(kt,{onClickCopyLinkButton:l,objectIdentifier:t,isSimpleCopyLinkPending:i})};At.displayName="CopyLinkButton";const Tt=e=>e.formatMessage({id:"LXsTaR",defaultMessage:"Share with Stacks"}),It=e=>e.formatMessage({id:"Sk39rj",defaultMessage:"New"}),wt=Symbol("ON_CLICK"),$t=Symbol("ON_MOUSE_ENTER"),Nt=Symbol("ON_MOUSE_LEAVE"),{useEmitter:Mt,defaultEmitter:xt}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};if(e.key===wt)return a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"stack",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"stack"}}),void a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"stack",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"stack"}});e.key!==$t?e.key!==Nt||a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"stack",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"stack"}}):a.UDCL.logEvent(y.PAP_Hover_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"stack"}),{tags:{...s,action:"stack"}})})),Rt="stack-button",Ot="stack-icon",Dt=({store:e,showStackNewFeatureBadge:t,user:n})=>{const i=Mt(),o=w.default.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,o=Date.now()-e.$componentViewTime.get();i.select(wt).emit({dwellTime:a,timeSinceView:o}),e.$isHovered.set(!1),t&&C.setUserMetadata({FSS_STACKS_SM24_SEEN:!0},n),e.$props.get().onClickStackButton()}),[n,e,i,t]),s=w.default.useCallback((()=>{i.select($t).emit(null),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,i]),c=w.default.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;i.select(Nt).emit({dwellTime:t}),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,i]);return w.default.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]),w.default.createElement(w.default.Fragment,null,w.default.createElement(S.ButtonWrapper,{onMouseEnter:s,onMouseLeave:c,"data-uxa-log":"sm24-stack-button.loaded","data-uxa-interactions":"shown click"},w.default.createElement(S.HorizontalButton,{"data-testid":Rt,onClick:o},w.default.createElement(S.ButtonIconContainer,null,w.default.createElement(a.UIIcon,{src:r.CreateStackLine,size:"medium","data-testid":Ot})),w.default.createElement(S.ButtonInnerRow,null,w.default.createElement(S.ButtonTitle,{content:Tt(l.intl)}),t&&w.default.createElement(a.Box,{style:{height:"var(--dig-spacing__macro__small)"},color:"Identity On Yellow",borderRadius:"Small",backgroundColor:"Identity Yellow",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"Action",fontSize:"Action Small",fontWeight:"Strong",letterSpacing:"Action",paddingLeft:"10",paddingRight:"10","data-testid":"stack-new-feature-badge","aria-label":It(l.intl)},It(l.intl))))))};Dt.displayName="StackButton";const Pt=({store:e})=>{const t=Mt(),{isFolderFileCountOverLimit:n}=g.useStore(e.$props),[i,o]=w.default.useState(!1),s=w.default.useRef(null),c=w.default.useCallback((()=>{t.select($t).emit(null),o(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,t]),d=w.default.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;t.select(Nt).emit({dwellTime:a}),o(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,t]);return w.default.createElement(w.default.Fragment,null,w.default.createElement(S.ButtonWrapper,{ref:s,onMouseEnter:c,onMouseLeave:d,"data-uxa-log":"sm24-stack-button.disabled","data-uxa-interactions":"shown click"},w.default.createElement(S.HorizontalButton,{disabled:!0,"data-testid":Rt},w.default.createElement(S.ButtonIconContainer,null,w.default.createElement(a.UIIcon,{src:r.CreateStackLine,size:"medium","data-testid":Ot})),w.default.createElement(S.ButtonInnerColumn,null,w.default.createElement(S.ButtonTitle,{content:Tt(l.intl)})))),n&&w.default.createElement(a.Tooltip.Control,{open:i,placement:"left",auto:!0,triggerRef:s,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1)},w.default.createElement(a.Text,null,l.intl.formatMessage({id:"uJJZGp",defaultMessage:"Can’t add more than 200 files to a Stack at a time"}))))};Pt.displayName="StackButtonDisabled";const Ut=()=>w.default.createElement(S.ButtonWrapper,{"data-uxa-log":"sm24-stack-button.loading","data-uxa-interactions":"shown click"},w.default.createElement(S.HorizontalButton,{disabled:!0,"data-testid":Rt},w.default.createElement(a.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),w.default.createElement(a.Skeleton.Text,{size:"large",width:200})));Ut.displayName="LoadingButton";const Bt=({store:e})=>{const{isFolderFileCountOverLimit:n,contents:i}=g.useStore(e.$props),o=a.mustGetActiveUserApiV2Properties(),[r,s]=t.useState(null);return t.useEffect((()=>{C.getUserMetadata(["FSS_STACKS_SM24_SEEN"],o).then((e=>{s(!e.FSS_STACKS_SM24_SEEN)}))}),[o]),null===r?w.default.createElement(Ut,null):i?w.default.createElement(Dt,{store:e,showStackNewFeatureBadge:r,user:o}):null===n?w.default.createElement(Ut,null):w.default.createElement(Pt,{store:e})};Bt.displayName="Inner";const Vt=e=>{const t=(e=>{const t=_e(),a=g.useInitStore(t,(e=>e));return g.useInitStore(e,(e=>{const t=g.store(!1),n=g.store(0),i=g.store(0);return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:i}}))})(e);return w.default.createElement(Bt,{store:t})};Vt.displayName="StacksButton";const jt=({store:e})=>{const t=w.useCallback((()=>{e.$props.get().createStackHandler(),e.$props.get().onActionClicked()}),[e]),a=g.useStore(e.$isFolderFileCountOverLimit),n=g.useStore(e.$contents);return w.createElement(Vt,{onClickStackButton:t,isFolderFileCountOverLimit:a,contents:n})};jt.displayName="DashStacksButton";const Ft=({store:e})=>{const{objectIdentifier:t}=g.useStore(e.$props),a=g.useStore(e.$componentViewTime),n=d.usePlatform()===d.Platforms.METASERVER,i=w.useCallback((()=>{g.batch((()=>{e.$isEnteringInband.set(!0),e.$currentScreen.set(Lt.INBAND),e.$isInbandStarted.set(!0)}))}),[e]);return w.createElement(y.InbandEntryButton,{oid:t,onInbandButtonClicked:()=>{n?(e.$isInterstitialVisible.set(!0),f.showOQModalOrContinue({show:f.Show.WarningOnly,action:"share_add_people",continueCallback:()=>{i(),e.$isInterstitialVisible.set(!1)},abortCallback:()=>e.$isInterstitialVisible.set(!1)})):i()},componentViewTime:a})};Ft.displayName="InbandInviteButton";const qt=e=>e.formatMessage({id:"O6jjXZ",defaultMessage:"Create a view-only QR code"}),Ht=Symbol("ON_CLICK"),Kt=Symbol("ON_MOUSE_ENTER"),Gt=Symbol("ON_MOUSE_LEAVE"),{useEmitter:Wt,defaultEmitter:Qt}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};if(e.key===Ht)return a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"qr_code"}}),void a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"qr_code"}});e.key!==Kt?e.key!==Gt||a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"qr_code"}}):a.UDCL.logEvent(y.PAP_Hover_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"qr_code"}),{tags:{...s,action:"qr_code"}})})),Yt=({store:e})=>{const[t,n]=w.useState(!1),i=w.useRef(null),o=g.useStore(e.$data),s=Wt(),c=w.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,a=Date.now()-e.$componentViewTime.get();s.select(Ht).emit({dwellTime:t,timeSinceView:a}),e.$isHovered.set(!1),e.$props.get().onClickQrCodeButton()}),[e,s]),d=w.useCallback((()=>{s.select(Kt).emit(null),n(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,s]),u=w.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;s.select(Gt).emit({dwellTime:t}),n(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,s]);w.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const m="loaded"===o.status?o.objectMetadata:void 0,_=!!m&&a.getCanCreateLink(m,a.VIEWER,!1),p=_?qt(l.intl):l.intl.formatMessage({id:"8T+dAM",defaultMessage:"You don’t have permission to create a QR code."});return w.createElement(w.Fragment,null,w.createElement(a.Box,{ref:i,onMouseEnter:d,onMouseLeave:u,"data-uxa-log":"sm24-qrcode-button.loaded","data-uxa-interactions":"shown click"},w.createElement(S.UtilityIconButton,{"data-testid":"qr-code-button",onClick:c,variant:e.$props.get().buttonVariant,disabled:!_},w.createElement(a.UIIcon,{src:r.QrCodeLine,"aria-label":qt(l.intl)})),w.createElement(a.Tooltip.Control,{open:t,placement:"top",auto:!0,triggerRef:i,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},w.createElement(a.Text,null,p))))};Yt.displayName="LoadedButton";const zt=({store:e})=>w.createElement(Yt,{store:e});zt.displayName="Inner";const Xt=e=>{const t=(e=>{const t=_e(),a=g.useInitStore(t,(e=>e));return g.useInitStore(e,(e=>{const t=g.store(!1),n=g.store(0),i=g.store(0);return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:i}}))})(e);return w.createElement(zt,{store:t})};Xt.displayName="QrCodeButton";const Jt=({store:e,buttonVariant:t,onRequestClose:a,shouldDisableQRCodeAnimation:n})=>{const i=d.usePlatform()===d.Platforms.METASERVER,o=w.useCallback((()=>{g.batch((()=>{n?e.$currentScreen.set(Lt.QRCODE):(e.$isExitingMainToQr.set(!0),e.$isEnteringQr.set(!0))}))}),[e.$isExitingMainToQr,e.$isEnteringQr,e.$currentScreen,n]),r=w.useCallback((()=>{i?(e.$isInterstitialVisible.set(!0),f.showOQModalOrContinue({action:"share_qr_code",continueCallback:()=>{o(),e.$isInterstitialVisible.set(!1)},abortCallback:()=>{a(),e.$isInterstitialVisible.set(!1)}})):o()}),[i,o,a,e.$isInterstitialVisible]);return w.createElement(Xt,{onClickQrCodeButton:r,buttonVariant:t})};Jt.displayName="QrCodeButton";const Zt=e=>e.formatMessage({id:"8sEPDx",defaultMessage:"Settings"}),ea=Symbol("ON_CLICK"),ta=Symbol("ON_MOUSE_ENTER"),aa=Symbol("ON_MOUSE_LEAVE"),{useEmitter:na,defaultEmitter:ia}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};if(e.key===ea)return a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"settings"}}),void a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"settings"}});e.key!==ta?e.key!==aa||a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"settings"}}):a.UDCL.logEvent(y.PAP_Hover_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"settings"}),{tags:{...s,action:"settings"}})})),oa=({store:e})=>{const[t,n]=w.useState(!1),i=w.useRef(null),o=na(),r=w.useCallback((()=>{const t=e.$data.get(),n=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,i=Date.now()-e.$componentViewTime.get();o.select(ea).emit({dwellTime:n,timeSinceView:i}),e.$isHovered.set(!1);let r=!1;"loaded"!==t.status||a.isNewApiMetadata(t.objectMetadata)?"loaded"===t.status&&a.isNewApiMetadata(t.objectMetadata)&&(r=!a.getCanInvite(t.objectMetadata,_.VIEWER)&&!a.getCanInvite(t.objectMetadata,_.EDITOR)):r=a.getIsLinkOnlyMode(t.objectMetadata),e.$props.get().onClickSettingsButton({shouldOpenLinkSettings:r})}),[e,o]),s=w.useCallback((()=>{o.select(ta).emit(null),n(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,o]),c=w.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;o.select(aa).emit({dwellTime:t}),n(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,o]);return w.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]),w.createElement(w.Fragment,null,w.createElement(S.UtilityIconButton,{"data-testid":"settings-button",onClick:r,onMouseEnter:s,onMouseLeave:c,ref:i,variant:e.$props.get().buttonVariant,"data-uxa-log":"sm24-settings-button.loaded","data-uxa-interactions":"shown click","data-campaign-element-id":"share-modal-settings-button"},w.createElement(a.UIIcon,{src:v.SettingsLine,"aria-label":Zt(l.intl)})),w.createElement(a.Tooltip.Control,{open:t,placement:"top",auto:!0,triggerRef:i,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},w.createElement(a.Text,null,Zt(l.intl))))};oa.displayName="LoadedButton";const ra=({store:e})=>w.createElement(oa,{store:e});ra.displayName="Inner";const sa=e=>{const t=(e=>{const t=_e(),a=g.useInitStore(t,(e=>e));return g.useInitStore(e,(e=>{const t=g.store(!1),n=g.store(0),i=g.store(0);return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:i}}))})(e);return w.createElement(ra,{store:t})};sa.displayName="SettingsButton";const la=({store:e,buttonVariant:t})=>{const{objectIdentifier:a}=g.useStore(e.$props),n=w.useCallback((t=>{e.$currentScreen.set(Lt.SETTINGS)}),[e]);return w.createElement(sa,{onClickSettingsButton:n,objectIdentifier:a,buttonVariant:t})};la.displayName="SettingsButton";const ca=e=>e.formatMessage({id:"FuFURj",defaultMessage:"Transfer a copy"}),da=Symbol("ON_CLICK"),ua=Symbol("ON_CLICK_ENABLE_TRANSFER"),ga=Symbol("ON_MOUSE_ENTER"),ma=Symbol("ON_MOUSE_LEAVE"),{useEmitter:_a,defaultEmitter:pa}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};if(e.key===da)return a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"transfer"}}),void a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"transfer"}});e.key!==ga?e.key!==ma?e.key!==ua||a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"enable_transfer_tooltip"}),{tags:{...s,action:"transfer"}}):a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"transfer"}}):a.UDCL.logEvent(y.PAP_Hover_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"transfer"}),{tags:{...s,action:"transfer"}})})),Ea=({store:e})=>{const t=_a(),n=w.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,n=Date.now()-e.$componentViewTime.get();t.select(da).emit({dwellTime:a,timeSinceView:n}),e.$isHovered.set(!1),e.$props.get().onClickTransferButton()}),[e,t]),i=w.useCallback((()=>{t.select(ga).emit(null),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,t]),o=w.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;t.select(ma).emit({dwellTime:a}),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,t]);return w.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]),w.createElement(w.Fragment,null,w.createElement(S.ButtonWrapper,{onMouseEnter:i,onMouseLeave:o,"data-uxa-log":"sm24-transfer-button.loaded","data-uxa-interactions":"shown click"},w.createElement(S.VerticalButton,{"data-testid":"transfer-button",onClick:n},w.createElement(S.ButtonIconContainer,null,w.createElement(a.UIIcon,{src:b.DropboxTransferLine,size:"medium"})),w.createElement(S.Spacer,null),w.createElement(S.ButtonInnerColumn,null,w.createElement(S.ButtonTitle,{content:ca(l.intl)})))))};Ea.displayName="ChonkyBoiiLoadedButton";const fa=({store:e})=>{const t=_a(),n=d.useOpenUrl(),[i,o]=w.useState(!1),r=w.useRef(null),{canUserUseTransfer:s,canContentUseTransfer:c,canUserEnableTransfer:u}=g.useStore(e.$props),m=w.useCallback((()=>{t.select(ua).emit(null),n("/team/admin/settings/sharing")}),[t,n]),_=w.useCallback((()=>{t.select(ga).emit(null),o(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,t]),p=w.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;t.select(ma).emit({dwellTime:a}),o(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,t]);let E="";var f,y;return s?c||(E=(e=>e.formatMessage({id:"LvDT7L",defaultMessage:"This is not a file type that can be copied."}))(l.intl)):u?(f=l.intl,y=()=>{m()},E=f.formatMessage({id:"eGWSHS",defaultMessage:"Your team has transfer turned off. <button>Turn on</button>"},{button:e=>w.createElement(a.Button,{variant:"transparent",onClick:y},e)})):E=(e=>e.formatMessage({id:"l+F4Tm",defaultMessage:"Ask an admin to allow Transfer a copy."}))(l.intl),w.createElement(w.Fragment,null,w.createElement(S.ButtonWrapper,{"data-uxa-log":"sm24-transfer-button.disabled","data-uxa-interactions":"shown click",ref:r,onMouseEnter:_,onMouseLeave:p},w.createElement(S.VerticalButton,{disabled:!0},w.createElement(S.ButtonIconContainer,null,w.createElement(a.UIIcon,{src:b.DropboxTransferLine,size:"medium"})),w.createElement(S.Spacer,null),w.createElement(S.ButtonInnerColumn,null,w.createElement(S.ButtonTitle,{content:ca(l.intl)})))),w.createElement(a.Tooltip.Control,{open:i,placement:"top",auto:!0,triggerRef:r,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1)},w.createElement(a.Text,null,E)))};fa.displayName="ChonkyBoiiDisabledButton";const Sa=()=>w.createElement(S.ButtonWrapper,{"data-uxa-log":"sm24-transfer-button.loading","data-uxa-interactions":"shown click"},w.createElement(S.VerticalButton,{disabled:!0},w.createElement(S.ButtonIconContainer,null,w.createElement(a.UIIcon,{src:b.DropboxTransferLine,size:"medium"})),w.createElement(S.Spacer,null),w.createElement(S.ButtonInnerColumn,null,w.createElement(a.Skeleton.Text,{size:"small",style:{marginTop:22}}))));Sa.displayName="LoadingButton";const ya=({store:e})=>{const{canUserUseTransfer:t,canContentUseTransfer:a,isTransferEligibilityLoading:n}=g.useStore(e.$props);return n?w.createElement(Sa,null):t&&a?w.createElement(Ea,{store:e}):w.createElement(fa,{store:e})};ya.displayName="Inner";const Ca=e=>{const t=(e=>{const t=_e(),a=g.useInitStore(t,(e=>e));return g.useInitStore(e,(e=>{const t=g.store(!1),n=g.store(0),i=g.store(0);return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:i}}))})(e);return w.createElement(ya,{store:t})};Ca.displayName="TransferButton";const va=({store:e})=>{const{objectIdentifier:t}=g.useStore(e.$props),a=w.useCallback((()=>{e.$props.get().transferHandler(),e.$props.get().onActionClicked()}),[e]),n=g.useStore(e.$canContentUseTransfer),i=g.useStore(e.$canUserUseTransfer),o=g.useStore(e.$canUserEnableTransfer),r=g.useStore(e.$isTransferEligibilityLoading);return w.createElement(Ca,{canContentUseTransfer:n,canUserUseTransfer:i,canUserEnableTransfer:o,isTransferEligibilityLoading:r,onClickTransferButton:a,objectIdentifier:t})};va.displayName="TransferButton";const ba=(e,t)=>{switch(t[".tag"]){case"editor":return{title:e.formatMessage({id:"nop2ci",defaultMessage:"Edit link"}),subtitle:e.formatMessage({id:"Yzhe/8",defaultMessage:"People with this link can edit, comment, delete and add files"}),buttonTitle:e.formatMessage({id:"XcciHL",defaultMessage:"Edit link"})};case"viewer":return{title:e.formatMessage({id:"B6qDgp",defaultMessage:"View link"}),subtitle:e.formatMessage({id:"CWTjfa",defaultMessage:"People with this link can view, comment, and download"}),buttonTitle:e.formatMessage({id:"Ok2dm/",defaultMessage:"View link"})};default:return{title:"",subtitle:"",buttonTitle:""}}},ha=()=>w.createElement("div",{"data-testid":"loading-screen",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"var(--dig-spacing__micro__small)",height:"122px"},"data-uxa-log":"sm24-copy_link_screen.loading","data-uxa-interactions":"shown"},w.createElement(a.Spinner,{size:"medium",withTrack:!0,hasOpaqueTrack:!0}),w.createElement(a.Text,{size:"small",color:"subtle"},l.intl.formatMessage({id:"XtsMXq",defaultMessage:"Getting the link"})));ha.displayName="LoadingScreen";const ka=Symbol("COPY_LINK_SCREEN_LINK_CREATED"),La=Symbol("COPY_LINK_HANDLE_AUDIENCE_CHANGE"),Aa=Symbol("COPY_LINK_ACCESS_LEVEL_TOGGLED"),Ta=Symbol("COPY_LINK_HANDLE_ACCESS_LEVEL_CHANGE"),Ia=Symbol("COPY_LINK_SCREEN_LOADING"),wa=Symbol("COPY_LINK_SCREEN_LOADED"),$a=Symbol("COPY_LINK_SETTINGS_BUTTON_CLICKED"),Na=Symbol("COPY_LINK_AUDIENCE_TOGGLED"),Ma=Symbol("COPY_LINK_SCREEN_ERROR"),xa=Symbol("COPY_LINK_SCREEN_LINK_COPIED"),Ra=Symbol("COPY_LINK_CTA_CLICKED"),Oa=Symbol("COPY_LINK_UPDATING"),Da=Symbol("COPY_LINK_MANAGE_ACCESS_LEVEL_CLICKED"),Pa=Symbol("ON_CREATE_SHARED_LINK_START"),Ua=Symbol("ON_CREATE_SHARED_LINK_SUCCESS"),Ba=Symbol("ON_CREATE_SHARED_LINK_ERROR"),Va=Symbol("ON_CREATE_SHARED_LINK_CANCELED"),ja=Symbol("ON_RECOPY_LINK_START"),Fa=Symbol("ON_COPY_SHARED_LINK_SUCCESS"),qa=Symbol("ON_COPY_SHARED_LINK_ERROR"),Ha=Symbol("ON_COPY_SHARED_LINK_CANCELED"),Ka=Symbol("COPY_LINK_SCREEN_ERROR_HELP_CLICKED"),{useEmitter:Ga,defaultEmitter:Wa}=a.defineLogger((async({event:e,getContextValue:t})=>{var n,i;const o=t(a.Context$4),r=t(a.Context$5),s=t(a.Context$6),l=t(a.Context$7),c={...a.getTags$4(o),...a.getTags$5(r),...a.getTags$6(s),...a.getTags$7(l)},d={isDir:c.isDir,isSm24:c.isSm24,screen:c.screen,actionSurfaceAndElement:`${c.actionSurface}___${c.actionElement}`},u={...a.getProperties$4(o),...a.getProperties$5(r),...a.getProperties$6(s),...a.getProperties$7(l)},g={isDir:u.isDir,actionSurface:null!==(n=u.actionSurface)&&void 0!==n?n:"undefined",actionElement:null!==(i=u.actionElement)&&void 0!==i?i:"undefined",contentAction:u.contentAction,shareModalType:u.shareModalType,contentIdentifier:u.contentIdentifier,screen:u.screen};if(u.isDir?(g.nsId=Number(u.contentIdentifier),u.sharedObjType&&(g.folderType=a.getFolderTypeFromSharedObjType(u.isDir,u.sharedObjType))):g.fileExtension=u.fileExtension,e.key!==La)if(e.key!==Aa)if(e.key!==Ta)if(e.key!==ka)if(e.key!==Ia)if(e.key!==wa)if(e.key!==$a)if(e.key!==Na)if(e.key!==Ma)if(e.key!==xa)if(e.key!==Ra)if(e.key!==Oa)if(e.key!==Da){if(e.key===Pa){const t={...g,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel};return a.UDCL.logStart(a.PAP_Create_SharedLink({...t}),{tags:{...d}}),void(e.payload.alsoLogCopyLinkEvent&&a.UDCL.logStart(a.PAP_Copy_SharedLink({...t}),{tags:{...d}}))}if(e.key===Ua){const t=await a.getLinkProps(e.payload.linkMetadata.url,e.payload.resolvedAccessLevel,g.sharedLinkIdentifier),n={...g,...t,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel,sharedLinkResolvedAccessLevel:e.payload.resolvedAccessLevel,createdNewLink:e.payload.isNewlyCreated};return e.payload.httpStatusCode&&(n.httpStatusCode=e.payload.httpStatusCode),void a.UDCL.logEnd(a.PAP_Create_SharedLink({eventState:"success",...n}),{tags:{...d,createdNewLink:e.payload.isNewlyCreated.toString()},eventState:"success"})}if(e.key===Ba){const t={...g,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel,createSharedLinkErrorReason:a.getCreateSharedLinkErrorReasonFromString(e.payload.error)};return e.payload.httpStatusCode&&(t.httpStatusCode=e.payload.httpStatusCode),a.UDCL.logEnd(a.PAP_Create_SharedLink({...t,eventState:"failed"}),{tags:{...d},eventState:"failed"}),void(e.payload.alsoLogCopyLinkEvent&&a.UDCL.logEnd(a.PAP_Copy_SharedLink({...g,eventState:"failed"}),{tags:{...d},eventState:"failed"}))}if(e.key===Va)return a.UDCL.logEnd(a.PAP_Create_SharedLink({...g,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel,eventState:"canceled"}),{tags:{...d,cancelType:e.payload.cancelType},eventState:"canceled"}),void(e.payload.alsoLogCopyLinkEvent&&a.UDCL.logEnd(a.PAP_Copy_SharedLink({...g,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel,eventState:"canceled"}),{tags:{...d,cancelType:e.payload.cancelType},eventState:"canceled"}));if(e.key!==ja)if(e.key!==Fa)if(e.key!==qa)if(e.key!==Ha)e.key!==Ka||a.UDCL.logEvent("ops.sm24.copyLinkScreenErrorHelpClicked",{tags:d});else{let t={...g,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel,eventState:"canceled"};if(e.payload.linkMetadata){const n=await a.getLinkProps(e.payload.linkMetadata.url,e.payload.linkMetadata.link_permissions.link_access_level[".tag"],g.sharedLinkIdentifier);t={...t,...n}}a.UDCL.logEnd(a.PAP_Copy_SharedLink(t),{tags:{...d,cancelType:e.payload.cancelType},eventState:"canceled"})}else{let t={...g,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel,createSharedLinkErrorReason:a.getCreateSharedLinkErrorReasonFromString(e.payload.error),eventState:"failed"};if(e.payload.linkMetadata){const n=await a.getLinkProps(e.payload.linkMetadata.url,e.payload.linkMetadata.link_permissions.link_access_level[".tag"],g.sharedLinkIdentifier);t={...t,...n}}a.UDCL.logEnd(a.PAP_Copy_SharedLink(t),{tags:{...d},eventState:"failed"})}else{const t=await a.getLinkProps(e.payload.linkMetadata.url,e.payload.resolvedAccessLevel,g.sharedLinkIdentifier);a.UDCL.logEnd(a.PAP_Copy_SharedLink({...g,...t,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel,sharedLinkResolvedAccessLevel:e.payload.resolvedAccessLevel,createdNewLink:e.payload.isNewlyCreated,eventState:"success"}),{tags:{...d,createdNewLink:e.payload.isNewlyCreated.toString()},eventState:"success"})}else{const t=await a.getLinkProps(e.payload.linkMetadata.url,e.payload.resolvedAccessLevel,g.sharedLinkIdentifier);a.UDCL.logStart(a.PAP_Copy_SharedLink({...t,...g,sharedLinkRequestedAccessLevel:e.payload.requestedAccessLevel}),{tags:{...d}})}}else a.UDCL.logEvent("ops.sm24.copyLinkManageAccessLevelClicked",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkUpdating",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkCtaClicked",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkScreenLinkCopied",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkScreenError",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkAudienceToggled",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkSettingsButtonClicked",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkScreenLoaded",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkScreenLoading",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkScreenlinkCreated",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkHandleAccessLevelChange",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkAccessLevelToggled",{tags:d});else a.UDCL.logEvent("ops.sm24.copyLinkHandleAudienceChange",{tags:d})})),Qa=(e,n)=>{var i,o,r;const s=Ga(),l=d.useLogger(),u=(e=>c.useMutation({mutationFn:e=>a.createSharedLinkWithSettingsMutationFn()({queryClient:c.queryClient,reqCtx:{}})({apiArg:e}),onSettled:async()=>await m.invalidateListSharedLinks(e)}))(e);if(t.useEffect((()=>{u.isIdle&&(s.select(Pa).emit({requestedAccessLevel:n[".tag"],alsoLogCopyLinkEvent:!0}),u.mutate({path:a.getContentIdOrPathFromObjectIdentifier(e),settings:{access:n}}))}),[u,n,e,s]),u.isSuccess){const e=u.data.apiData;return Xa(e)?(s.select(Ua).emit({requestedAccessLevel:n[".tag"],resolvedAccessLevel:e.link_permissions.link_access_level[".tag"],isNewlyCreated:!0,linkMetadata:e,httpStatusCode:200}),s.select(ka).emit(null),{isLoading:!1,isError:!1,output:e,isNewlyCreated:!0}):(s.select(Ba).emit({requestedAccessLevel:n[".tag"],error:"type_error",alsoLogCopyLinkEvent:!0}),l("SHARE_MODAL_SHARE__COPY_LINK_LEGO__CREATE_ERROR",{linkMetadata:e}),{isLoading:!1,isError:!0,error:{".tag":"type_error"}})}if(u.isError){const e=null===(i=u.error.raw)||void 0===i?void 0:i.status,t=null===(o=u.error)||void 0===o?void 0:o.error,a=(e=>{if(e&&"shared_link_already_exists"===e[".tag"]){const t=e.shared_link_already_exists;if(t&&".tag"in t&&"metadata"===t[".tag"]&&"metadata"in t)return t.metadata}})(t);return Xa(a)?(s.select(Ua).emit({requestedAccessLevel:n[".tag"],resolvedAccessLevel:a.link_permissions.link_access_level[".tag"],isNewlyCreated:!1,linkMetadata:a,httpStatusCode:e}),s.select(ka).emit(null),{isLoading:!1,isError:!1,output:a,isNewlyCreated:!1}):(s.select(Ba).emit({requestedAccessLevel:n[".tag"],error:null!==(r=t&&t[".tag"])&&void 0!==r?r:"unknown_error_type",alsoLogCopyLinkEvent:!0,httpStatusCode:e}),l("SHARE_MODAL_SHARE__COPY_LINK_LEGO__CREATE_ERROR",{linkMetadata:null}),{isLoading:!1,isError:!0,error:t})}return u.isLoading||u.isIdle?{isLoading:!0}:(s.select(Ba).emit({requestedAccessLevel:n[".tag"],error:"unknown_mutation_error",alsoLogCopyLinkEvent:!0}),{isLoading:!1,isError:!0,error:{".tag":"unknown_mutation_error"}})},Ya=e=>function(e){switch(e){case"viewer":return U;case"editor":return B;default:throw new Error(`Invalid tag: ${e}`)}}(e.link_permissions.link_access_level[".tag"]),za=e=>function(e){switch(e){case"no_one":return R;case"password":return O;case"team":return D;case"public":return P;default:throw new Error(`Invalid tag: ${e}`)}}(e.link_permissions.effective_audience[".tag"]),Xa=e=>{if(!e)return!1;const t=e.link_permissions.link_access_level,a=e.link_permissions.effective_audience,n=e.url;return!(null==t||null==a||null==n||"editor"!==t[".tag"]&&"viewer"!==t[".tag"]||"no_one"!==a[".tag"]&&"password"!==a[".tag"]&&"team"!==a[".tag"]&&"public"!==a[".tag"])};var Ja;!function(e){e.IDLE="IDLE",e.CREATING_LINK="CREATING_LINK",e.CREATED_LINK="CREATED_LINK",e.ERROR_CREATING_LINK="ERROR_CREATING_LINK",e.COPIED_LINK="COPIED_LINK",e.ERROR_COPYING_LINK="ERROR_COPYING_LINK",e.CAN_COPY_LINK="CAN_COPY_LINK"}(Ja||(Ja={}));const Za={$props:g.atom({oid:{".tag":"file",fileId:""},objectMetadataResult:{isLoading:!0},defaultLinkResult:{isLoading:!0},settingsHandler:()=>{},onRequestClose:()=>{},onBlockClickaway:()=>{},onUnblockClickaway:()=>{},shouldUseSm26Design:!1}),$currentLinkMetadata:g.atom(null),$linkStatus:g.atom(Ja.IDLE),$linkError:g.atom(null),$isLinkNewlyCreated:g.atom(!1),$currentLinkAudience:g.atom(R),$currentLinkAccessLevel:g.atom(U),$requestedAccessLevel:g.atom(V),$senderTrackkey:g.atom("")},{StoreProvider:en,useStore:tn}=g.defineStoreProvider((e=>{const t=g.atom(Ja.CREATING_LINK),n=g.atom(null),i=g.atom(R),o=g.atom(U),r=g.atom(V),s=g.atom(!1),l=g.atom(null),c=g.atom(a.vendSenderTrackey()),d=g.proxy((()=>e.get().defaultLinkResult));return d.obs((()=>{const e=d.get();if(e.isLoading||e.isError||!e.output)!e.isLoading&&e.isError&&(l.set(e.error),t.set(Ja.ERROR_CREATING_LINK));else{const r=e.output;o.set(Ya(r)),i.set(za(r));const l=a.appendTrackeyToSharedLinkAndSortParams(r.url,c.get());n.set({...r,url:l}),s.set(e.isNewlyCreated),t.set(Ja.CREATED_LINK)}})),{$props:e,$currentLinkMetadata:n,$linkStatus:t,$linkError:l,$isLinkNewlyCreated:s,$currentLinkAccessLevel:o,$currentLinkAudience:i,$requestedAccessLevel:r,$senderTrackkey:c}}),Za),an=e=>{const t=E.useSharingObjectMetadata(e.oid.fileId),n=Qa(e.oid,V),i=a.useGetContextValue()(a.Context$4),o=w.useMemo((()=>i?{...i,contentAction:"copy_link"}:null),[i]);return w.createElement(a.ContextProvider,{context:a.Context$4,value:o},w.createElement(en,{objectMetadataResult:t,defaultLinkResult:n,...e}))};an.displayName="Provider";const nn=()=>{const e=tn(),t=g.useStore(e.$props),n=w.useCallback((()=>{t.onRequestClose()}),[t]);return w.createElement("div",{className:u.classes.headerSectionButtonContainer,"data-testid":"close-button"},w.createElement(a.IconButton,{variant:"borderless",shape:"standard",size:"medium",tone:"neutral",onClick:n,"aria-label":l.intl.formatMessage({id:"GKzMoF",defaultMessage:"Close"})},w.createElement(a.UIIcon,{src:a.CloseLine})))};nn.displayName="CloseButton";const on=()=>{const e=tn(),t=g.useStore(e.$props),{objectMetadataResult:n}=t,i=!(!n.isLoading&&n.isError),o=g.useAtom(e.$linkStatus),r=n.isLoading||n.isError?"":a.getName(n.output),s=w.useMemo((()=>o===Ja.COPIED_LINK?l.intl.formatMessage({id:"K4WVkI",defaultMessage:"Link copied to"}):(e=>e.formatMessage({id:"DRh5LI",defaultMessage:"Copy link to"}))(l.intl)),[o]);return w.createElement("div",{style:{display:"flex",alignItems:"flex-start"}},i&&w.createElement("div",{className:u.classes.headerSectionTextContainer,"data-testid":"header-section",id:"copy-link-header"},w.createElement(a.Text,{size:"medium",isBold:!0,className:u.classes.headerSectionPrimaryText},w.createElement(a.Truncate,{location:.5},s)),w.createElement(a.Text,{size:"small",color:"subtle"},w.createElement(a.Truncate,{location:.5},r))),w.createElement(nn,null))};on.displayName="HeaderSection";a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/copy-link-screen/internals/link-section.module.out-vflJgUUnr.css",(e=>"._badgeAsText_gpgfl_1{text-wrap:nowrap;align-items:center;border-radius:var(--dig-radius__small);display:flex;font-family:var(--dig-type__family__action);font-size:var(--dig-type__size__action__small);font-weight:500;letter-spacing:var(--dig-type__letterspacing__action);margin-right:calc(var(--dig-spacing__micro__xsmall)*-1);padding-left:var(--dig-spacing__micro__small);padding-right:var(--dig-spacing__micro__small);white-space:nowrap;width:fit-content}._badgeAsTextSuccess_gpgfl_20{background-color:var(--dig-color__success__surface--state-1);color:var(--dig-color__success__base)}._badgeAsTextUpdate_gpgfl_26{background-color:var(--dig-color__selection__surface--state-1);color:var(--dig-color__selection__base)}._badgeIcon_gpgfl_32{padding-right:var(--dig-spacing__micro__xsmall)}._badgeAsButton_gpgfl_36{margin-right:calc(var(--dig-spacing__micro__xsmall)*-1)}._updatingContainer_gpgfl_40{position:relative}._updatingOverlay_gpgfl_45{opacity:0;pointer-events:none;position:absolute;right:12px;top:50%;transform:translateY(-50%);transition:opacity .2s ease;z-index:1}._updatingContainer_gpgfl_40:has(input:disabled){pointer-events:none}._updatingContainer_gpgfl_40:has(input:disabled) ._updatingOverlay_gpgfl_45{opacity:1}"));const rn="_badgeAsTextSuccess_gpgfl_20 _badgeAsText_gpgfl_1",sn="_badgeAsButton_gpgfl_36",ln=()=>{const e=tn(),t=g.useAtom(e.$currentLinkMetadata),n=d.useLogger(),i=Ga(),o=g.useAtom(e.$currentLinkAccessLevel),r=g.useAtom(e.$isLinkNewlyCreated),s=(()=>{var e;const{user:t}=a.useActiveUser(),n=a.useGetContextValue(),i=null===(e=n(a.Context$4))||void 0===e?void 0:e.tiburonOrigin,o=n(a.Context$6),r=w.useRef(!1);return w.useCallback((async()=>{if(t&&a.markMilestoneAsCompleted(t,d.ActivationTileMilestoneId.SHARE_CONTENT),o&&!r.current){r.current=!0;const e=a.isNewApiMetadata(o)?o.common_metadata.path_display:o.path_display,t=a.getIsFolder(o),n={file_name:a.getName(o),file_extension:a.getExtension$1(o),file_path:e};t?a.publishEvent(a.CampaignEvents.FOLDER_OUT_OF_BAND_SHARE_SUCCESS,{context:{...n,is_team_folder:a.getIsInsideTeamFolderTree(o)?"true":"false"}}):a.publishEvent(a.CampaignEvents.FILE_OUT_OF_BAND_SHARE_SUCCESS,{context:n})}a.trackUserLeapEvent(a.SharingUserLeapEvent.SM24_OOB_SHARE_COMPLETE_CLMM_CLOSED,i)}),[t,i,o])})(),l=w.useCallback((()=>{e.$linkStatus.set(Ja.COPIED_LINK),t&&(n("SHARE_MODAL_SHARE__COPY_LINK_LEGO__COPY_SUCCESS",{linkMetadata:t}),i.select(Fa).emit({requestedAccessLevel:e.$requestedAccessLevel.get()[".tag"],resolvedAccessLevel:o[".tag"],isNewlyCreated:r,linkMetadata:t}),i.select(xa).emit(null))}),[e,t,n,i,o,r]),c=w.useCallback((()=>{e.$linkStatus.set(Ja.ERROR_COPYING_LINK),t&&(n("SHARE_MODAL_SHARE__COPY_LINK_LEGO__COPY_ERROR",{linkMetadata:t}),i.select(qa).emit({requestedAccessLevel:e.$requestedAccessLevel.get()[".tag"],error:"failed_copy_to_clipboard",linkMetadata:t}))}),[e,t,n,i]),u=w.useCallback((e=>{(null==t?void 0:t.url)&&e&&(e.write(t.url),l())}),[null==t?void 0:t.url,l]);return{copyLinkToClipboard:w.useCallback((e=>{(null==t?void 0:t.url)&&(e?u(e):navigator.clipboard&&navigator.clipboard.writeText(t.url).then(l,c),s())}),[null==t?void 0:t.url,s,l,c,u])}},cn=()=>{const e=tn(),t=g.useAtom(e.$props),{copyLinkToClipboard:n}=ln(),i=Ga(),o=g.useAtom(e.$linkStatus),r=g.useAtom(e.$currentLinkMetadata),s=g.useAtom(e.$currentLinkAccessLevel),c=w.useRef(null),d=w.useRef(!1);w.useEffect((()=>{[Ja.COPIED_LINK].includes(o)&&c.current&&(d.current=!0,c.current.focus(),setTimeout((()=>{d.current=!1}),0))}),[o,c]);const[u,m]=w.useState(!1),_=w.useCallback((()=>{e.$requestedAccessLevel.set(s),i.select(Ra).emit(null),i.select(ja).emit({requestedAccessLevel:s[".tag"],linkMetadata:r,resolvedAccessLevel:s[".tag"]});let t=()=>{};const a=new Promise((e=>{t=e}));if("undefined"!=typeof ClipboardItem&&navigator.clipboard.write){const e=new ClipboardItem({"text/plain":a});navigator.clipboard.write([e])}else a.then((e=>navigator.clipboard.writeText(e)));n({write:e=>t(e)})}),[n,i,s]),p=w.useMemo((()=>null==r?void 0:r.url),[r]),E=w.useRef(null);w.useEffect((()=>{o===Ja.CREATED_LINK&&p&&p!==E.current&&(E.current=p,n(t.clipboardWriter))}),[o,p,n,t.clipboardWriter]);const f=w.useCallback((()=>{u||(o===Ja.COPIED_LINK&&e.$linkStatus.set(Ja.CAN_COPY_LINK),m(!0))}),[o,e.$linkStatus,u]),S=w.useCallback((e=>{o!==Ja.CAN_COPY_LINK&&o!==Ja.COPIED_LINK||e.target.select(),d.current||f()}),[o,f]),y=w.useCallback((e=>{e.currentTarget.contains(e.relatedTarget)||e.currentTarget===e.relatedTarget||o!==Ja.COPIED_LINK||m(!1)}),[o]);return w.createElement("div",{onMouseEnter:f,onMouseLeave:()=>{m(!1)},onBlur:y,"aria-label":ba(l.intl,s).title},w.createElement("div",{"data-testid":"link-section"},w.createElement(a.TextInput,{ref:c,onCopy:_,size:"large",readOnly:!0,onFocus:S,wrapperProps:{style:{fontSize:"var(--dig-type__size__text__small)"}},value:p,withRightAccessory:(e=>{const t=(()=>{switch(o){case Ja.COPIED_LINK:return w.createElement(a.Text,{className:rn},s===B?l.intl.formatMessage({id:"qaLT/q",defaultMessage:"Edit link copied"}):(e=>e.formatMessage({id:"Ged5jl",defaultMessage:"View link copied"}))(l.intl));case Ja.CAN_COPY_LINK:return e?w.createElement(a.Button,{variant:"primary",size:"small",onClick:_,className:sn},(e=>e.formatMessage({id:"1xxmJZ",defaultMessage:"Copy link"}))(l.intl)):null;default:return null}})();return w.createElement("div",{style:{minHeight:"32px",display:"flex",alignItems:"center"},"aria-live":o===Ja.CAN_COPY_LINK?"off":"assertive"},t)})(u),"aria-label":ba(l.intl,s).title})))};cn.displayName="LinkSection";const dn=()=>{var e;const t=l.useIntl(),n=tn(),i=((e,t,n)=>{switch(t[".tag"]){case a.NO_ONE[".tag"]:return e.formatMessage({id:"Ca/e0Y",defaultMessage:"Only people invited can {canEdit, select, true {edit} other {view}}"},{canEdit:n===B});case a.PUBLIC[".tag"]:return e.formatMessage({id:"/wh8mz",defaultMessage:"Anyone with this link can {canEdit, select, true {edit} other {view}}"},{canEdit:n===B});case a.TEAM[".tag"]:return e.formatMessage({id:"60+xKH",defaultMessage:"Team members with this link can {canEdit, select, true {edit} other {view}}"},{canEdit:n===B});default:return""}})(t,g.useAtom(n.$currentLinkAudience),g.useAtom(n.$currentLinkAccessLevel)),o=null!==(e=g.useAtom(n.$props).shouldUseSm26Design)&&void 0!==e&&e;return w.createElement("div",{"data-testid":"link-permissions-text"},w.createElement(a.Text,{size:o?"medium":"small",style:{color:"var(--dig-color__text__base)"}},i))};dn.displayName="LinkPermissionsText";const un=()=>{var e;const t=tn(),n=l.useIntl(),i=g.useAtom(t.$currentLinkAccessLevel),o=null!==(e=g.useAtom(t.$props).shouldUseSm26Design)&&void 0!==e&&e,r=Ga();return w.createElement(a.Button,{"data-testid":"settings-button",variant:"transparent",size:o?"medium":"small",tone:"neutral",onClick:()=>{let e;e="editor"===i[".tag"]?"edit_link_settings":"view_link_settings",r.select($a).emit(null);t.$props.get().settingsHandler({shouldOpenLinkSettings:!0,initialTab:e})},"data-uxa-log":"copy-link-screen-settings-button.loaded","data-uxa-interactions":"shown click"},(e=>e.formatMessage({id:"6BOuuN",defaultMessage:"Manage"}))(n))};un.displayName="SettingsButton";const gn=()=>{var e;const t=tn(),a=g.useAtom(t.$props),{objectMetadataResult:n}=a,i=n.isLoading||n.isError?void 0:n.output,o=null===(e=null==i?void 0:i.common_metadata)||void 0===e?void 0:e.path_display;return w.createElement(s.CampaignContextualNudgeSection,{fqPath:o,onClose:a.onRequestClose})};gn.displayName="CampaignContextualNudgeSection";const mn=()=>{const e=Ga();return w.createElement("div",{style:{display:"flex",padding:"var(--dig-spacing__micro__medium)",flexDirection:"column",alignItems:"center",gap:"var(--dig-spacing__micro__small)"},"data-testid":"error-screen","data-uxa-log":"sm24-copy_link_screen.error","data-uxa-interactions":"shown"},w.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--dig-spacing__micro__xsmall)"}},w.createElement(a.UIIcon,{src:a.FailLine,size:"large"})),w.createElement(a.Text,{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"var(--dig-spacing__micro__xsmall)",alignSelf:"stretch",fontStyle:"normal",fontWeight:"var(--dig-type__weight__strong)",lineHeight:"var(--dig-line-height__label__small)",letterSpacing:"var(--dig-letter-spacing__action__medium)"}},l.intl.formatMessage({id:"qmGnVg",defaultMessage:"Couldn’t copy link"})),w.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}},w.createElement(a.Text,{style:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:"var(--dig-color__text__subtle)",textOverflow:"ellipsis",fontFamily:"var(--dig-font-family__text)",fontSize:"var(--dig-font-size__text__small)",fontStyle:"normal",fontWeight:"var(--dig-type__weight__base)",lineHeight:"var(--dig-line-height__label__small)",gap:"var(--dig-spacing__micro__xsmall)"}},(e=>e.formatMessage({id:"hkT9RW",defaultMessage:"Try reloading the page or asking us for"}))(l.intl),w.createElement(a.Link,{href:"https://help.dropbox.com",target:"_blank",rel:"noopener noreferrer",onClick:()=>{e.select(Ka).emit(null)},style:{display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"var(--dig-font-family__text)",fontSize:"var(--dig-font-size__text__small)",fontStyle:"normal",fontWeight:"var(--dig-type__weight__base)",lineHeight:"var(--dig-line-height__label__small)",textDecorationLine:"underline",textDecorationStyle:"solid",color:"var(--dig-color__primary__base)"},display:"inline"},(e=>e.formatMessage({id:"yvCTUR",defaultMessage:"help"}))(l.intl)))))};mn.displayName="ErrorScreen";const _n=e=>w.createElement(an,{...e},w.createElement(pn,null));_n.displayName="CopyLinkScreen";const pn=()=>{var e;const t=tn(),n=g.useAtom(t.$props),{objectMetadataResult:i}=n,o=i.isLoading,r=!i.isLoading&&!i.isError,s=!i.isLoading&&i.isError,l=g.useAtom(t.$linkStatus),c=Ga(),d=s||l===Ja.ERROR_CREATING_LINK,u=o||l===Ja.CREATING_LINK,m=r&&l!==Ja.CREATING_LINK&&l!==Ja.ERROR_CREATING_LINK,_=w.useRef(l);w.useEffect((()=>{_.current=l}),[l]),w.useEffect((()=>()=>{_.current===Ja.CREATING_LINK&&(c.select(Va).emit({requestedAccessLevel:"default",cancelType:"unmount",alsoLogCopyLinkEvent:!0}),c.select(Ha).emit({requestedAccessLevel:"default",cancelType:"unmount"}))}),[]);const p=w.useRef(void 0);return w.useLayoutEffect((()=>{const e=p.current;u&&!e?n.onBlockClickaway():!u&&e&&n.onUnblockClickaway(),p.current=u}),[u,n]),w.useEffect((()=>{m&&c.select(wa).emit(null),d&&c.select(Ma).emit(null),u&&c.select(Ia).emit(null)}),[m,d,u,c]),u?w.createElement(ha,null):d?w.createElement(mn,null):m?w.createElement("div",{"data-testid":"copy-link-screen-with-store","data-uxa-log":"sm24-copy_link_screen.loaded","data-uxa-interactions":"shown",style:{display:"flex",flexDirection:"column",gap:n.shouldUseSm26Design?"var(--dig-spacing__micro__medium)":"var(--dig-spacing__micro__small)"},"aria-labelledby":"copy-link-header","aria-live":"polite"},!(null!==(e=n.shouldUseSm26Design)&&void 0!==e&&e)&&w.createElement(on,null),w.createElement(cn,null),w.createElement(a.Split,{gap:"Micro Medium",wrap:"nowrap",alignY:"center",display:"flex",width:"100%",style:{maxWidth:"100%"}},w.createElement(a.Split.Item,{width:"fill"},w.createElement(dn,null)),w.createElement(a.Split.Item,null,w.createElement(un,null))),w.createElement(gn,null)):null};pn.displayName="CopyLinkScreenWithStore";const En=({store:e})=>{const t=g.useStore(e.$props),a=g.useStore(e.$clipboardWriter),{objectIdentifier:n,onRequestClose:i}=t,o=w.useCallback((t=>{g.batch((()=>{t.shouldOpenLinkSettings?e.$initialSettingsTab.set("edit_link_settings"===t.initialTab?"edit_link_settings":"view_link_settings"):e.$initialSettingsTab.set("object_settings"),e.$currentScreen.set(Lt.SETTINGS)}))}),[e]),r=w.useCallback((()=>{e.$isClickawayLocked.set(!0)}),[e]),s=w.useCallback((()=>{e.$isClickawayLocked.set(!1)}),[e]);return w.createElement(_n,{oid:n,settingsHandler:o,onRequestClose:i,clipboardWriter:a,onBlockClickaway:r,onUnblockClickaway:s})};En.displayName="CopyLinkScreen";const fn=e=>e.formatMessage({id:"4mDOPx",defaultMessage:"Folder"}),Sn=(e,t)=>e.formatMessage({id:"Y8cvK0",defaultMessage:"Share {contentName}"},{contentName:E.Emstring.em_snippet(t,a.SNIPPET_SIZES.FILENAME)}),yn=e=>e.formatMessage({id:"EbXgYu",defaultMessage:"Create QR code"}),Cn=e=>e.formatMessage({id:"Qn7mSN",defaultMessage:"People with access to"}),vn=e=>e.formatMessage({id:"FQ6/b6",defaultMessage:"Link copied to"}),bn=(e,t)=>e.formatMessage({id:"a0hOt7",defaultMessage:"Settings for {contentName}"},{contentName:E.Emstring.em_snippet(t,a.SNIPPET_SIZES.FILENAME)}),hn=Symbol("ON_CLICK_OUTSIDE"),kn=Symbol("ON_RESIZE"),Ln=Symbol("ON_OPEN"),An=Symbol("ON_OVER_QUOTA_SHARE_BANNER_UPGRADE"),Tn=Symbol("ON_VIEW_MANAGE_ACCESS_ENTRY_POINT_BUTTON"),In=Symbol("ON_VIEW_ERROR_SCREEN"),{useEmitter:wn,defaultEmitter:$n}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};e.key!==Ln?e.key!==hn&&e.key!==kn?e.key!==Tn?e.key!==In?e.key===An&&a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:e.payload.action,flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView||void 0}),{tags:{...s,action:e.payload.action}}):a.UDCL.logEvent("ops.sm24.view_error_screen",{tags:{...s,error_type:e.payload.dataLoadErrorType||"unknown"}}):a.UDCL.logEvent(m.PAP_View_ManageAccess({...l,manageAccessElement:"manage_access_entry_point_button"}),{tags:{...s,element:"manage_access_entry_point_button"}}):a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:e.payload.action,flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView||void 0}),{tags:{...s,action:e.payload.action}}):a.UDCL.logEvent(function(e){return{class:"sharing_sender",action:"view",object:"flexible_sharing_entrypoint",properties:e}}({...l}),{tags:s})})),Nn=()=>{const e=wn(),t=_e(),n="error"===t.status?t.loadError.type:void 0;return w.useEffect((()=>{n&&e.select(In).emit({dataLoadErrorType:n})}),[n]),w.createElement(a.Box,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px",height:"310px"}},w.createElement(a.Box,{style:{color:"var(--dig-color__alert__base)"}},w.createElement(a.UIIcon,{src:a.FailPictogram,size:"large"})),w.createElement(a.Box,null,w.createElement(a.Title,{size:"medium"},l.intl.formatMessage({id:"4EN/b3",defaultMessage:"Unable to share"}))),w.createElement(a.Box,null,w.createElement(a.Text,{size:"medium"},(e=>e.formatMessage({id:"dCo6oL",defaultMessage:"An unexpected error has occured."}))(l.intl))))};Nn.displayName="ErrorScreen";const Mn=e=>e.formatMessage({id:"yBYjtJ",defaultMessage:"Close"}),xn=Symbol("ON_CLICK"),Rn=Symbol("ON_MOUSE_ENTER"),On=Symbol("ON_MOUSE_LEAVE"),{useEmitter:Dn,defaultEmitter:Pn}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$4),i=t(a.Context$5),o=t(a.Context$6),r=t(a.Context$7),s={...a.getTags$4(n),...a.getTags$5(i),...a.getTags$6(o),...a.getTags$7(r)},l={...a.getProperties$4(n),...a.getProperties$5(i),...a.getProperties$6(o),...a.getProperties$7(r)};if(e.key===xn)return a.UDCL.logEvent(_.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"close",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"close"}}),void a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"close",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"close"}});e.key!==Rn?e.key!==On||a.UDCL.logEvent(y.PAP_Log_FlexibleSharingEntrypointActionDwellTime({...l,flexibleSharingEntryPointAction:"close",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"close"}}):a.UDCL.logEvent(y.PAP_Hover_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"close"}),{tags:{...s,action:"close"}})})),Un=({store:e})=>{const[t,n]=w.useState(!1),i=w.useRef(null),o=Dn(),r=w.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,a=Date.now()-e.$componentViewTime.get();o.select(xn).emit({dwellTime:t,timeSinceView:a}),e.$isHovered.set(!1),e.$props.get().onClickCloseButton()}),[e,o]),s=w.useCallback((()=>{o.select(Rn).emit(null),n(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,o]),c=w.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;o.select(On).emit({dwellTime:t}),n(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,o]);w.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const d=g.useStore(e.$disabled);return w.createElement(w.Fragment,null,w.createElement(S.HeaderIconButton,{"data-testid":"close-button",onClick:r,onMouseEnter:s,onMouseLeave:c,ref:i,variant:e.$props.get().buttonVariant,disabled:d,"data-uxa-log":"sm24-close-button","data-uxa-interactions":"click"},w.createElement(a.UIIcon,{src:a.CloseLine,"aria-label":Mn(l.intl)})),w.createElement(a.Tooltip.Control,{open:!d&&t,placement:"top",auto:!0,triggerRef:i,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},w.createElement(a.Text,null,Mn(l.intl))))};Un.displayName="LoadedButton";const Bn=({store:e})=>w.createElement(Un,{store:e});Bn.displayName="Inner";const Vn=e=>{const t=(e=>{const t=_e(),a=g.useInitStore(t,(e=>e));return g.useInitStore(e,(e=>{const t=g.store(!1),n=g.store(0),i=g.store(0),o=g.proxy((()=>{var t;return null!==(t=e.get().disabled)&&void 0!==t&&t}));return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:i,$disabled:o}}))})(e);return w.createElement(Bn,{store:t})};Vn.displayName="CloseButton";const jn=({store:e,buttonVariant:t})=>{const a=g.useStore(e.$isClickawayLocked),n=w.useCallback((()=>{e.$props.get().onRequestClose()}),[e]);return w.createElement(Vn,{onClickCloseButton:n,buttonVariant:t,disabled:a})};jn.displayName="CloseButton";const Fn=({store:e})=>{const{objectIdentifier:t}=g.useStore(e.$props),a=_e(),n=wn(),i="loaded"===a.status?a.objectIdentifier:t,o=w.useCallback((()=>{g.batch((()=>{e.$currentScreen.set(Lt.MANAGE_ACCESS),e.$isSuggestionsOpen.set(!1)}))}),[e]),r=w.useCallback((()=>{n.select(Tn).emit(null)}),[n]);return i?w.createElement("div",null,w.createElement(m.ContentMemberFacepileButton,{oid:i,onClick:o,onView:r})):null};Fn.displayName="ManageAccessFacepileButton";const qn=({store:e})=>{const t=g.useStore(e.$currentScreen),{objectIdentifier:n,fileName:i,fileSize:o,shouldHideCloseButton:r,shouldShowBackButtonOnInbandShare:s,shouldShowBackButtonOnQrCodeScreen:c}=g.useStore(e.$props),d="file"!==n[".tag"],m=t===Lt.INBAND,_=t===Lt.MANAGE_ACCESS||t===Lt.INBAND&&s||t===Lt.QRCODE&&c,p=t===Lt.COPY_LINK,{firstLine:E,secondLine:f}=w.useMemo((()=>{switch(t){case Lt.INBAND:return{firstLine:(e=l.intl,e.formatMessage({id:"DOMI0b",defaultMessage:"Add people to"})),secondLine:i};case Lt.QRCODE:return{firstLine:yn(l.intl),secondLine:i};case Lt.MANAGE_ACCESS:return{firstLine:Cn(l.intl),secondLine:i};case Lt.COPY_LINK:return{firstLine:vn(l.intl),secondLine:i};case Lt.SETTINGS:return{firstLine:bn(l.intl,i)};case Lt.MAIN:default:return{firstLine:Sn(l.intl,i),secondLine:d?fn(l.intl):a.formatBytes(l.intl,o,2,!1)}}var e}),[t,i,o,d]),S=w.useCallback((()=>{t===Lt.MANAGE_ACCESS?e.$currentScreen.set(Lt.INBAND):e.$currentScreen.set(Lt.MAIN)}),[t,e.$currentScreen]),y=m?220:void 0;return p?null:w.createElement(w.Fragment,null,_&&w.createElement("div",{className:u.classes.headerSectionBackButton},w.createElement(a.IconButton,{onClick:S,variant:"borderless",shape:"standard",size:"medium",tone:"neutral","data-uxa-log":`sm24_back_button_${t}`,"data-testid":"sm24-back-button"},w.createElement(a.UIIcon,{src:a.ArrowLeftLine}))),w.createElement("div",{className:u.classes.headerSectionTextContainer},w.createElement(a.Text,{size:"medium",isBold:!0,className:u.classes.headerSectionPrimaryText},w.createElement(a.Truncate,{location:.5},E)),w.createElement(a.Text,{size:"small",color:"subtle"},w.createElement(a.Truncate,{maxWidth:y,location:.5},f))),w.createElement("div",{className:u.classes.headerSectionRightContainer},m&&w.createElement(Fn,{store:e}),!r&&w.createElement("div",{className:u.classes.headerSectionButtonContainer},w.createElement(jn,{store:e,buttonVariant:"borderless"}))))};qn.displayName="HeaderSection";const Hn=({store:e})=>{const t=g.useStore(e.$props),n=_e(),{objectIdentifier:i,onConfirmationModalShownChange:o,onObjectIdentifierChanged:r}=t,s=g.useStore(e.$inviteTargets),l=g.useStore(e.$inviteMessage),c=w.useCallback((t=>{e.$inviteMessage.set(t)}),[e]),d=w.useCallback((t=>{e.$inviteTargets.set(t)}),[e]),u=w.useCallback((async e=>{"loaded"===n.status&&(await r(e),n.onObjectIdentifierChanged(e))}),[n,r]),m=w.useCallback((()=>{e.$isClickawayLocked.set(!0)}),[e]),p=w.useCallback((()=>{e.$isClickawayLocked.set(!1)}),[e]),f=w.useCallback((()=>{e.$isClickawayLocked.set(!1),e.$props.get().onInbandShareCompleted(),e.$props.get().shouldResetToMainAfterInbandShare&&g.batch((()=>{e.$currentScreen.set(Lt.MAIN),e.$inviteTargets.set([]),e.$inviteMessage.set("")})),a.invalidateObjectMembers(i),E.invalidateSharingObjectMetadata(i),E.invalidateNewApiObjectMetadata(i)}),[e,i]),S=w.useCallback((()=>{e.$isInbandStarted.set(!0)}),[e]),y=w.useCallback((t=>{e.$isSuggestionsOpen.set(t)}),[e]),C=w.useCallback((async()=>{"loaded"===n.status&&await n.refreshObjectMetadata()}),[n]),v=w.useCallback((async()=>{"loaded"===n.status&&await n.refreshModal()}),[n]),b=g.useStore(e.$isConfidentialFolderBannerClosed),h=w.useCallback((()=>{e.$isConfidentialFolderBannerClosed.set(!0)}),[e.$isConfidentialFolderBannerClosed]);return w.createElement(_.Inband,{oid:t.objectIdentifier,inviteMessage:l,inviteTargets:s,hasUpdatedAccountMetadata:!1,onCloseClick:()=>t.onRequestClose(),onTargetsDropdownFocusChange:y,onInviteMessageChange:c,onInviteTargetsChange:d,onShareStart:m,onShareFailure:p,onInbandShareSuccess:f,onStartInband:S,onRefreshObjectMetadata:C,onRefreshModal:v,shouldDisablePostInbandShareHooks:t.shouldDisablePostInbandShareHooks,onConfirmationModalShownChange:o,isConfidentialFolderBannerClosed:b,onConfidentialFolderBannerClose:h,onObjectIdentifierChanged:u})};Hn.displayName="InbandShareScreen";const Kn=({children:e})=>{const t=_e();return w.createElement(a.ContextProvider,{context:a.Context$6,value:"loaded"===t.status?t.objectMetadata:null},w.createElement(d.MetadataProvider,{sharingObjectMetadata:"loaded"===t.status?t.objectMetadata:void 0,sharingPrefs:"loaded"===t.status?t.sharingPrefs:void 0,sharingObjectIdentifier:"loaded"===t.status?t.objectIdentifier:void 0,shareMe24Metadata:{isShareMe24:!0}},e))};Kn.displayName="LoggingMetadataProvider";const Gn=({store:e})=>{const{objectIdentifier:t,onRequestClose:n,onConfirmationModalShownChange:i,onObjectIdentifierChanged:o}=g.useStore(e.$props),r=_e(),s=w.useCallback((async e=>{"loaded"===r.status&&(await o(e),r.onObjectIdentifierChanged(e))}),[r,o]),l=w.useCallback((t=>{g.batch((()=>{t.shouldOpenLinkSettings?e.$initialSettingsTab.set("edit_link_settings"===t.initialTab?"edit_link_settings":"view_link_settings"):e.$initialSettingsTab.set("object_settings"),e.$currentScreen.set(Lt.SETTINGS)}))}),[e]),c=w.useCallback((()=>{n()}),[n]),d=w.useCallback((()=>{e.$currentScreen.set(Lt.INBAND)}),[e]),u=w.useCallback((()=>{e.$currentScreen.set(Lt.INBAND),E.invalidateSharingObjectMetadata(t),E.invalidateNewApiObjectMetadata(t),m.invalidateListSharedLinks(t),a.invalidateObjectMembers(t),E.invalidateNewApiObjectMetadata(t)}),[t,e.$currentScreen]),_="loaded"===r.status?r.objectIdentifier:t;return _?w.createElement(a.Box,{style:{height:"322px",overflowY:"auto",scrollbarWidth:"thin"}},w.createElement(m.ContentMemberList,{objectIdentifier:_,openLinkSettings:l,onRequestClose:c,onChangeConfidentiality:d,onTransferFolderOwnership:u,onObjectIdentifierChanged:s,onConfirmationModalShownChange:i||(()=>{})})):null};Gn.displayName="ManageAccessScreen";const Wn=({store:e})=>{const t=g.useStore(e.$initialSettingsTab),a=g.useStore(e.$props),{objectIdentifier:n,onObjectIdentifierChanged:i,onConfirmationModalShownChange:o,manageAccessHandler:r,onRequestClose:s,shouldResetToMainOnSettingsCancel:l,shouldResetToMainOnSettingsSave:c,settingsHandler:d,shouldResetToMainOnUnshareComplete:u}=g.useStore(e.$props),m=_e(),_=w.useCallback((async e=>{window.console.log("onObjectIdentifierChanged",e),"loaded"===m.status&&(await i(e),m.onObjectIdentifierChanged(e))}),[m,i]),p=w.useCallback((e=>{o&&o(e)}),[o]),E=w.useCallback((async()=>{"loaded"===m.status&&await m.refreshModal()}),[m]),f=w.useCallback((()=>{u&&e.$currentScreen.set(Lt.MAIN)}),[u,e.$currentScreen]),S=w.useCallback((()=>{r()}),[r]),C=w.useCallback((()=>{s()}),[s]),v=w.useCallback((()=>{l?e.$currentScreen.set(Lt.MAIN):s()}),[s,l,e.$currentScreen]),b=w.useCallback((()=>{c?e.$currentScreen.set(Lt.MAIN):s()}),[s,c,e.$currentScreen]),h=w.useCallback((()=>{if(!d)return;let e;switch(t){case"view_link_settings":e="view_link_settings";break;case"edit_link_settings":e="edit_link_settings";break;default:e=void 0}C(),d({initialTab:e})}),[t,C,d]),k="loaded"===m.status?m.objectIdentifier:n;return w.createElement(y.SettingsPage,{objectIdentifier:k,initialTab:t,onClose:C,onCancel:v,onComplete:b,onManageLinkAccess:S,onConfirmationModalShownChange:p,onObjectIdentifierChanged:_,onRefreshModal:E,onFallback:a.settingsHandler?h:void 0,onUnshareCompleted:f})};Wn.displayName="SettingsScreen";const Qn=({store:e})=>{var t;const i=g.useStore(e.$props),o=g.useStore(e.$currentScreen),r=g.useStore(e.$isExitingMainToQr),s=g.useStore(e.$isEnteringQr),l=g.useStore(e.$isEnteringInband),c=g.useStore(e.$isInbandStarted),m=g.useStore(e.$componentViewTime),_=g.useStore(e.$displayMode),p=g.useStore(e.$isInterstitialVisible),E=null!==(t=g.useStore(e.$modalCallbackRef))&&void 0!==t?t:void 0,f=d.usePlatform()===d.Platforms.METASERVER,{shouldUseDataLoadErrorScreen:S,shouldLoadErrorScreenOnInitialLoad:y,onRequestClose:C,isOpen:v}=i,b=wn(),h=_e(),k="error"===h.status;w.useEffect((()=>{v&&(b.select(Ln).emit(null),e.$componentViewTime.set(Date.now()),a.publishEvent(a.CampaignEvents.SHARE_MODAL_OPENED))}),[v,b,e.$componentViewTime]),w.useEffect((()=>{(k||y)&&S&&e.$currentScreen.set(Lt.ERROR)}),[k,y,S,e.$currentScreen]);const L="loaded"===h.status&&h.accountMetadata.is_sharing_banned;w.useEffect((()=>{if(L){C();const t=i.referrerLoggingMetadata;e={actionSurface:null==t?void 0:t.actionSurface,actionElement:null==t?void 0:t.actionElement},a.UDCL.logEvent({class:"share",action:"shown",object:"sharing_banned_modal",properties:{actionSurface:e.actionSurface,actionElement:e.actionElement}}),a.mountModal(w.default.createElement(lt,{onAfterClose:()=>{a.UDCL.logEvent({class:"share",action:"dismiss",object:"sharing_banned_modal",properties:{actionSurface:e.actionSurface,actionElement:e.actionElement}}),a.unmountModal(void 0,st)}}),void 0,st)}var e}),[L]);const A=w.useCallback((()=>{const t=e.$isClickawayLocked.get(),a=e.$isSuggestionsOpen.get();if(t||a)return;const n=Date.now()-m,i=c?"clickaway_from_inband":"clickaway";b.select(hn).emit({timeSinceView:n,action:i}),C()}),[e,m,c,b,C]),T=w.useCallback((()=>{g.batch((()=>{e.$initialSettingsTab.set("view_link_settings"),e.$currentScreen.set(Lt.SETTINGS)}))}),[e]),I=w.useCallback((()=>{r&&s&&(e.$isExitingMainToQr.set(!1),e.$currentScreen.set(Lt.QRCODE))}),[s,r,e.$currentScreen,e.$isExitingMainToQr]),$=w.useCallback((t=>{s&&t.animationName===u.classes.fadeIn&&e.$isEnteringQr.set(!1)}),[e.$isEnteringQr,s]),N=w.useCallback((t=>{l&&t.animationName===u.classes.expandOuterWrapperInband&&e.$isEnteringInband.set(!1)}),[l,e.$isEnteringInband]),M=w.useCallback((()=>e.$displayMode.set({displayMode:"centered_v1"})),[e.$displayMode]),x=w.useMemo((()=>n.is_mobile_or_tablet()?{displayMode:"drawer",hasScrollLock:!p}:"anchored_v1"===_.displayMode?{displayMode:"anchored_v1",anchorRef:_.displayModeRef,offsetDistance:5,placement:_.displayModePositioning,onAnchorInvalid:M}:{displayMode:"centered_v1"}),[_,M,p]),R=i.canUserCreateStack,O=!i.isEncrypted,D=a.isBrowserSupportedByDash()&&!!R&&O,P=o!==Lt.COPY_LINK&&o!==Lt.ERROR?w.createElement(qn,{store:e}):null;return w.createElement(it,{onEscape:A,onClickOutside:A,isOpen:v,currentScreen:o,isExitingMainToQr:r,onOverlayOrModalAnimationEnd:I,header:P,...x,modalCallbackRef:E},w.createElement("div",{className:a.cx("oa-pulsar-effect-SHARE_MODAL_TOKENIZER")},o===Lt.INBAND&&w.createElement("div",{onAnimationEnd:N,className:a.cx({[u.classes.inbandScreenExpand]:l}),style:{padding:"6px",minHeight:"310px"}},w.createElement(Hn,{store:e})),o===Lt.MAIN&&w.createElement(w.Fragment,null,w.createElement(ot,null,f&&w.createElement(Ae,{onUpgrade:()=>{const e=Date.now()-m;b.select(An).emit({timeSinceView:e,action:"over_quota_share_banner_upgrade"}),C()}})),w.createElement(ot,null,w.createElement(Ft,{store:e})),w.createElement(ot,null,w.createElement(rt,null,w.createElement(At,{store:e})),w.createElement(rt,null,w.createElement(va,{store:e}))),D&&w.createElement(ot,null,w.createElement(jt,{store:e})),w.createElement(ot,{styleName:a.cx(u.classes.utilityButtonRow,u.classes.buttonRowBmusQr)},w.createElement(Jt,{store:e,buttonVariant:"filled",onRequestClose:()=>{C()},shouldDisableQRCodeAnimation:i.shouldDisableQRCodeAnimation}),w.createElement(la,{store:e,buttonVariant:"filled"}))),o===Lt.QRCODE&&w.createElement("div",{className:a.cx({[u.classes.qrScreenExpand]:!r&&s}),onAnimationEnd:$},w.createElement(at,{objectIdentifier:i.objectIdentifier,onSettingsClick:T,onGetQrCodeError:()=>{C()},fileName:i.fileName,filePath:i.filePath})),o===Lt.MANAGE_ACCESS&&w.createElement(Gn,{store:e}),o===Lt.COPY_LINK&&w.createElement(En,{store:e}),o===Lt.SETTINGS&&w.createElement(Wn,{store:e}),o===Lt.ERROR&&w.createElement(Nn,null)))};Qn.displayName="Inner";e.CopyLinkScreen=_n,e.GetQrCode=at,e.Main=e=>{const t=(e=>g.useInitStore(e,(t=>{const a=g.proxy((()=>t.get().objectIdentifier)),n=g.proxy((()=>t.get().canUserUseTransfer)),i=g.proxy((()=>t.get().canContentUseTransfer)),o=g.proxy((()=>t.get().canUserEnableTransfer)),r=g.proxy((()=>t.get().isTransferEligibilityLoading)),s=g.proxy((()=>t.get().isFolderFileCountOverLimit)),l=g.proxy((()=>t.get().contents)),c=g.store(0),d=g.store(!1),u=g.store(!1),m=g.store(Lt.MAIN),_=g.store(!1),p=g.store(!1),E=g.store(!1),f=g.store(!1),S=g.store("anchored_v1"===e.initialDisplayMode?{displayMode:e.initialDisplayMode,displayModePositioning:e.displayModePositioning,displayModeRef:e.displayModeRef}:{displayMode:e.initialDisplayMode}),y=g.store([]),C=g.store(""),v=g.store(void 0),b=g.store(!1),h=g.store("object_settings"),k=g.proxy((()=>t.get().modalCallbackRef)),L=g.store(!1);return{$props:t,$objectIdentifier:a,$canUserUseTransfer:n,$canContentUseTransfer:i,$canUserEnableTransfer:o,$isTransferEligibilityLoading:r,$componentViewTime:c,$isClickawayLocked:d,$isInbandStarted:u,$currentScreen:m,$isExitingMainToQr:_,$isEnteringInband:E,$isEnteringQr:p,$isSuggestionsOpen:f,$displayMode:S,$inviteTargets:y,$inviteMessage:C,$clipboardWriter:v,$isFolderFileCountOverLimit:s,$contents:l,$isInterstitialVisible:b,$initialSettingsTab:h,$modalCallbackRef:k,$isConfidentialFolderBannerClosed:L}})))(e),{isOpen:n,onRequestClose:i}=e,o=d.usePlatform()===d.Platforms.METASERVER;return n?o?w.createElement(s.ShareBlockingWrapper,{action:a.LockedStateModalAction.SHARE_MODAL,onStatusChange:e=>{e===a.Status.USER_ABORTED_ACTION&&i()}},w.createElement(Kn,null,w.createElement(Qn,{store:t}))):w.createElement(Kn,null,w.createElement(Qn,{store:t})):null},e.OverquotaShareBannerComponent=Ae,e.Provider=me,e.prefetch=j,e.useData=_e}));
//# sourceMappingURL=c_shareme24_main.js-vflpzSTk0.map

//# debugId=67eac12f-4a11-3ff2-8614-32d8a2c73508